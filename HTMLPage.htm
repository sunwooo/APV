<form id="form1" 
action="../Admin/Approval_Admin/DocboxFolderMgr/DocboxFolderEdit.aspx" 
method="post" name="form1">
<div>
    <input id="__EVENTTARGET" name="__EVENTTARGET" type="hidden" />
    <input id="__EVENTARGUMENT" name="__EVENTARGUMENT" type="hidden" />
    <input id="__VIEWSTATE" name="__VIEWSTATE" type="hidden" 
        value="/wEPDwULLTExMTM0Nzc2MjkPZBYCAgMPZBYCAgEPZBYCZg9kFgoCAQ8PFgIeBFRleHRlZGQCAg8QDxYGHg1EYXRhVGV4dEZpZWxkBQdOTV9DT0RFHg5EYXRhVmFsdWVGaWVsZAUHQ0RfQ09ERR4LXyFEYXRhQm91bmRnZBAVBAzrs7TsobTrhYTtlZwEMeuFhAQz64WEBuyYgeq1rBUEBG51bGwBMQEzBDUwMDAUKwMEZ2dnZ2RkAgQPZBYCZg8PFgIfAAUG7KCA7J6lZGQCBQ9kFgJmDw8WAh8ABQbsgq3soJxkZAIGD2QWAmYPDxYCHwAFEu2VmOychO2PtOuNlOyDneyEsWRkZFxH8IVrP70XCnEkRDHsyeYt71uG" />
</div>
<SCRIPT type=text/javascript>
//<![CDATA[
var theForm = document.forms['form1'];
if (!theForm) {
    theForm = document.form1;
}
function __doPostBack(eventTarget, eventArgument) {
    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
        theForm.__EVENTTARGET.value = eventTarget;
        theForm.__EVENTARGUMENT.value = eventArgument;
        theForm.submit();
    }
}
//]]>
</SCRIPT>

<SCRIPT type=text/javascript 
src="/CoviWeb/WebResource.axd?d=Wm23a3C1k9e15DMM7yTzv_AISvOxEJr1GC19AucdYl9KHmfy5oi_vSSSwfKqA1nTnSaq1oVocZTTybi7aZGxuZxZycA1&amp;t=634604748479085897"></SCRIPT>

<SCRIPT language=javascript> var g_imgBasePath = '/GwImages/BLUE';</SCRIPT>

<SCRIPT type=text/javascript src="/CoviWeb/SiteReference/js/Config.js"></SCRIPT>

<SCRIPT type=text/javascript 
src="/CoviWeb/SiteReference/js/EmbedObject.js"></SCRIPT>

<SCRIPT type=text/javascript 
src="/CoviWeb/SiteReference/js/Utility.js"></SCRIPT>

<SCRIPT type=text/javascript 
src="/CoviWeb/ScriptResource.axd?d=nTg3oYzduS-F7-lwOgMe4G1oWpXM_9ErpfifLBxS3eTAMbawcZPMSZeJNmqHgF5NjEFnYxCJzs1JT8nMwMEjAmzezIvayc3SAL5JAmHnPjoFGN9TWdtrB7SvEk8KzZuXKn3UD1Xp3V-_UeABpdGp1BZR26dSA6oJddBpF9asPKZVoQvh0&amp;t=ffffffffb868b5f4"></SCRIPT>

<SCRIPT type=text/javascript>
//<![CDATA[
if (typeof(Sys) === 'undefined') throw new Error('ASP.NET Ajax 클라이언트측 프레임워크를 로드하지 못했습니다.');
//]]>
</SCRIPT>

<SCRIPT type=text/javascript 
src="/CoviWeb/ScriptResource.axd?d=uYAVbrbqbhXs4sv9gFUPD8Kz6rEvJDlihNmQU7S_KyH94xzwNVbCMCdSaFvL07YR8fM0K02WK8b4hpFueMNaBKV9JnRP_auZSjL92V9x5Ede_0XFDSwfVqd8-fXZibIddUcefS-0k1tpMGA13NiN_eMKmba8V7T_ZTvmTwI4xzD06Fxt1THXICyAHuriotIuYBZ5PQ2&amp;t=ffffffffb868b5f4"></SCRIPT>

<SCRIPT type=text/javascript>
//<![CDATA[
var el_form1 = 'form1';
var nm_form1 = 'form1';
var el_ScriptManager1 = 'ScriptManager1';
var nm_ScriptManager1 = 'ScriptManager1';
var el_UpdatePanel1 = 'UpdatePanel1';
var ig_UpdatePanel1 = 'UpdatePanel1';
var nm_UpdatePanel1 = 'UpdatePanel1';
var el_txtFolderName = 'txtFolderName';
var nm_txtFolderName = 'txtFolderName';
var el_txtFolderID = 'txtFolderID';
var nm_txtFolderID = 'txtFolderID';
var el_ddlKeepYear = 'ddlKeepYear';
var nm_ddlKeepYear = 'ddlKeepYear';
var el_txtFolderOrderBy = 'txtFolderOrderBy';
var nm_txtFolderOrderBy = 'txtFolderOrderBy';
var el_btnSave = 'btnSave';
var nm_btnSave = 'btnSave';
var el_btnSaveText = 'btnSaveText';
var nm_btnSaveText = 'btnSaveText';
var el_btnDelete = 'btnDelete';
var nm_btnDelete = 'btnDelete';
var el_btnDeleteText = 'btnDeleteText';
var nm_btnDeleteText = 'btnDeleteText';
var el_btnAdd = 'btnAdd';
var nm_btnAdd = 'btnAdd';
var el_btnAddText = 'btnAddText';
var nm_btnAddText = 'btnAddText';
var el_hidUserEntCode = 'hidUserEntCode';
var nm_hidUserEntCode = 'hidUserEntCode';
var el_hidUserEntName = 'hidUserEntName';
var nm_hidUserEntName = 'hidUserEntName';
var el_hidParentFolderID = 'hidParentFolderID';
var nm_hidParentFolderID = 'hidParentFolderID';
var el_hidFolderID = 'hidFolderID';
var nm_hidFolderID = 'hidFolderID';
//]]>
</SCRIPT>

<div>
    <input id="__EVENTVALIDATION" name="__EVENTVALIDATION" type="hidden" 
        value="/wEWDwKL86rSBgLA/OjWBwLB7azhAQLtkJ+qCQKCsI/5AQKAsI/5AQKo8eiQDQKNpvHKDAKct7iSDALLx9PKBQKMk4HYDwLfy7/7DwKnh5HeAgKczODjCgKwoPG+BLGp5i9xQ5iSYTES6At7hZI7w3y6" />
</div>
<div class="write">
<SCRIPT type=text/javascript>
//<![CDATA[
Sys.WebForms.PageRequestManager._initialize('ScriptManager1', document.getElementById('form1'));
Sys.WebForms.PageRequestManager.getInstance()._updateControls(['tUpdatePanel1'], [], [], 90);
//]]>
</SCRIPT>

    <div id="UpdatePanel1">
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
            <tr>
                <td class="line" colspan="2">
                </td>
            </tr>
            <tr>
                <td class="title" width="30%">
                    문서폴더 명</td>
                <td style="PADDING-LEFT: 10px" width="70%">
                    <input id="txtFolderName" name="txtFolderName" size="60" type="text" 
                        value="분류" />
                </td>
            </tr>
            <tr>
                <td class="line" colspan="2">
                </td>
            </tr>
            <tr>
                <td class="title" width="30%">
                    문서폴더 코드</td>
                <td style="PADDING-LEFT: 10px" width="70%">
                    <input id="txtFolderID" disabled name="txtFolderID" type="text" />
                </td>
            </tr>
            <tr>
                <td class="line" colspan="2">
                </td>
            </tr>
            <tr>
                <td class="title" width="30%">
                    <span class="text-green">보존년한</span></td>
                <td style="PADDING-LEFT: 10px" width="70%">
                    <select id="ddlKeepYear" name="ddlKeepYear">
                        <option selected="" value="null">보존년한</option>
                        <option value="1">1년</option>
                        <option value="3">3년</option>
                        <option value="5000">영구</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="line" colspan="2">
                </td>
            </tr>
            <tr>
                <td class="title" width="30%">
                    <span class="text-green">정렬순서</span></td>
                <td style="PADDING-LEFT: 10px" width="70%">
                    <input id="txtFolderOrderBy" name="txtFolderOrderBy" onkeydown="handlerNum()" 
                        style="TEXT-ALIGN: center; IME-MODE: inactive" type="text" />
                </td>
            </tr>
            <tr>
                <td class="line" colspan="2">
                </td>
            </tr>
        </table>
        <!-- 저장,닫기 버튼 영역 -->
        <div style="TEXT-ALIGN: right; PADDING-RIGHT: 0px; PADDING-TOP: 5px">
            <table border="0" cellpadding="0" cellspacing="0">
                <tr>
                    <td>
                        <a id="btnSave" class="Btn04" href="javascript:__doPostBack('btnSave','')" 
                            onclick="return fnSave();"><span id="btnSaveText">저장</span></a>
                    </td>
                    <td>
                        <a id="btnDelete" class="Btn04" href="javascript:__doPostBack('btnDelete','')" 
                            onclick="return fnFolderDelete();"><span id="btnDeleteText">삭제</span></a>
                    </td>
                    <td>
                        <a id="btnAdd" class="Btn04" href="javascript:__doPostBack('btnAdd','')" 
                            onclick="fnAddFolder();"><span id="btnAddText">하위폴더생성</span></a>
                    </td>
                </tr>
            </table>
        </div>
        <!-- 저장, 닫기 버튼 영역 끝-->
    </div>
</div>
<input id="hidUserEntCode" name="hidUserEntCode" type="hidden" />
<input id="hidUserEntName" name="hidUserEntName" type="hidden" />
<input id="hidParentFolderID" name="hidParentFolderID" type="hidden" />
<input id="hidFolderID" name="hidFolderID" type="hidden" />
<SCRIPT language=javascript type=text/javascript>
var strUserType = "";
var strUserEntCode = "";
function handlerNum() 
{
    e = window.event; //윈도우의 event를 잡는것입니다. 그냥 써주심됩니당.

    //숫자열 0 ~ 9 : 48 ~ 57, 키패드 0 ~ 9 : 96 ~ 105 ,8 : backspace, 46 : delete -->키코드값을 구분합니다. 저것들이 숫자랍니다.
    if(e.keyCode >= 48 && e.keyCode <= 57 || e.keyCode >= 96 && e.keyCode <= 105 || e.keyCode == 8 || e.keyCode == 46){
        if(e.keyCode == 48 || e.keyCode == 96)//0을 눌렀을경우
    {
        if(document.getElementById("txtFolderOrderBy").value == "" ) //아무것도 없는상태에서 0을 눌렀을경우

        e.returnValue=false; //-->입력되지않는다.
        else //다른숫자뒤에오는 0은
        return; //-->입력시킨다.
    }else //0이 아닌숫자
        return; //-->입력시킨다.
    }else //숫자가 아니면 넣을수 없다.
        e.returnValue=false;
}
function fnSave()
  {//debugger;
    var varFolderID = document.getElementById("txtFolderID").value;
    var varFolderName = document.getElementById("txtFolderName").value;
    var varFolderOrder = document.getElementById("txtFolderOrderBy").value;
    var varParentFolderID = document.getElementById("hidFolderID").value;
    
    if(varParentFolderID == "")
    {
        //수정
        if(confirm("수정하시겠습니까?"))//수정하시겠습니까?
        {
            if(varFolderName == "")
            {
                alert("폴더명을 입력하세요");//폴더명을 입력하세요
                return false;
            }
            else if(varFolderID == "")
            {
                 alert("폴더아이디를 입력하세요");//폴더아이디을 입력하세요
                 return false;
            }
            else if(varFolderOrder == "")
            {
                 alert("정렬순서를 입력하세요");//정렬순서를 입력하세요
                 return false;
            }
            return true;
        }
        return false;
    }
    else
    {
        if(confirm(varFolderName+" 를 추가하시겠습니까?"))  //를 추가하시겠습니까?
        {
            if(varFolderName == "")
            {
                alert("폴더명을 입력하세요");  //폴더명을 입력하세요
                return false;
            }
            else if(varFolderID == "")
            {
                 alert("폴더아이디를 입력하세요"); //폴더아이디을 입력하세요
                 return false;
            }
             else if(varFolderOrder == "")
            {
                 alert("정렬순서를 입력하세요"); //정렬순서를 입력하세요
                 return false;
            }
            return true;
        }
        return false;
    }
  }
  
  //하위폴더 추가하기
  function fnAddFolder()
  {//debugger;
    if(document.getElementById("txtFolderID").value == "")
    {
        alert("상위폴더가 선택되지 않았습니다. 상위폴더를 선택후 추가해주세요");  //상위폴더가 선택되지 않았습니다. 상위폴더를 선택후 추가해주세요
    }
    else
    {
        document.getElementById("hidFolderID").value = document.getElementById("txtFolderID").value;
        document.getElementById("txtFolderName").value = "";
        document.getElementById("txtFolderID").value = "";
        //document.getElementById("txtFolderPath").value = "";
        document.getElementById("txtFolderOrderBy").value = "0";
        
       //fnSave();
    }
  }
  
  //최상위 폴더 추가하기
    function fnAddRoot()
    {
        if(confirm("계열사 최상위 폴더를 추가하시겠습니까?"))
        {

        }
    }
    
    //폴더삭제하기
    function fnFolderDelete()
    {//debugger;
        if(document.getElementById("txtFolderID").value == "")
        {
            alert("삭제할 폴더를 선택해주세요");  //삭제할 폴더를 선택해주세요
            return false;
        }
        else
        {
            if(confirm(document.getElementById("txtFolderName").value +" 폴더를 삭제하시겠습니까?"))    //폴더를 삭제하시겠습니까?
            {
                return true;
            }
            return false;
        }
    }
    
    function processXmlData(objXML)
    {//debugger;
	if(objXML.selectNodes("response/NewDataSet/Table").length==0) return false;
	
	var rgData = new Array();
	var nodesAllItems = objXML.selectNodes("response/NewDataSet/Table");
	
	if (nodesAllItems.length > 0){
		for(var x=0; x<nodesAllItems.length; x++){
			rgData[0] = nodesAllItems.item(x).selectSingleNode("NAME").text.replace(/\x08/g,"&");
			rgData[1] = nodesAllItems.item(x).selectSingleNode("ID").text.replace(/\x08/g,"&");			
			rgData[2] = nodesAllItems.item(x).selectSingleNode("KEEP_YEAR").text.replace(/\x08/g,"&");
			rgData[3] = nodesAllItems.item(x).selectSingleNode("SORT_ORDER").text.replace(/\x08/g,"&");
			
			document.getElementById("txtFolderName").value = rgData[0]; //문서폴더 명
			document.getElementById("txtFolderID").value = rgData[1];   //문서폴더 코드
			if (rgData[2] =="NO")
			{
			    document.getElementById("ddlKeepYear").value = "null";   //보존연한
			}else{
			    document.getElementById("ddlKeepYear").value = rgData[2];   //보존연한
			}
			document.getElementById("txtFolderOrderBy").value = rgData[3];  //정렬 순서
		}
	}else{
		var nodesAllErrors = m_objXML.selectSingleNode("response/NewDataSet/Table");
		
		if(nodesAllErrors != null){                       
			if (nodesAllErrors.text != "none")
				addMessage(nodesAllErrors.text);
		}else{
			addMessage(L_idsUnknownError_Text + "\r\n"+ L_idsTrySimplifySearch_Text);
		}
	}
	return;
}
</SCRIPT>

<SCRIPT type=text/javascript>
//<![CDATA[
Sys.Application.initialize();
//]]>
</SCRIPT>
 </form>
