<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma" content="no-cache" />
	<title></title>			
	<link rel="stylesheet" href="/GWImages/common/css/approval_form.css" type="text/css" />
	<link rel="stylesheet" href="/GWImages/common/TagFree/tagfree.css" type="text/css" />
    <!--필수 양식파일에 쓰이는 js 파일-->
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Config.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/EmbedObject.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Utility.js" ></script>
    <script type="text/javascript" language="javascript" src="../../Common/script/COVIFlowNet/openWindow.js" ></script>		
	<script type="text/javascript" language="javascript" src="../../Common/script/progress.js" ></script>
	<script type="text/javascript" language="javascript" src="../../common/script/NameControl.js"></script>
	<script type="text/javascript" language="javascript" src="../../common/script/jquery-1.3.2.min.js"></script>
	<script type="text/javascript" language="javascript" src="formedit.js" ></script>
</head>
<body topmargin="0" leftmargin="0" scroll="auto" >
	<!-- COMMON FIELDS -->
	<input type="hidden" id="dField" name="INITIATOR_NAME" datafld="INITIATOR_NAME">
	<input type="hidden" id="dField" name="INITIATOR_ID" datafld="INITIATOR_ID">
	<input type="hidden" id="dField" name="INITIATOR_OU_NAME" datafld="INITIATOR_OU_NAME">
	<input type="hidden" id="dField" name="INITIATOR_OU_ID" datafld="INITIATOR_OU_ID">
	<input type="hidden" id="cField" name="LAST_MODIFIER_ID">
	<input type="hidden" id="cField" name="attach">
	<input type="hidden" id="cField" name="filelocation" datafld="fmfl">
	<input type="hidden" id="cField" name="ATTACH_FILE" value="">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO" value="" datafld="ATTACH_FILE_INFO">
	<input type="hidden" id="dField" name="INITIATOR_INFO" value="" datafld="INITIATOR_INFO">
	<input type="hidden" id="dField" name="APPLIED" datafld="APPLIED">
	<input type="hidden" id="dField" name="ISPUBLIC" datafld="ISPUBLIC">
	<input type="hidden" id="dField" name="APPLIED_TERM" datafld="APPLIED_TERM">
	<input type="hidden" id="dField" name="RECEIVE_NO" datafld="RECEIVE_NO">
	<input type="hidden" id="dField" name="RECEIVE_NAMES" datafld="RECEIVE_NAMES">
	<input type="hidden" id="dField" name="RECEIPT_LIST" datafld="RECEIPT_LIST">
	<input type="hidden" id="dField" name="DOC_LEVEL" datafld="DOC_LEVEL">
	<input type="hidden" id="dField" name="DOC_CLASS_ID" datafld="DOC_CLASS_ID">
	<input type="hidden" id="dField" name="DOC_CLASS_NAME" datafld="DOC_CLASS_NAME">
	<input type="hidden" id="dField" name="SAVE_TERM" datafld="SAVE_TERM">
	<input type="hidden" id="dField" name="SUBJECT" datafld="SUBJECT">
	<input type="hidden" id="dField" name="DOC_NO" dataFld="DOC_NO">
	<input type="hidden" id="dField" name="DOC_OU_NAME" datafld="DOC_OU_NAME">
	<input type="hidden" id="dField" name="ENT_CODE" datafld="ENT_CODE">
	<input type="hidden" id="dField" name="ENT_NAME" datafld="ENT_NAME">

	<textarea id="dField" name="DOC_SUMMARY" datafld="DOC_SUMMARY" style="display: none"></textarea>
	<textarea id="dhtml_body" style="display: none"></textarea>
	<textarea style="display: none" id="cField" name="xsl"></textarea>
	<!-- 문서link -->
    <textarea id="dField" name="DOCLINKS" style="display:none"  dataFld="DOCLINKS"></textarea>
    <input type="hidden" id="mField" name="WORKREQUEST_ID" />
	<!-- 양식추가정보 -->
	<!-- END -->
	<!-- 양식전체본문 -->
	<div id="bodytable">
		<!-- header start -->
		<div class="approval_form">
        <div class="draft_tit"><h4><span id="headname"></span><a href="#"><span class="drop_menu"></span></a></h4></div>
        <div class="draft_page">
		<table width="100%" cellpadding="0" cellspacing="0">
        <!-- 결재선 정보 시작-->
            <!-- 일반결재/합의 -->
            <tr>
                <td id="AppLine" width="100%">
                    <table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0" bordercolordark="white" bordercolorlight="gray">
                        <tr>
                        <!-- 발신처 결재란 보이는 부분(왼쪽) -->
                            <td id="LApvLine" align="left" width="100%"></td>
                        </tr>
                        <tr>
                        <!-- 수신처 결재란 보이는부분 (오른쪽)-->
                            <td id="RApvLine" align="left" width="100%"></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <!-- 협조자 -->
            <tr>
                <td id="AssistLine" width="100%" style="display:none;"></td>
            </tr>
            <!--참조자 -- 첨부파일 영역으로 옮김 -->
            <!--수신자 -->
            <tr>
                <td id="RRLine" width="100%" style="display:none;"></td>
            </tr>			
        <!-- 결재선 정보 종료-->
        </table>		
		<table class="table_2" summary="문서분류" cellpadding="0" cellspacing="0">				
            <tr>
                <th>보안등급</th>
                <td width="30%" id="tField" name="DOC_LEVEL"></td>
                <th>보존년한</th>
                <td width="30%" id="tField" name="SAVE_TERM" ></td>
            </tr>
            <tr>
                <th>문서분류</th>
                <td id="tField" name="DOC_CLASS_NAME" dataFld="DOC_CLASS_NAME" ></td>
                <th>문서번호</th>
                <td id="tField" name="DOC_NO" dataFld="DOC_NO" >&nbsp;</td>
            </tr>	                  
            <tr id="workrequestdisplay" style="display:;">
                <th>관련업무의뢰</th>
                <td colspan="3" id="WORKREQUEST_NAME" >&nbsp;</td>
            </tr> 			
		</table>
		<!-- header end -->
		<table border="0" cellpadding="0" cellspacing="0" align="center" width="740"><tr><td height="2"></td></tr></table>
		<!-- bodycontext start -->
        <table class="table_3" summary="내용" cellpadding="0" cellspacing="0">
            <tr>
                <th>제&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;목</th>
                <td id="tField" name="SUBJECT" datafld="SUBJECT" colspan="3"></td>
            </tr>
		    <!--실 결재양식 내용 부분 시작 -->
		    <tr>
				<th colspan="4">신청자 정보</th>				
			</tr>
			<tr>
				<th>신청자</th>
				<td><span id="EMPLOYEE_NAME"></span></td>
				<th>부서</th>
				<td><span id="EMPLOYEE_OU_NAME"></span></td>
			</tr>
			<tr>
				<th>직위</th>
				<td><span id="EMPLOYEE_INFO"></span></td>
				<th>신청일</th>
				<td><span id="initiated2"></span></td>
			</tr>
			<tr>
				<th>전화번호</th>
				<td><span id="EMPLOYEE_TEL"></span></td>
				<th>휴대전화번호</th>
				<td><span id="EMPLOYEE_MOBILE_TEL"></span></td>
			</tr>
			<tr>
				<th>이메일</th>
				<td><span id="EMPLOYEE_EMAIL"></span></td>
				<th>지역</th>
				<td><span id="REGION_NAME"></span></td>
				<td id='hREGION' style="display:none;">
					<SELECT name="REGION" disabled>
					</SELECT>
				</td>
			</tr>
			<tr>
				<th colspan="4">신청내용</th>
			</tr>
			<tr>
			    <th>신청업무</th>
			    <td><span id="REQDUTY"></span></td>
			    <th>세부업무</th>
			    <td><span id="REGDUTYSUBNAME"></span></td>
				<td id='CHARGE' style="display:none;">
					<SELECT name="REQDUTYSUB" disabled>
					</SELECT>
				</td>
			</tr>
			<tr>
				<th>완료희망일</th>
				<td colspan='3'><span id="HOPED"></span></td>
			</tr>
			<tr>
			    <th>내용</th>
			    <td colspan="3"><span id="REMARK"></span></td>
			</tr>
			<tr>
				<th colspan="4">담당자 검토의견</th>
			</tr>
			<tr style="display:none;">
				<th>처리구분</th>
				<td colspan='3'>
					<SELECT ID="mField" name="PROCESS_MODE">
						<OPTION VALUE="1">내부</OPTION>
						<OPTION VALUE="2">외부</OPTION>
					</SELECT>
				</td>
			</tr>
			<tr>
				<th>검토의견</th>
				<td colspan='3'>
					<div align="center" style="WIDTH:100%; height:100">
					<textarea id="mField" cols="95" rows="8"  name="COMMENT" wrap="hard" style="font-size:9pt;border:1px solid #C0C0C0; padding-left:4; padding-right:4; padding-top:5; padding-bottom:0; overflow-x:hidden; overflow-y:auto;"></textarea>
					</div>
			</tr>
		    <!--실 결재양식 내용 부분 끝 -->
	    </table>
		<!-- bodycontext end -->
		<table class="table_5" summary="참조" cellpadding="0" cellspacing="0">
            <tr>
                <th>참조</th>
                <td id="CCLine">
                    <span id="SendCC"></span><span id="RecCC"></span>&nbsp;
                </td>
            </tr>
            <tr>
                <th>첨부파일</th>
                <td id="AttFileInfo"></td>
            </tr>
            <tr>
                <th>연결문서</th>
                <td id="DocLinkInfo"></td>
            </tr>
            <tr>
                <th>원 문 서</th>
                <td id="RejectDocLinkInfo">-</td>
            </tr>
        </table>
        <div id="divforminfo"  style="display:none">
        <table class="table_6" summary="원문서" cellpadding="0" cellspacing="0">
            <tr>
                <th>문서설명</th>
                <td id="tdforminfo"></td>
            </tr>
        </table>
        </div>
        <!--write_의견입력-->
        <table border="0" cellpadding="0" cellspacing="0" align="center" width="740"><tr><td height="2"></td></tr></table>
        <!--의견입력-->
        <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" id ="tbCommentView">
        <tr>
	        <td align="center" id="tdCommentView"  width="100%" style="display:none;">				
	        </td>
        </tr>
        </table>
        <!--read_의견입력끝 -->		
		</div>
	</div>
</div>

<script type="text/javascript" language="javascript">
window.onload = initOnload;
function initOnload() {
    initialize();
}
function initialize(){
	if(window.parent.document.readyState == "complete"){
		window.parent.document.onreadystatechange = event_noop;
		initForm();
		initApvList();
		document.getElementsByName("COMMENT")[0].focus();

	}else{
		window.setTimeout(initialize,500);
	}		
}
function initForm(){
	initFields();
	G_displaySpnAttInfo(false);
}

function initFields(szBody){
    setFields((!window.ActiveXObject) ? document.getElementById("dField") : dField); //editable field
    setFields((!window.ActiveXObject) ? document.getElementById("cField") : cField); //readonly field
    settFields((!window.ActiveXObject) ? document.getElementById("tField") : tField);

    document.getElementById("headname").innerHTML =  getInfo("fmnm");
    if (getInfo("mode") == "DRAFT" || getInfo("mode") == "TEMPSAVE") {
        document.getElementById("initiated2").innerHTML = formatDate(getInfo("svdt"), "R");
    } else {
        document.getElementById("initiated2").innerHTML =formatDate(getInfo("INITIATED_DATE"),"R");
    }
	

	//본문 내용 
	if (getInfo("BODY_CONTEXT") != undefined){	
		//본문 입력 함수 호출
		setBodyContext(getInfo("BODY_CONTEXT")); //비 Editor양식
	}
	//재기안과 수신결재
	if (getInfo("mode") != "REDRAFT"){
		document.getElementsByName("COMMENT")[0].style.border = 0;
		document.getElementsByName("COMMENT")[0].readOnly = true;
	}
}
function getBodyContext(){
	//재기안과 수신결재
	if (getInfo("loct") == "REDRAFT" || getInfo("mode") == "RECAPPROVAL" || getInfo("mode") == "REDRAFT"){
		return makeBodyContext();
	}else{
		return "";
	}
}
function setFields(Fields){
	for(var i=0;i<Fields.length;i++){
		var fld = Fields[i];
		if(fld.dataFld!=""){(getInfo(fld.name)!=undefined)? fld.value=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.value=getInfo(fld.dataFld):fld.value='';}
	}
}
function settFields(Fields){
//	for(var i=0;i<Fields.length;i++){
//		var fld = Fields[i];
//		if(fld.dataFld!=""){(getInfo(fld.name)!=undefined)? fld.innerHTML=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.innerHTML=getInfo(fld.dataFld):fld.innerHTML='';}
//		if(fld.name == "DOC_LEVEL") fld.innerHTML = getDocLevel(getInfo("DOC_LEVEL"));
//		if(fld.name == "SAVE_TERM") fld.innerHTML = getSaveTerm(getInfo("SAVE_TERM"));
//		if(fld.name == "DOC_NO") fld.innerHTML = (getInfo("DOC_NO")=="")?getInfo("DOC_CLASS_NAME"):getInfo("DOC_NO");
//	}
	if(!window.ActiveXObject){
        var szId = Fields.id;
	    var unFiltered = document.getElementsByTagName('*');
	    for (i = 0; i < unFiltered.length; i++){
	        if (unFiltered[i].getAttribute('id') == szId){
                var fld = unFiltered[i];
		        if(fld.getAttribute("name") == "SAVE_TERM"){fld.innerHTML = getSaveTerm(getInfo("SAVE_TERM"));}
		        else if(fld.getAttribute("name") == "DOC_LEVEL"){fld.innerHTML = getDocLevel(getInfo("DOC_LEVEL"));}
		        else {
		            if(fld.getAttribute("dataFld")!=null){(getInfo(fld.getAttribute("name"))!=undefined)?fld.innerHTML=getInfo(fld.getAttribute("name")):(getInfo(fld.getAttribute("dataFld"))!=undefined)?fld.innerHTML=getInfo(fld.getAttribute("dataFld")):fld.innerHTML='';}
	            }
	        }
	    }
	}else{
	    for(var i=0;i<Fields.length;i++){
		    var fld = Fields[i];

		    if(fld.name == "SAVE_TERM"){fld.innerHTML = getSaveTerm(getInfo("SAVE_TERM"));}
		    else if(fld.name == "DOC_LEVEL"){fld.innerHTML = getDocLevel(getInfo("DOC_LEVEL"));}
		    else {
    		    if(fld.dataFld!="" ){(getInfo(fld.name)!=undefined)? fld.innerHTML=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.innerHTML=getInfo(fld.dataFld):fld.innerHTML='';}
		    }
	    }
	}
}

function checkForm(bTempSave){
	if(SUBJECT.value == '' ){
		alert('제목을 입력하세요');
		return false;
	}else if (getInfo("loct") == "REDRAFT" ){ //추가 타당성 검사//&& PROCESS_MODE.value == ""
		alert("처리구분을 입력하세요");
		return false;
	}else if(COMMENT.value == ""){
	    alert("담당자 검토의견을 입력하세요.");
	    return false;
	}else{
		return true;
	}
}
/* xsl 사용 양식*/
var m_objXML = new ActiveXObject("MSXML2.DOMDocument");
var m_xmlHTTP = new ActiveXObject("Msxml2.XMLHTTP");
var m_evalXML = new ActiveXObject("Msxml2.DOMDocument");
var m_xslProcessor = new ActiveXObject("MSXML2.FreeThreadedDOMDocument");
var m_cvtXML = new ActiveXObject("MSXML2.DOMDocument").createTextNode("");

function setBodyContext(sBodyContext){
	//본문내용 display - xsl 사용
	/*
	m_objXML.loadXML(getInfo("BODY_CONTEXT"));					   
	var m_oHTMLProcessor;
	m_oHTMLProcessor = makeProcessor("HR_CAR_MOBILE.xsl");
	m_oHTMLProcessor.input = m_objXML; 
	m_oHTMLProcessor.transform();
		
	tbContentElement.innerHTML = m_oHTMLProcessor.output;
	*/
	if(sBodyContext.indexOf("<BODY_CONTEXT>")  == -1){
	    sBodyContext = "<BODY_CONTEXT>"+sBodyContext+"</BODY_CONTEXT>";
	}
	//본문내용 display - 일반 display
	var m_objXML = new ActiveXObject("MSXML2.DOMDocument");
	var elmList, elm;
	var elmListLan;
	m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>"+sBodyContext);
	//m_objXML.loadXML("<root>"+getInfo("BODY_CONTEXT")+"</root>");
	//alert(m_objXML.xml)
	try{
		elmList = m_objXML.documentElement.childNodes;
		for(var i=0; i<elmList.length; i++){
			var elm = elmList.nextNode();
			if(elm.nodeName.indexOf("OPT") != -1){
				setRadio(elm.nodeName, elm.text);
			}else{
				if(elm.nodeName =="REQDUTY"){
					ReturnData(2,elm.text);
				}else if(elm.nodeName == "COMCODE"){
					Region(elm.text)
				}
				innerHtmlData(elm.nodeName, elm.text);
				//eval(elm.nodeName).value = elm.text;
			}
		}
	}catch(e){
	}
}
//function setBodyContext(sBodyContext){
//	//본문 채우기
//	var m_objXML=new ActiveXObject("MSXML2.DOMDocument");
//	var elmList, elm;
//	var elmListLan;
//	try{
//		m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>"+sBodyContext);
//		elmList = m_objXML.documentElement.childNodes;
//		if(elmList.length == 0){
//			tbContentElement.innerHTML = sBodyContext; //기존 기안 양식일 경우
//		}else{
//			for(var i=0; i < elmList.length; i++){
//				var elm = elmList.item(i);
//				if (elm.nodeName == "WORKREQUEST_ID"){
//				    eval(elm.nodeName).value = elm.text;
//				}else{
//				    innerHtmlData(elm.nodeName, elm.text);
//				}

//				//if(elm.nodeName=="RECEDIT"&&elm.text=="Y"){ parent.menu.chk_recedit.checked = true; }
//			}
//		}
//	}catch(e){
//		tbContentElement.innerHTML = sBodyContext; //기존 기안 양식일 경우
//	}
//}
//본문 XML로 구성
function makeBodyContext(){
	var sBodyContext="";	
	if(getInfo("BODY_CONTEXT").indexOf("<BODY_CONTEXT>") > -1){
	    m_objXML.loadXML(getInfo("BODY_CONTEXT"));
	}
	else{
	    m_objXML.loadXML("<BODY_CONTEXT>"+getInfo("BODY_CONTEXT")+"</BODY_CONTEXT>");
	}
	//xml 구성 예제 : <body><item><name></name></item><item><name></name></item></body>
	//sBodyContext="<body><item><name>박병욱</name></item><item><name>박형진</name></item></body>";
	m_objXML.documentElement.selectSingleNode("COMMENT").text = COMMENT.value;
	if ( m_objXML.documentElement.selectSingleNode("PROCESS_MODE") == null){
		var oProcessMode=m_objXML.createElement("PROCESS_MODE");
		m_objXML.documentElement.appendChild(oProcessMode);
	}
	m_objXML.documentElement.selectSingleNode("PROCESS_MODE").text = PROCESS_MODE.value; 

	var szValue = "";
	var elmList = m_objXML.documentElement.childNodes;
	for(var i=0; i<elmList.length; i++){
		var elm = elmList.nextNode();
		szValue += makeNode(elm.nodeName, elm.text);
	}
	return makeNode("BODY_CONTEXT",szValue);
}	
function makeProcessor(urlXsl){
	// XSL 문서를 DOM 객체로 로딩
	var oXslDom = new ActiveXObject("MSXML2.FreeThreadedDOMDocument");
	oXslDom.async = false;
	if(!oXslDom.load(urlXsl)){
		alertParseError(oXslDom.parseError);
		throw new Error(-1,"couldn't make TemplateProcessor with ["+urlXsl+"].");
	}
	// XML 문서와 XSL 문서를 병합하여 결과를 저장할 XSLTemplate 객체 생성 
	var oXSLTemplate = new ActiveXObject("MSXML2.XSLTemplate");
	oXSLTemplate.stylesheet = oXslDom;
	// XSLTemplate 프로세서 생성
	return oXSLTemplate.createProcessor();
}
/*** 데이터 뿌려주기 ***/
//function innerHtmlData(nodeNm, nodeVal){
//	if (document.all[nodeNm] != undefined){
//		if(nodeNm.indexOf("OPT") != -1){
//			setRadio(nodeNm, nodeVal);
//		}else{
//			try{
//				if(nodeNm == "REQDUTY" || nodeNm=="REQDUTYSUB" || nodeNm=="REGION"|| nodeNm=="PROCESS_MODE"){
//					eval(nodeNm).value = nodeVal;
//				}else{
//					eval(nodeNm).innerHTML = nodeVal.replace(/\n/gi,"<BR>");
//				}
//			}catch(e){
//				eval(nodeNm).value = nodeVal;
//			}
//		}
//	}
//}
function innerHtmlData(nodeNm, nodeVal){
//	if (document.all[nodeNm] != undefined){
//		if (nodeNm.indexOf("OPT") != -1) {
//			setRadio(nodeNm, nodeVal);
//		} else if (nodeNm.indexOf("FORM_ATTACH") != -1) {
//			setForm_Attach(nodeVal);
//		} else if (nodeNm.indexOf("tbContentElement") != -1) {
//			tbContentElement.innerHTML = nodeVal;
//		} else if (nodeNm.indexOf("CHK") != -1) {
//			setChk(nodeNm, nodeVal);
//		} else {
//			try{
//	            eval(nodeNm).innerHTML = nodeVal.replace(/\n/gi,"<BR>");
//            }catch(e){
//	            eval(nodeNm).value = nodeVal;
//            }
//		}
//	}
    if (document.getElementById(nodeNm) != undefined){
		if (nodeNm.indexOf("OPT") != -1) {
			setRadio(nodeNm, nodeVal);
		} else if (nodeNm.indexOf("FORM_ATTACH") != -1) {
			setForm_Attach(nodeVal);
		} else if (nodeNm.indexOf("tbContentElement") != -1) {
			tbContentElement.innerHTML = nodeVal;
		} else if (nodeNm.indexOf("CHK") != -1) {
			setChk(nodeNm, nodeVal);
		} else {
			try{
	            document.getElementById(nodeNm).innerHTML = nodeVal.replace(/\n/gi,"<BR>");
            }catch(e){
	            document.getElementById(nodeNm).value = nodeVal;
            }
		}
	}
}
/*** 라디오 버튼 value display ***/
function setRadio(szname, szvalue){	
	var objrdo = eval(szname);
	for(i=0;i<objrdo.length;i++){	
		if(objrdo[i].value == szvalue) objrdo[i].checked = true;
		if (getInfo("loct") != "REDRAFT" && getInfo("loct") != "RECAPPROVAL"){
			objrdo[i].disabled = true;
		}
	}
}

/*** single 라디오 버튼 value display ***/
function setChk(szname, szvalue){	
	var objrdo = eval(szname);
	if(objrdo.value == szvalue) objrdo.checked = true;
	objrdo.disabled = true;		
}

////보안문서 처리 (BC카드)
function checkSecure(){
	try{
		if(dField["APPROVAL_SECRET_DOC"].value=="1"){
				var nWidth = "400px";
				var nHeight = "100px";	
				var nTop = (screen.availHeight / 2) - (window.dialogHeight / 2);
				var nLeft = (screen.availWidth / 2) - (window.dialogWidth / 2);
				var rgParams = new Array(); 
				rgParams["oUsid"] = getInfo("usid");
				rgParams["oWin"] = window;
				
				var retVal = window.showModalDialog("../ApvProcess/chkPWD.aspx", rgParams, "dialogWidth:"+nWidth+";dialogHeight:"+nHeight+";dialogTop:"+nTop+";dialogLeft:"+nLeft);
				if(retVal=="false"){top.close();}
				//alert("보안문서입니다");
		}
	}catch(e){alert(e.description);}
}
function frmclose(){
	window.close();
}

/*** Radio Button 값 가져오기***/
function getRadio(radioNm){	
	var radioVal = "";
	//alert("이름:"+radioNm+"\n객체여부:"+eval(radioNm)+"\n길이:"+eval(radioNm).length+"\n체크여부:"+eval(radioNm).checked);
	for(i=0;i<eval(radioNm).length;i++){				
		if(eval(radioNm)[i].checked){
			radioVal = "<" + radioNm + ">" + eval(radioNm)[i].value + "</" + radioNm + ">";
		}
	}
	return radioVal;
}

/*** Single Radio Button Value 가져오기 ***/
function getChkRadio(radioNm){
	if(eval(radioNm).checked){
		radioVal = "<" + radioNm + ">" + eval(radioNm).value + "</" + radioNm + ">";
		return radioVal;
	}
}

///*** 데이터 뿌려주기 ***/

/*기간연동*/
function CoviflowLegacy(sText){	
	//Dataflow("<request>" + sText + "<formdata>" + getInfo("BODY_CONTEXT") + "</formdata>" + "</request>");	
}
function Region(Val){
	var szURL = "VarQuery.aspx";
	var query = "SELECT REGION_CODE,NAME FROM COVI_GROUPWARE.dbo.ORG_REGION WHERE ENT_CODE='"+ Val +"'"
	var querystring = "COVIOrg";
	var sText = "<request><query><![CDATA[" + query + "]]></query><querystring><![CDATA[" + querystring + "]]></querystring></request>";
	requestHTTP("POST",szURL,false,"text/xml",receiveGETHTTP, sText);
}
//신청업무 및 세부항목검색
function ReturnData(num,code){
	var szURL = "VarQuery.aspx";
	if(num == "1"){
		var query = "SELECT UID,NAME FROM COVI_FLOW_SI.dbo.JW_IT_BIZ WHERE UID<>'1'";// WHERE P_SIGN='Y'";
	}else{
		var query = "SELECT SUB_ID,NAME FROM COVI_FLOW_SI.dbo.JW_IT_SUB_BIZ WHERE PARENT_UID='"+code+"'";
	}
	var querystring = "COVI_FLOW_SI";
	var sText = "<request><query><![CDATA[" + query + "]]></query><querystring><![CDATA[" + querystring + "]]></querystring></request>";
	if(num == "1"){
		requestHTTP("POST",szURL,false,"text/xml",receiveGETHTTP1, sText);
	}else{
		requestHTTP("POST",szURL,false,"text/xml",receiveGETHTTP2, sText);
	}
}
function requestHTTP(sMethod,sUrl,bAsync,sCType,pCallback,vBody){
	m_xmlHTTP.open(sMethod,sUrl,bAsync);
	m_xmlHTTP.setRequestHeader("Accept-Language","ko");
	m_xmlHTTP.setRequestHeader("Content-type", sCType);
	if(pCallback!=null)m_xmlHTTP.onreadystatechange = pCallback;
	(vBody!=null)?m_xmlHTTP.send(vBody):m_xmlHTTP.send();
}
function receiveGETHTTP(){
	if(m_xmlHTTP.readyState==4){
		m_xmlHTTP.onreadystatechange=event_noop;
		if(m_xmlHTTP.responseText.charAt(0)=="\r"){
			alert(m_xmlHTTP.responseText);
		}else{
			var errorNode = m_xmlHTTP.responseXML.selectSingleNode("//response/error");
			if(errorNode != null){
				alert("Desc: " + errorNode.text);
			}else{
				try{
				//alert("text: "+m_xmlHTTP.responsetext);
					var elmList = m_xmlHTTP.responseXML.selectNodes("//response/NewDataSet/Table");
					for (var i=0; i<elmList.length; i++){
						var oOption = document.createElement("OPTION");
						REGION.options.add(oOption);
						oOption.innerText=elmList.item(i).selectSingleNode("NAME").text;
						oOption.value=elmList.item(i).selectSingleNode("REGION_CODE").text;
					}
				}catch(e){alert("Error : " + e.description + "\r\nError number: " + e.number);}
			}
		}
	}
}
function receiveGETHTTP1(){
	if(m_xmlHTTP.readyState==4){
		m_xmlHTTP.onreadystatechange=event_noop;
		if(m_xmlHTTP.responseText.charAt(0)=="\r"){
			alert(m_xmlHTTP.responseText);
		}else{
			var errorNode = m_xmlHTTP.responseXML.selectSingleNode("//response/error");
			if(errorNode != null){
				alert("Desc: " + errorNode.text);
			}else{
				try{
				//alert("text: "+m_xmlHTTP.responsetext);
					var elmList = m_xmlHTTP.responseXML.selectNodes("//response/NewDataSet/Table");
					for (var i=0; i<elmList.length; i++){
						var oOption = document.createElement("OPTION");
						REQDUTY.options.add(oOption);
						oOption.innerText=elmList.item(i).selectSingleNode("NAME").text;
						oOption.value=elmList.item(i).selectSingleNode("UID").text;
					}
				}catch(e){alert("Error : " + e.description + "\r\nError number: " + e.number);}
			}
		}
	}
}
function receiveGETHTTP2(){
	if(m_xmlHTTP.readyState==4){
		m_xmlHTTP.onreadystatechange=event_noop;
		if(m_xmlHTTP.responseText.charAt(0)=="\r"){
			alert(m_xmlHTTP.responseText);
		}else{
			var errorNode = m_xmlHTTP.responseXML.selectSingleNode("//response/error");
			if(errorNode != null){
				alert("Desc: " + errorNode.text);
			}else{
				try{
				//alert("text: "+m_xmlHTTP.responsetext);
					var elmList = m_xmlHTTP.responseXML.selectNodes("//response/NewDataSet/Table");
					for (var i=0; i<elmList.length; i++){
						var oOption = document.createElement("OPTION");
						REQDUTYSUB.options.add(oOption);
						oOption.innerText=elmList.item(i).selectSingleNode("NAME").text;
						oOption.value=elmList.item(i).selectSingleNode("SUB_ID").text;
					}
				}catch(e){alert("Error : " + e.description + "\r\nError number: " + e.number);}
			}
		}
	}
}
function event_noop(){return(false);}
</script>
</body>
</html>
