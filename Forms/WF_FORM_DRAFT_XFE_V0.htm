<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma" content="no-cache" />
	<title></title>			
	<link rel="stylesheet" href="/GWImages/common/css/css_style.css" type="text/css" />
	<!--필수 양식파일에 쓰이는 js 파일-->
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Config.js" ></script>
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/ClientMessageBox.js" ></script>
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/EmbedObject.js" ></script>
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Utility.js" ></script>
	<script type="text/javascript" language="javascript" src="../../Common/script/COVIFlowNet/openWindow.js" ></script>		
	<script type="text/javascript" language="javascript" src="../../Common/script/progress.js" ></script>
	<!--여기까지 무조건 넣어야 함-->
	<script type="text/javascript" language="javascript" src="../../common/script/NameControl.js"></script>
	<script type="text/javascript" language="javascript" src="formedit.js" ></script>
	<script type="text/javascript" language="javascript" >
	    // 시스템 사용 에디터 0.TextArea, 1.DHtml, 2.TagFree, 3.XFree, 4.TagFree/XFree, 5.Activesquare, 6.CrossEditor, 7.ActivesquareDefault/CrossEditor -
	    if (getInfo("editortype") == "3" || (getInfo("editortype") == "4" && !window.ActiveXObject)) {
	        document.write("<script src=\"/CoviWeb/common/Editor/XFree/js/tse.js\" type=\"text/javascript\"language=\"javascript\"><" + "/" + "script>");
	    }
	    if (getInfo("editortype") == "6" || (getInfo("editortype") == "7" && !window.ActiveXObject)) {
	        document.write("<script src=\"/CoviWeb/common/Editor/NamoCrossEditor/js/namo_scripteditor.js\" type=\"text/javascript\"language=\"javascript\"><" + "/" + "script>");
        }
        if (getInfo("editortype") == "8") {
            document.write("<script src=\"/CoviWeb/common/Editor/dext5editor/js/dext5editor.js\" type=\"text/javascript\"language=\"javascript\"><" + "/" + "script>");
        }
	</script>
</head>

<body topmargin="0" leftmargin="0" scroll="auto" >
<!-- COMMON FIELDS -->
<input type="hidden" id="dField" name="INITIATOR_NAME" dataFld="usdn" />
<input type="hidden" id="dField" name="INITIATOR_ID" dataFld="usid" />
<input type="hidden" id="dField" name="INITIATOR_OU_NAME" dataFld="dpdn_apv" />
<input type="hidden" id="dField" name="INITIATOR_OU_ID" dataFld="dpid_apv" />
<input type="hidden" id="cField" name="LAST_MODIFIER_ID" /> 
<input type="hidden" id="cField" name="attach" />
<input type="hidden" id="cField" name="filelocation" dataFld="fmfl" />
<input type="hidden" id="cField" name="ATTACH_FILE" value="" />
<input type="hidden" id="dField" name="ATTACH_FILE_INFO" value="" dataFld="ATTACH_FILE_INFO" />
<input type="hidden" id="dField" name="INITIATOR_INFO" value="" dataFld="INITIATOR_INFO" />
<input type="hidden" id="dField" name="APPLIED" dataFld="APPLIED" />										
<input type="hidden" id="dField" name="ISPUBLIC" dataFld="ISPUBLIC" />
<input type="hidden" id="dField" name="APPLIED_TERM" dataFld="APPLIED_TERM" />
<input type="hidden" id="dField" name="RECEIVE_NO" dataFld="RECEIVE_NO" />
<input type="hidden" id="dField" name="RECEIVE_NAMES" dataFld="RECEIVE_NAMES" />
<input type="hidden" id="dField" name="RECEIPT_LIST" dataFld="RECEIPT_LIST" />
<!--<input type="hidden" id="dField" name="DOC_LEVEL"  dataFld="DOC_LEVEL">
<input type="hidden" id="dField" name="SAVE_TERM"  dataFld="SAVE_TERM">-->
<input type="hidden" id="dField" name="DOC_CLASS_ID" dataFld="DOC_CLASS_ID" />
<!--<input type="hidden" id="dField" name="SUBJECT" dataFld="SUBJECT" />-->
<input type="hidden" id="dField" name="DOC_NO" dataFld="DOC_NO" />
<input type="hidden" id="dField" name="DOC_OU_NAME" dataFld="dpdsn" />
<input type="hidden" id="dField" name="ENT_CODE" dataFld="etid" />
<input type="hidden" id="dField" name="ENT_NAME" dataFld="etnm" />
<input type="hidden" id="mField" name="DOC_LEVEL_NAME" />

<textarea  id="dField" name="DOC_SUMMARY" dataFld="DOC_SUMMARY" style="display:none"></textarea>
<textarea id="dhtml_body" style="display:none"></textarea>
<textarea style="display:none" id="cField" name="xsl"></textarea> 

<!-- 문서link 2006.01 -->
<textarea id="dField" name="DOCLINKS" style="display:none"  dataFld="DOCLINKS"></textarea>
<!-- 반송문서 추가 시작 2007.11-->
<textarea id="mField" name="REJECTDOCLINKS" style="display:none"></textarea>
<!-- 반송문서 추가 끝 2007.11-->
<!-- 결재선 관리 UI 변경 2008.01 -->
<textarea style="display:none;" id="cField" name="APVLIST"></textarea> 
<!-- 결재선 관리 UI 변경 끝 2008.01 -->
<!-- process 메뉴얼 추가 2008.01 -->
<textarea id="mField" name="PMLINKS" style="display:none"></textarea>
<!-- process 메뉴얼 추가 2008.01 -->
<!-- END -->

<!-- END -->
<!-- 양식전체본문 -->
	<div id="bodytable">
		<!-- header start -->
		<table id="headtable" border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" align="center" width="740"  >
			<tr>
				<td width="100%" height="5" valign="top" ></td>
			</tr>	
			<tr>
				<td nowrap="t" height="46" width="100%" align="center" >
					<table border="0" bordercolor="#111111" style="border-collapse: collapse;MARGIN-TOP: 0px; width:100%;height:100%;" >
						<tr>
							<td align="center"><span id="headname" class="Approval_title"></span></td>
						</tr>
					</table>
				</td>
			</tr>
			<!-- 결재선 정보 시작-->
			<!-- 일반결재/합의 -->
			<tr>
				<td id="AppLine" width="100%">
					<table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0" bordercolordark="white" bordercolorlight="gray">
						<tr>
							<!-- 발신처 결재란 보이는 부분(왼쪽) -->
							<td id="LApvLine" align="left" width="100%"></td>
						</tr>
						<tr>
							<!-- 수신처 결재란 보이는부분 (오른쪽)-->
							<td id="RApvLine" align="left" width="100%"></td>
						</tr>
					</table>
				</td>
			</tr>
			<!-- 협조자 -->
			<tr>
				<td id="AssistLine" width="100%" style="display:none;"></td>
			</tr>
			<!--참조자 -- 첨부파일 영역으로 옮김 -->
			<!--수신자 -->
			<tr>
				<td id="RRLine" width="100%" style="display:none;"></td>
			</tr>			
			<!-- 결재선 정보 종료-->
			<!-- 문서정보
			보안등급 : 공개/대외비/중요/극비
			보존년한 : 1/3/5/7/10/영구
			문서분류 : 문서이관 시스템 선택
			문서번호 : 문서번호
			사업장구분 : (주)보광일 경우 사용
			-->
			<tr>
				<td width="100%" class="Approval_bg">
		  			<table width="100%" cellpadding="2" cellspacing="0" bgcolor="#FFFFFF" border="1" bordercolor="#dc5f0a" style="border-collapse: collapse;">		
					  <tr>
						<td width="15%"  class="Approval_label">보안등급<br />(Secret Level)</td>
						<td width="35%" valign="middle">&nbsp;<select id="dField" name="DOC_LEVEL" onchange="DOC_LEVEL_Change(this);"></select></td>
						<td width="15%" class="Approval_label">보존년한<br />(Storage Year)</td>
						<td width="35%" valign="middle">&nbsp;<select id="dField" name="SAVE_TERM"></select></td>
					  </tr>
					  <tr>
						<td width="15%"  class="Approval_label">문서분류<br />(Kind Doc.)</td>
						<td width="35%" valign="middle">&nbsp;<input type="TEXT" id="dField" name="DOC_CLASS_NAME" dataFld="DOC_CLASS_NAME" size="20" readonly  class="Approval_type-text" style="height: 20px" />&nbsp;<img src="/GWImages/Common/btn/btn_organization.gif" name="btn_Process" id="btn_Process" align="absMiddle"
										border="0" onClick="OpenDocClass();" style="cursor:hand" /></td>
						<td width="15%"  class="Approval_label">문서번호<br />(No Doc.)</td>
						<td width="35%" valign="middle">&nbsp;</td>
					  </tr>
					  <tr id="partdisplay" style="display:none;">
						<td width="15%"  class="Approval_label">사업장분류<br />(Kind company)</td>
						<td colspan="3" width="85%" valign="middle" >&nbsp;<select id="mField" name="SEL_ENTPART"></select></td>
					  </tr>
					  <tr height="25" id="workrequestdisplay" style="display:none;">
						<td width="15%"  class="Approval_label" style="display:none;">관련업무의뢰<br />(Request Task)</td>
						<td colspan="3" width="85%">&nbsp;<input type="hidden" id="mField" name="WORKREQUEST_ID" />
							<input type="TEXT" id="mField" name="WORKREQUEST_NAME" size="20" readonly class="Approval_type-text" style="height: 20px" />&nbsp;
								<a href="#" class="Btn02" onClick="javascript:OpenWorkRequest();"><span>추가[+]</span></a> 
								<a href="#" class="Btn02" onClick="javascript:DelWorkRequest();"><span>삭제[-]</span></a>
						</td>
					  </tr>
				   </table>
				   
				</td>
			</tr> 
			<tr>
				<td width="100%" height="1" valign="top"></td>
			</tr>			
		</table>
		<!-- header end -->
		<table border="0" cellpadding="0" cellspacing="0" align="center" width="740"><tr><td height="2"></td></tr></table>
		<!-- bodycontext start -->
		<table id="bodycontext" border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" align="center" width="740">
		<tr>
		<td class="Approval_bg">
			<table width="100%" height="400" cellpadding="2" cellspacing="0" bgcolor="#FFFFFF" border="1" bordercolor="#dc5f0a" style="border-collapse: collapse;">
				<tr>
					<td width="15%" height="25"  class="Approval_label"><span style="color:Red;">*</span>제목(Subject)</td> 
                    <td width="85%" height="25">&nbsp;<input id="dField" name="SUBJECT" datafld="SUBJECT" style="border:1px solid #dc5f0a; font-size:9pt;padding-left:4;padding-top:5;width:98%; height: 25px; font-weight:bold;" /></td>
				</tr>														
				<!--실 결재양식 내용 부분 시작 -->
				<!-- 에디터 시작 -->
				<tr height="100%">
					<td colspan="2" width="100%" height="100%">
					<div id="DhtmlBody" name="DhtmlBody">
						<script type="text/javascript" language="javascript" >
							document.write("<script type=\"text/javascript\" language=\"javascript\" src=\"editControl.js\"><" + "/" + "script>");
						</script>
					</div>
					</td>
				</tr>			
			   <!-- 에디터 끝 -->
				<!--실 결재양식 내용 부분 끝 -->
			</table>
		</td>
		</tr>
		</table>
		<!-- bodycontext end -->
		<table border="0" cellpadding="0" cellspacing="0"  width="740"><tr><td height="2"></td></tr></table>
		<table cellpadding="2" cellspacing="0" bgcolor="#FFFFFF" border="1" bordercolor="#dc5f0a" style="border-collapse: collapse;" align="center" width="740" height="75">
			<tr height="25">
				<td width="15%" height="25"  class="Approval_label">참조(Reference)</td> 
				<td width="85%" id="CCLine" style='padding-left:2px;font-family: "돋움", Dotum; font-size: 12px;'>
					<div id="SendCC"></div>
					<div id="RecCC"></div>
				</td>
			</tr>
			<tr height="25">
				<td width="15%"  class="Approval_label">첨부파일<br />(Attached Files)</td>
				<td width="85%" id="AttFileInfo" style='padding-left:2px;font-family: "돋움", Dotum; font-size: 12px;'></td>
			</tr>
			<tr height="25">
				<td width="15%" height="24"  class="Approval_label">연결문서<br />(Doc. Link)</td>
				<td width="85%" id="DocLinkInfo" style='padding-left:2px;font-family: "돋움", Dotum; font-size: 12px;'></td>
			</tr>
			<!-- 반송문서 추가 시작 2007.11-->
			<tr>
				<td width="15%" height="24"  class="Approval_label">원문서<br />(Original Doc.)</td>
				<td  width="85%"  id="RejectDocLinkInfo" style='padding-left:2px;font-family: "돋움", Dotum; font-size: 12px;'></td>
			</tr>
			<!-- 반송문서 추가 끝 2007.11-->
			<!-- 프로세스 메뉴얼 연결 추가 시작 2008.01-->
			<tr id="trPMLinkInfo" style="display:none;">
				<td width="15%" height="24"  class="Approval_label">관련 프로세스 메뉴얼</td>
				<td  width="85%"  id="PMLinkInfo" style='padding-left:2px;font-family: "돋움", Dotum; font-size: 12px;'></td>
			</tr>
			<!-- 프로세스 메뉴얼 끝 2007.11-->			
			
			<!-- 
			<tr height="20">
				<td width="80" align="center" style='background:#D7D7D7;font-size:9pt;font-weight:bold;'>EDM문서</td>
				<td><span id="EDMSLinkInfo" style='padding-left:8px;font-size:9pt;'></span></td>
			</tr>-->
		</table>
		
		<table border="0" cellpadding="0" cellspacing="0" align="center" width="740"><tr><td height="2"></td></tr></table>
		<!--write_의견입력-->
		<table border="0" cellpadding="0" cellspacing="0" align="center" width="740">
		<tr>
			<td align="center" id="tdCommentView"  width="100%" style="display:none;">				
			</td>
		</tr>
		</table>
		<!--write_ 의견입력끝 -->		
		</div>
		<div id="divforminfo" style="display:none">
			<table cellpadding="2" cellspacing="0" bgcolor="#FFFFFF" border="1" bordercolor="#dc5f0a" style="border-collapse: collapse;" align="center" width="740">
			
				<tr height="25">
					<td width="15%" height="25"  class="Approval_label">문서설명<br />(Descrip. Doc.)</td> 
					<td width="85%" id="tdforminfo" style='padding-left:2px;font-family: "돋움", Dotum; font-size: 12px;'></td>
				</tr>
			</table>
		</div>
		<script language="javascript" src="formedit_object.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript">
window.onload = initOnload;
function initOnload() {
	initialize();
}

function initialize() {
	if (window.parent.document.readyState == "complete") {
		window.parent.document.onreadystatechange = event_noop;
		initENTPART(); //사업장 코드 조회		
		initForm();
		initApvList();
		if (getInfo("editortype") == "2" || (getInfo("editortype") == "4" && window.ActiveXObject)) {
		    if (document.tbContentElement.ActiveTab > 0) window.setTimeout(setTagFreeBug, 500);
		}
    } else {
		window.setTimeout(initialize, 500);
	}				
}

function initForm(){
	// window.top.resizeTo(800,720);
	initFields();
	G_displaySpnAttInfo(false);
	//if(getInfo("pdefname").indexOf("ApprovalSystem-Draft") != -1) {parent.menu.recedit.style.display="none";}
	//문서 이관 여부에 따른 셋팅
}

function initFields(szBody){
	setFields((!window.ActiveXObject) ? document.getElementById("dField") : dField); //editable field
	setFields((!window.ActiveXObject) ? document.getElementById("cField") : cField); //readonly field

	document.getElementById("headname").innerHTML = initheadname(getInfo("fmnm"), true);
	if (getInfo("mode") == "DRAFT" || getInfo("mode") == "TEMPSAVE") {
		document.getElementsByName("INITIATOR_INFO")[0].value = getInfo("usdn"); //getInfo("dpdn_apv")+" "+getInfo("usdn") + " "+ getInfo("ustn") ;
		document.getElementsByName("APPLIED").value = formatDate(getInfo("svdt"), "D");
	} else {
		document.getElementsByName("SUBJECT")[0].disabled = true;
	}
	//기타 필드 채우기	
	setSaveTerm(); //보존년한 create	
	//setDocLevel();  // 보안등급 create

	//본문 내용
	if (getInfo("editortype") == "2" || (getInfo("editortype") == "4" && window.ActiveXObject)) {//2.TagFree, 3.XFree, 4.TagFree/XFree
	} else if (getInfo("editortype") == "6" || (getInfo("editortype") == "7" && !window.ActiveXObject)) {// 5.Activesquare, 6.CrossEditor, 7.ActivesquareDefault/CrossEditor -
    } else if (getInfo("editortype") == "8") {
        dextgetContent();
    } else {
	    if (getInfo("BODY_CONTEXT") != undefined) {
	        setBodyContext(getInfo("BODY_CONTEXT"));
	    } else {
	        setBodyContext(getInfo("fmbd").replace("euc-kr", "utf-8"));
	    }
	}
}

function getBodyContext() {
    if (getInfo("editortype") == "3" || (getInfo("editortype") == "4" && !window.ActiveXObject)) {//2.TagFree, 3.XFree, 4.TagFree/XFree
        document.getElementById("dhtml_body").value = tbContentElement.GetHtmlValue();
        UpdateImageData(); //이미지 업로드
    } else if (getInfo("editortype") == "2" || (getInfo("editortype") == "4" && window.ActiveXObject)) {//2.TagFree, 3.XFree, 4.TagFree/XFree
        document.getElementById("dhtml_body").value = document.tbContentElement.HtmlValue;
        UpdateImageData(); //이미지 업로드
    } else if (getInfo("editortype") == "6" || (getInfo("editortype") == "7" && !window.ActiveXObject)) {// 5.Activesquare, 6.CrossEditor, 7.ActivesquareDefault/CrossEditor -
        document.getElementById("dhtml_body").value = tbContentElement.GetBodyValue();
        UpdateImageData(); //이미지 업로드
    } else if (getInfo("editortype") == "5" || (getInfo("editortype") == "7" && window.ActiveXObject)) {// 5.Activesquare, 6.CrossEditor, 7.ActivesquareDefault/CrossEditor -
        document.getElementById("dhtml_body").value = document.tbContentElement.value;
        UpdateImageData(); //이미지 업로드
        document.getElementById("dhtml_body").value = document.tbContentElement.value;
    } else if (getInfo("editortype") == "0") {//0.TextArea
        document.getElementById("dhtml_body").value = document.getElementById("tbContentElement").value;
    } else if (getInfo("editortype") == "8") {//8 dext5
        document.getElementById("dhtml_body").value = DEXT5.getBodyValue();
    }
	
	var sBodyContext = makeBodyContext();
	return makeNode("BODY_CONTEXT", sBodyContext, null, false);
}

function setFields(Fields){
	if (!window.ActiveXObject) {
		var szId = Fields.id;
		var unFiltered = document.getElementsByTagName('*');
		for (i = 0; i < unFiltered.length; i++) {
			if (unFiltered[i].getAttribute('id') == szId) {
				var fld = unFiltered[i];
				if (fld.getAttribute("dataFld") != null) { (getInfo(fld.getAttribute("name")) != undefined) ? fld.value = getInfo(fld.getAttribute("name")) : (getInfo(fld.getAttribute("dataFld")) != undefined) ? fld.value = getInfo(fld.getAttribute("dataFld")) : fld.value = ''; }
				if (fld.getAttribute("name") != null) {
					if (fld.getAttribute("name") == 'POSITION' && getInfo(fld.getAttribute("name")) == "") {
						fld.value = getInfo(fld.getAttribute("dataFld"));
					}
				}
			}
		}
	} else {
		for (var i = 0; i < Fields.length; i++) {
			var fld = Fields[i];
			if (fld.dataFld != "") { (getInfo(fld.name) != undefined) ? fld.value = getInfo(fld.name) : (getInfo(fld.dataFld) != undefined) ? fld.value = getInfo(fld.dataFld) : fld.value = ''; }
			if (fld.name == 'POSITION' && getInfo(fld.name) == "") {
				fld.value = getInfo(fld.dataFld);
			}
		}
	}
}
function checkForm(bTempSave){
	if (bTempSave) {
		return true;
	} else {
		if (document.getElementsByName("SUBJECT")[0].value == '') {
			alert('제목을 입력하세요.');
			//SUBJECT.focus();
			return false;
		} else if (document.getElementsByName("SAVE_TERM")[0].value == '') {
			alert('보존년한을 선택하세요.');
			return false;
		} else {
			return true;
		}
	}
}

function setBodyContext(sBodyContext){
	//본문 채우기
	var m_objXML = CreateXmlDocument();
	var elmList, elm;
	var elmListLan;

	m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>" + getInfo("BODY_CONTEXT"));
	try {
		elmList = m_objXML.documentElement.childNodes;
		for (var i = 0; i < elmList.length; i++) {
			var elm = elmList[i];
			innerHtmlData(elm.nodeName, elm.text);
		}
		//본문 채우기
		setdField();
	}
	catch (e) { }
}

//본문 XML로 구성
function makeBodyContext(){
	var sBodyContext = "";
	//xml 구성 예제 : <body><item><name></name></item><item><name></name></item></body>
	//sBodyContext="<body><item><name>첫번째</name></item><item><name>두번째</name></item></body>";

	sBodyContext = "<BODY_CONTEXT>" + "<tbContentElement><![CDATA[" + document.getElementById("dhtml_body").value + "]]></tbContentElement>" + getFields(document.getElementById("mField")) + "</BODY_CONTEXT>";
	return sBodyContext;
}

/*** form data -> xml ***/
function getFields(Fields){
	var sText = "";
//	for(var i=0;i<Fields.length;i++){
//		if (Fields[i].name.indexOf("SEL_") > -1){
//			sText += getSelRadio(Fields[i].name);
//		}else{
//			sText += makeNode(Fields[i].name, Fields[i].value);
//		} 
//	}
	if (Fields != null) {
		var szId = Fields.id;
		var unFiltered = document.getElementsByTagName('*');
		for (var i = 0; i < unFiltered.length; i++) {
			if (unFiltered[i].getAttribute('id') == szId) {
				if (unFiltered[i].getAttribute("name").indexOf("SEL_") > -1) {
					sText += getSelRadio(unFiltered[i]);
				} else {
					sText += makeNode(unFiltered[i].getAttribute("name"), unFiltered[i].value);
				}
			}
		}
	}
	return sText;
}

/*** Radio Button 값 가져오기***/
function getRadio(radioNm){
	var radioVal = "";
	//alert("이름:"+radioNm+"\n객체여부:"+eval(radioNm)+"\n길이:"+eval(radioNm).length+"\n체크여부:"+eval(radioNm).checked);
	for (i = 0; i < eval(radioNm).length; i++) {
		if (eval(radioNm)[i].checked) {
			radioVal = makeNode(radioNm, eval(radioNm)[i].value);
		}
	}
	return radioVal;
}

/*** Single Radio Button Value 가져오기 ***/
function getChkRadio(radioNm){
	if(eval(radioNm).checked){
		radioVal = makeNode(radioNm, eval(radioNm).value);
		return radioVal;
	}
}
/** SELECT BOX VALUE 가져오기 **/
function getSelRadio(obj){
	var radioVal = "";
	var selNm = obj.getAttribute("name");
	if (obj.selectedIndex > -1) {
		radioVal += makeNode(selNm, obj.options[obj.selectedIndex].value);
		radioVal += makeNode(selNm + "_TEXT", obj.options[obj.selectedIndex].text);
	} else {
		radioVal += makeNode(selNm, "");
		radioVal += makeNode(selNm + "_TEXT", "");
	}
	return radioVal;  
}
/*** 데이터 뿌려주기 ***/
function innerHtmlData(nodeNm, nodeVal){
	if (document.getElementsByName(nodeNm)[0] != undefined) {
		if (nodeNm.indexOf("FORM_ATTACH") != -1) {
			setForm_Attach(nodeVal);
			document.getElementsByName(nodeNm)[0].value = nodeVal;
		} else if (nodeNm.indexOf("tbContentElement") != -1) {
		    if (getInfo("editortype") == "0") {//0.TextArea
		        document.getElementById(nodeNm).value = nodeVal;
		    } else if (getInfo("editortype") == "2" || (getInfo("editortype") == "4" && window.ActiveXObject)) {//2.TagFree, 3.XFree, 4.TagFree/XFree
		        var dom = document.tbContentElement.getDom(); dom.body.innerHTML = nodeVal.replace(/<br \/>/gi, "");
		    } else if (getInfo("editortype") == "5" || (getInfo("editortype") == "7" && window.ActiveXObject)) {// 5.Activesquare, 6.CrossEditor, 7.ActivesquareDefault/CrossEditor -
		        document.tbContentElement.value = nodeVal;
		    }
		} else if (nodeNm.indexOf("OPT") != -1) {
			setRadio(nodeNm, nodeVal);
		} else if (nodeNm.indexOf("CHK") != -1) {
			setChk(nodeNm, nodeVal);
		} else {
			document.getElementsByName(nodeNm)[0].value = nodeVal;
		}
	}
}

/*** 라디오 버튼 value display ***/
function setRadio(szname, szvalue){	
	var objrdo = document.getElementsByName(szname);
	for(i=0;i<objrdo.length;i++){	
		if(objrdo[i].value == szvalue) objrdo[i].checked = true;
	}
}

/*** single 라디오 버튼 value display ***/
function setChk(szname, szvalue){	
	var objrdo = document.getElementsByName(szname);
	if(objrdo.value == szvalue) objrdo.checked = true;
}

</script>
<!-- 태그프리 추가-->
<script language="JScript" FOR="tbContentElement" EVENT="OnControlInit">
   //본문 내용  
   if (getInfo("BODY_CONTEXT") != undefined){	 //기안,임시저장으로 저장된 값 setting
		/*
	   var m_objXML = new ActiveXObject("MSXML2.DOMDocument");
	   m_objXML.loadXML("<root>"+getInfo("BODY_CONTEXT")+"</root>");

	   try{tbContentElement.HtmlValue = m_objXML.documentElement.selectSingleNode("TagFree").text;}catch(e){}
	   */
	   setBodyContext(getInfo("BODY_CONTEXT"));
	   try{G_displaySpnDocLinkInfo();}catch(e){}

   }else {//양식 생성 시 입력한 본문내역 조회			
		if (getInfo("fmbd") != "undefined")
		{
	  
		 try{var dom = tbContentElement.getDom();	dom.body.innerHTML= getInfo("fmbd");}catch(e){}
		}
   }	 

</script>
</body>
</html>
