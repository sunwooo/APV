<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma" content="no-cache" />
	<title></title>	
	<link rel="stylesheet" href="/GWImages/common/css/approval_form.css" type="text/css" />
    <style type="text/css">
        a.a1 {color: DarkOrange;}
    </style>
    <!--필수 양식파일에 쓰이는 js 파일-->
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Config.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/EmbedObject.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Utility.js" ></script>
    <script type="text/javascript" language="javascript" src="../../Common/script/COVIFlowNet/openWindow.js" ></script>		
	<script type="text/javascript" language="javascript" src="../../Common/script/progress.js" ></script>
	<script type="text/javascript" language="javascript" src="../../common/script/NameControl.js"></script>
	<script type="text/javascript" language="javascript" src="../../common/script/jquery-1.6.1.min.js"></script>
	<script type="text/javascript" language="javascript" src="formedit.js" ></script>
	<script type="text/javascript" language="javascript" src="formedit_apvlinemgr.js" ></script>
    <!-- 캘린더 관련 시작 -->
    <link rel="stylesheet" href="/CoviWeb/SiteReference/Jcalendar/themes/base/jquery.ui.all.css"/>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/jquery-1.8.2.js"></script>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/JqueryDatePicker.js"></script>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/ui/jquery.ui.core.js"></script>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/ui/jquery.ui.datepicker.js"></script>
    <!-- 캘린더 관련 종료 -->
</head>

<body topmargin="0" leftmargin="0" style="OVERFLOW: auto; overflow-x: hidden;" >
<!-- COMMON FIELDS -->
<input type="hidden" id="dField" name="INITIATOR_NAME" dataFld="usdn" />
<input type="hidden" id="dField" name="INITIATOR_ID" dataFld="usid" />
<input type="hidden" id="dField" name="INITIATOR_OU_NAME" dataFld="dpdn_apv" />
<input type="hidden" id="dField" name="INITIATOR_OU_ID" dataFld="dpid_apv" />
<input type="hidden" id="cField" name="LAST_MODIFIER_ID" /> 
<input type="hidden" id="cField" name="attach" />
<input type="hidden" id="cField" name="filelocation" dataFld="fmfl" />
<input type="hidden" id="cField" name="ATTACH_FILE" value="" />
<input type="hidden" id="dField" name="ATTACH_FILE_INFO" value="" dataFld="ATTACH_FILE_INFO" />
<input type="hidden" id="dField" name="INITIATOR_INFO" value="" dataFld="INITIATOR_INFO" />
<input type="hidden" id="dField" name="APPLIED" dataFld="APPLIED" />										
<input type="hidden" id="dField" name="ISPUBLIC" dataFld="ISPUBLIC" />
<input type="hidden" id="dField" name="APPLIED_TERM" dataFld="APPLIED_TERM" />
<input type="hidden" id="dField" name="RECEIVE_NO" dataFld="RECEIVE_NO" />
<input type="hidden" id="dField" name="RECEIVE_NAMES" dataFld="RECEIVE_NAMES" />
<input type="hidden" id="dField" name="RECEIPT_LIST" dataFld="RECEIPT_LIST" />
<!--<input type="hidden" id="dField" name="DOC_LEVEL"  dataFld="DOC_LEVEL">
<input type="hidden" id="dField" name="SAVE_TERM"  dataFld="SAVE_TERM">-->
<input type="hidden" id="dField" name="DOC_CLASS_ID" dataFld="DOC_CLASS_ID" />
<!--<input type="hidden" id="dField" name="SUBJECT" dataFld="SUBJECT" />-->
<input type="hidden" id="dField" name="DOC_NO" dataFld="DOC_NO" />
<input type="hidden" id="dField" name="DOC_OU_NAME" dataFld="dpdsn" />
<input type="hidden" id="dField" name="ENT_CODE" dataFld="etid" />
<input type="hidden" id="dField" name="ENT_NAME" dataFld="etnm" />
<input type="hidden" id="mField" name="DOC_LEVEL_NAME" />

<!--PSW 2020-06-04-->
<input type="hidden" id="mField" name="hdnDataRowCnt" /> <!--데이터행갯수-->
<input type="hidden" id="mField" name="hdnSumTotalPrice" /> <!--총 합산-->

<textarea  id="dField" name="DOC_SUMMARY" dataFld="DOC_SUMMARY" style="display:none"></textarea>
<textarea id="dhtml_body" style="display:none"></textarea>
<textarea style="display:none" id="cField" name="xsl"></textarea> 

<!-- 문서link 2006.01 -->
<textarea id="dField" name="DOCLINKS" style="display:none"  dataFld="DOCLINKS"></textarea>
<!-- 반송문서 추가 시작 2007.11-->
<textarea id="mField" name="REJECTDOCLINKS" style="display:none"></textarea>
<!-- 반송문서 추가 끝 2007.11-->
<!-- 결재선 관리 UI 변경 2008.01 -->
<textarea style="display:none;" id="cField" name="APVLIST"></textarea> 
<!-- 결재선 관리 UI 변경 끝 2008.01 -->
<!-- process 메뉴얼 추가 2008.01 -->
<textarea id="mField" name="PMLINKS" style="display:none"></textarea>
<!-- process 메뉴얼 추가 2008.01 -->
<!-- END -->

<!-- 양식전체본문 -->
<div id="bodytable">
        <!-- header start -->
        <div class="draft_tit"><h4><span id="headname"></span><a href="#"><span class="drop_menu"></span></a></h4></div>
        <div class="draft_page">

            <!--######## 양식상단부분 공통 시작 #################################-->
            <table class="table_2" summary="문서분류" cellpadding="0" cellspacing="0">
                <tr style="display:none;">
                    <th>보안등급</th>
                    <td><select id="dField" name="DOC_LEVEL" onchange="DOC_LEVEL_Change(this);"></select></td>
                    <th>문서번호</th>
                    <td width="100px"></td>
                </tr>
                <tr>
                    <th>문서분류</th>
                    <td>
                        <input type="text" id="dField" name="DOC_CLASS_NAME" dataFld="DOC_CLASS_NAME" size="20" readonly="readonly" style="width:70%; width:70%; height:20px;" />&nbsp;
                        <img src="/GWImages/Common/btn/btn_organization.gif" name="btn_Process" id="btn_Process" align="absMiddle" border="0" onClick="OpenDocClass();" style="cursor:hand" />
                    </td>
                    <th>보존년한</th>
                    <td colspan="3"><select id="dField" name="SAVE_TERM"></select></td>
                </tr>
            </table>
            <!-- header end -->
            <!-- bodycontext start -->
            <table class="table_3" summary="제목" cellpadding="0" cellspacing="0">
                <tr>
                    <th>제&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;목<span class="txt_red">*</span></th>
                    <td><input id="dField" name="SUBJECT" datafld="SUBJECT" onkeyup="SetSubjectTbxSync();" style="width:100%; height:20px;" /></td>
                </tr>

            </table>


            <!--######## 양식상단부분 공통 종료 #################################-->
            <!--######## 본문부분 시작 #########################################-->
            <div id="divBodyContent">
                <!--추가(인쇄용) HIW-->
                <table border="0" style="width:720px;">
                    <tr>
                        <td align="center" style="padding-top:5px; padding-bottom:5px;"></td>
                    </tr>
                </table>

                <table class="table_html" id="tblBodyContent" summary="내용" cellpadding="0" cellspacing="0">
                    <tr>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">구분</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">부서</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">성명</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">직위</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">연락처</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">비고</td>
                    </tr>
                    <tr>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">신청자</td>
                        <td align="center">
                            <input type="text" id="mField" name="txtRequestDept" style="height:25px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="txtRequester" style="height:25px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="txtRequestPosition" style="height:25px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="txtRequestTel" style="height:25px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="txtBigo" style="height:25px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" />
                        </td>
                    </tr>
                    <tr>
                        <td rowspan="2" align="center" style="height:25px;width:120px; background-color:#F6F6F6;">요청 구분</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6;">신규 생성</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6;">내용 변경</td>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6;">종료</td>
                        <td colspan="2" align="center" style="height:25px;width:240px; background-color:#F6F6F6;">비고</td>
                    </tr>
                    <tr>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="radio" id="mField" name="OPT_Guboon" value="신규 생성" onclick="ChangeGuboonRdo(1);" style="border:0px;" />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="radio" id="mField" name="OPT_Guboon" value="내용 변경" onclick="ChangeGuboonRdo(2);" style="border:0px;" />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="radio" id="mField" name="OPT_Guboon" value="종료" onclick="ChangeGuboonRdo(3);" style="border:0px;" />
                        </td>
                        <td colspan="2" align="center" style="height:25px;width:240px;">해당란에 체크 (필수사항)</td>
                    </tr>
                    <tr id="third">
                        <td rowspan="2" align="center" style="height:30px;width:120px; background-color:#F6F6F6; BORDER-TOP: 0px;">오더 정보</td>
                        <td align="center" style="height:30px;width:120px; background-color:#F6F6F6">내부오더번호</td>
                        <td align="center" style="height:30px;width:120px; background-color:#F6F6F6">작업시작(예정)일</td>
                        <td align="center" style="height:30px;width:120px; background-color:#F6F6F6">작업종료(예정)일</td>
                        <td colspan="2" align="center" style="height:30px; background-color:#F6F6F6">비고</td>
                    </tr>
                    <tr id="third1">
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="Order_num" style="border:0px; width:90%; text-align:center; " />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="Start_date" style="border:0px; width:90%; text-align:center; " />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="End_date" style="border:0px; width:90%; text-align:center; " />
                        </td>
                        <td colspan="2" align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="Bigo" style="border:0px; width:90%; text-align:center; " />
                        </td>
                    </tr>
                    <tr id="third2">
                        <td rowspan="2" align="center" style="height:30px;width:120px; background-color:#F6F6F6; BORDER-TOP: 0px;">오더(자산)번호</td>
                        <td align="center" style="height:30px;width:120px; background-color:#F6F6F6">내부오더번호</td>
                        <td align="center" style="height:30px;width:120px; background-color:#F6F6F6">자산 번호</td>
                        <td align="center" style="height:30px;width:120px; background-color:#F6F6F6"></td>
                        <td colspan="2" align="center" style="height:30px; background-color:#F6F6F6">비고</td>
                    </tr>
                    <tr id="third3">
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="Order_num2" style="border:0px; width:90%; text-align:center; " />
                        </td>
                        <td align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="Asset_num" style="border:0px; width:90%; text-align:center; " />
                        </td>
                        <td align="center" style="height:25px;width:120px;"></td>
                        <td colspan="2" align="center" style="height:25px;width:120px;">
                            <input type="text" id="mField" name="Bigo2" style="border:0px; width:90%; text-align:center; " />
                        </td>
                    </tr>


                </table>
                <table border="0" style="width:720px;">
                    <tr>
                        <td align="center" style="padding-top:5px; padding-bottom:5px;"></td>
                    </tr>
                </table>
                <table class="table_html" id="tblBodyContent" summary="내용" cellpadding="0" cellspacing="0">
                    <tr>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6">요청 내용</td>
                        <td colspan="6" align="center" style="height:25px;width:600px;border-bottom-color:#ffffff;"></td>
                    </tr>
                    <tr id="first">
                        <td colspan="7" align="center" style="height:150px;width:720px;">
                            <textarea id="mField" name="txtRequestContent" rows="4" cols="3" style="width:95%;height:80%"></textarea>
                        </td>
                    </tr>
                    <tr id="second">
                        <td colspan="6" align="center" style="height:150px;width:720px;">
                            <textarea id="mField" name="txtRequestContent2" rows="1" cols="3" style="width:95%;height:80%"></textarea>
                        </td>
                    </tr>
                    <tr id="second1">
                        <table class="table_html" id="tblDataRowPerson" cellpadding="0" cellspacing="0" border="0" width="100%">
                            <tr>
                                <td align="center" style="height:25px;width:70px; background-color:#F6F6F6; BORDER-TOP: 0px;">번호<br/><a class="a1" href="javascript:AddRowDataPerson();"><b>[+]</b></a>&nbsp;<a class="a1" href="javascript:DelRowDataPerson();"><b>[-]</b></a></td>
                                <td align="center" style="height:25px;width:170px; background-color:#F6F6F6">자산클래스</td>
                                <td align="center" style="height:25px;width:96px; background-color:#F6F6F6">구분</td>
                                <td align="center" style="height:25px;width:96px; background-color:#F6F6F6">자산마스터</td>
                                <td align="center" style="height:25px;width:96px; background-color:#F6F6F6">주요생산품</td>
                                <td align="center" style="height:25px;width:96px; background-color:#F6F6F6">금액</td>
                                <td align="center" style="height:25px;width:96px; background-color:#F6F6F6">비고</td>
                            </tr>
                        </table>

                    </tr>
                    <tr id="second2">
                        <table class="table_html" id="tblDataRowPrice" cellpadding="0" cellspacing="0" border="0" width="100%"> 
                            <tr>
                                <td align="center" style="height:25px;width:241px; background-color:#F6F6F6; BORDER-TOP: 0px;">합계<a class="a1" href="javascript:goSum();">&nbsp;<b>[계산]</b></a></td> 
                                <td align="center" style="height:25px;width:96px;"></td>
                                <td align="center" style="height:25px;width:96px; "></td>
                                <td align="center" style="height:25px;width:96px; "></td>
                                <td align="center" style="height:25px;width:96px; ">
                                    <input type="text" id="mField" name="hdnSumTotalPrice" style="border:0px; width:90%; text-align:right; " readonly="readonly" onfocus="this.value=numberFormat(this.value);" />
                                </td>
                                <td align="center" style="height:25px;width:96px; "></td>
                            </tr>
                        </table>
                    </tr>

                </table>
                <table class="table_html" id="tblBodyContent" summary="내용" cellpadding="0" cellspacing="0">
                    <tr>
                        <td align="center" style="height:25px;width:120px; background-color:#F6F6F6;BORDER-TOP: 0px;">검토 의견</td>
                        <td colspan="6" align="center" style="height:25px;width:600px;border-bottom-color:#ffffff;BORDER-TOP: 0px;"></td>
                    </tr>
                    <tr>
                        <td colspan="7" align="center" style="height:150px;width:720px;">
                            <textarea id="mField" name="txtRequestResult" rows="4" cols="3" style="width:95%;height:80%;"></textarea>
                        </td>
                    </tr>
                </table>
                <br />
                <table class="table_html" id="tblBodyContent" summary="내용" cellpadding="0" cellspacing="0"></table>
            </div>
            <!--######## 본문부분 종료 ##########################################-->
            <!--######## 양식하단부분 공통 시작 #################################-->

            <div id="divApprovalLine">
                <!--추가(인쇄용) HIW-->
                <table class="table_5" summary="참조" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>첨부파일</th>
                        <td id="AttFileInfo" align="left"></td>
                    </tr>
                    <tr>
                        <th>연결문서</th>
                        <td id="DocLinkInfo" align="left"></td>
                    </tr>
                    <tr style="display:none;">
                        <th>원 문 서</th>
                        <td id="RejectDocLinkInfo" align="left">-</td>
                    </tr>
                    <tr>
                        <th>참조</th>
                        <td id="CCLine" align="left">
                            <div id="SendCC"></div>
                            <div id="RecCC"></div>&nbsp;
                        </td>
                    </tr>
                </table>

                <!-- 결재선 정보 시작-->
                <table width="100%" cellpadding="0" cellspacing="0">
                    <!-- 일반결재/합의 -->
                    <tr>
                        <td style="height:7px;"></td>
                    </tr>
                    <tr>
                        <td id="AppLine" width="100%">
                            <table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0" bordercolordark="white" bordercolorlight="gray">
                                <tr>
                                    <!-- 발신처 결재란 보이는 부분(왼쪽) -->
                                    <td id="LApvLine" align="left" width="100%"></td>
                                </tr>
                                <tr>
                                    <!-- 수신처 결재란 보이는부분 (오른쪽)-->
                                    <td id="RApvLine" align="left" width="100%"></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <!-- 협조자 -->
                    <tr>
                        <td id="AssistLine" width="100%" style="display:none;"></td>
                    </tr>
                    <!--참조자 -- 첨부파일 영역으로 옮김 -->
                    <!--수신자 -->
                    <tr>
                        <td id="RRLine" width="100%" style="display:none;"></td>
                    </tr>
                </table>
                <!-- 결재선 정보 종료-->
                <!--의견 시작-->
                <table id="tbCommentView" border="0" cellpadding="0" cellspacing="0" align="center" width="100%">
                    <tr>
                        <td align="center" id="tdCommentView" width="100%" style="display:none;"></td>
                    </tr>
                </table>
                <!--의견 종료-->
            </div>

            <!--문서설명 시작-->
            <div id="divforminfo" style="display:none">
                <table class="table_6" summary="원문서" cellpadding="0" cellspacing="0">
                    <tr>
                        <th>문서설명</th>
                        <td id="tdforminfo"></td>
                    </tr>
                </table>
            </div>
            <!--문서설명 종료-->
            <!--######## 양식하단부분 공통 종료 #################################-->

        </div>
        <!-- bodycontext end -->
    </div>
<!-- 양식 전체 end -->
<script language="javascript" src="formedit_object.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript">

    var gRowCnt = 0;  //HIW

    

    window.onload = initOnload;
    function initOnload() {
        initialize();


		if ($('input:radio[name=OPT_Guboon]:checked').val() == undefined) {
			ChangeGuboonRdo(1);
		} else if ($('input:radio[name=OPT_Guboon]:checked').val() == "신규 생성") {
			ChangeGuboonRdo(1);
		} else if ($('input:radio[name=OPT_Guboon]:checked').val() == "내용 변경") {
			ChangeGuboonRdo(2);
		} else {
			ChangeGuboonRdo(3);
		}
			
		//SetDateField();	
        //SetComboBox();
		SetRepeatData();
    }

    function initialize() {
        if (window.parent.document.readyState == "complete") {
            window.parent.document.onreadystatechange = event_noop;
  		
            initForm();
            initApvList();
        } else {
            window.setTimeout(initialize, 500);
        }				
    }

    function initForm(){
	    initFields();
	    G_displaySpnAttInfo(false);

        /*
	    //문서이관 여부에 따른 셋팅
	    if (getInfo("scEdmsLegacy")=="1"){
	        document.getElementById("trDocInfo01").style.display="";
	       // document.getElementById("trDocInfo02").style.display="";
	    }else{
	        document.getElementById("trDocInfo01").style.display="none";
	       // document.getElementById("trDocInfo02").style.display="none";
	    }
        */
    }

    function initFields(szBody){
        setFields((!window.ActiveXObject) ? document.getElementById("dField") : dField); //editable field
        setFields((!window.ActiveXObject) ? document.getElementById("cField") : cField); //readonly field
	    setFields((!window.ActiveXObject) ? document.getElementById("mField"):mField);//form editable field

        document.getElementById("headname").innerHTML = initheadname(getInfo("fmnm"), true);
		if (getInfo("mode") == "DRAFT" || getInfo("mode") == "TEMPSAVE" ){		
			document.getElementsByName("INITIATOR_INFO")[0].value = getInfo("usdn");//getInfo("dpdn_apv")+" "+getInfo("usdn") + " "+ getInfo("ustn") ;
		    document.getElementsByName("APPLIED").value = formatDate(getInfo("svdt"),"D");
		
	    }else{
		    document.getElementsByName("SUBJECT")[0].disabled = true
    }

        //기타 필드 채우기	
        setSaveTerm(); //보존년한 create	
        setDocLevel();  // 보안등급 create

        //본문 내용
        if (getInfo("BODY_CONTEXT") != undefined) {
            setBodyContext(getInfo("BODY_CONTEXT"));
        } else {
            setBodyContext(getInfo("fmbd").replace("euc-kr","utf-8"));
        }
    }


    function getBodyContext(){   
	    //UpdateImageData(); //이미지 업로드
	    var sBodyContext = makeBodyContext();
	    return makeNode("BODY_CONTEXT",sBodyContext,null,false);
    }

    function setFields(Fields){
        if(!window.ActiveXObject){
            var szId = Fields.id;
	        var unFiltered = document.getElementsByTagName('*');
	        for (i = 0; i < unFiltered.length; i++){
	            if (unFiltered[i].getAttribute('id') == szId){
                    var fld = unFiltered[i];
		            if(fld.getAttribute("dataFld")!=null){(getInfo(fld.getAttribute("name"))!=undefined)?fld.value=getInfo(fld.getAttribute("name")):(getInfo(fld.getAttribute("dataFld"))!=undefined)?fld.value=getInfo(fld.getAttribute("dataFld")):fld.value='';}
		            if (fld.getAttribute("name") != null){
		                if(fld.getAttribute("name") == 'POSITION' && getInfo(fld.getAttribute("name")) == ""){
			                fld.value = getInfo(fld.getAttribute("dataFld"));
		                }
		            }
	            }
	        }
       }else{
	        for(var i=0;i<Fields.length;i++){
		        var fld = Fields[i];
		        if(fld.dataFld!=""){(getInfo(fld.name)!=undefined)? fld.value=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.value=getInfo(fld.dataFld):fld.value='';}
		        if(fld.name == 'POSITION' && getInfo(fld.name) == ""){
			        fld.value = getInfo(fld.dataFld);
		        }
	        }
	    }
    }

	function checkForm(bTempSave) {
		if (bTempSave) {
			return true;
		} else {//debugger;
			if (document.getElementsByName("SUBJECT")[0].value == '') {
				alert('제목을 입력하세요.');
				//SUBJECT.focus();
				return false;
			} else if (document.getElementsByName("DOC_CLASS_NAME")[0].value == '') {  //HIW
				alert('문서분류를 선택하세요.');
				return false;
			} else if ($('input:radio[name=OPT_Guboon]:checked').val() == undefined) {  //HIW
				alert('요청구분을 선택하세요.');
				return false;
			} else if ( document.getElementsByName("hdnSumTotalPrice")[0].value == ''){ 
				alert('합계를 계산하십시요.');
				return false;
			} else {

				return true;
			}
		}
	}

    //편집모드시 데이터반복부 셋팅 (HIW)
	function SetRepeatData() {

		var vRowCnt = parseInt($("input[name=hdnDataRowCnt]").val());
		//alert("vRowCnt : " + vRowCnt);
		for (var i = 1; i < vRowCnt+1; i++) {
			AddRowDataPerson();
		}
		
		
		//txtRequestDept
		
		
		//데이터 바인딩
		setBodyContext(getInfo("BODY_CONTEXT"));
	}


    function setBodyContext(sBodyContext){
	    //본문 채우기
	    var m_objXML=CreateXmlDocument();
	    var elmList, elm;
	    var elmListLan;
	
	    m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>"+getInfo("BODY_CONTEXT"));
	    try{
		    elmList = m_objXML.documentElement.childNodes;
		    for(var i=0; i < elmList.length; i++){
			    var elm = elmList[i];
			    innerHtmlData(elm.nodeName, elm.text);
		    }
		    //본문 채우기
		    //setdField();
	    }
	    catch(e){ }
    }

    //본문 XML로 구성
    function makeBodyContext(){
	    var sBodyContext="";	
	    //xml 구성 예제 : <body><item><name></name></item><item><name></name></item></body>
	    //sBodyContext="<body><item><name>첫번째</name></item><item><name>두번째</name></item></body>";

	    sBodyContext = "<BODY_CONTEXT>" + getFields(document.getElementById("mField")) + "</BODY_CONTEXT>";	
	    return sBodyContext;
    }

    /*** 폼데이터 XML문 만들기 ***/
    function getFields(Fields) {
        /*
        var sText = "";
        if(Fields!=null){
        var szId = Fields.id;
        sText+= makeCBFormXML("input", szId);
        sText+= makeCBFormXML("select", szId);
        sText+= makeCBFormXML("radio", szId);
        sText+= makeCBFormXML("textarea", szId);
        }	
        return sText;
        */
        var sText = "";
        if (Fields != null) {
            var szId = Fields.id;
            var unFiltered = document.getElementsByTagName('*');
            for (var i = 0; i < unFiltered.length; i++) {

                if (unFiltered[i].getAttribute('id') == szId) {
                    if (unFiltered[i].getAttribute("name").indexOf("SEL_") > -1) {
                        sText += getSelRadio(unFiltered[i]);
                    } else if (unFiltered[i].getAttribute("name").indexOf("OPT_") > -1) {
                        if (sText.indexOf("<" + unFiltered[i].name + ">") == -1) sText += getRadio(unFiltered[i].name);
                    } else if (unFiltered[i].getAttribute("name").indexOf("CHK_") > -1) {
                        sText += getChkRadio(unFiltered[i].name);
                    } else {
                        sText += makeNode(unFiltered[i].getAttribute("name"), unFiltered[i].value);
                    }
                }
            }
        }
        return sText;
    }	


    /** 레디오버튼 XML노드 생성 **/
    function getRadio(radioNm) {
        var radioVal = "";
        /*
        //alert("이름:"+radioNm+"\n객체여부:"+eval(radioNm)+"\n길이:"+eval(radioNm).length+"\n체크여부:"+eval(radioNm).checked);
        for(i=0;i<eval(radioNm).length;i++){				
        if(eval(radioNm)[i].checked){
        radioVal = makeNode(radioNm, eval(radioNm)[i].value);
        }
        }
        */
        radioVal = makeNode(radioNm, $("input:radio[name=" + radioNm + "]:checked").val());

        return radioVal;
    }

    /** 체크박스 XML노드 생성 **/
    function getChkRadio(chkBoxNm) {
        /*
        if(eval(radioNm).checked){
        radioVal = makeNode(radioNm, eval(radioNm).value);
        return radioVal;
        }
        */
        var chkVal = "";
        if ($("input:checkbox[name=" + chkBoxNm + "]").is(":checked"))
            chkVal = makeNode(chkBoxNm, $("input:checkbox[name=" + chkBoxNm + "]:checked").val());

        return chkVal;
    }

    /** SELECT BOX VALUE 가져오기 **/
    function getSelRadio(obj){ //selNm
	    var radioVal = "";
	    var selNm = obj.getAttribute("name");
        if ( obj.selectedIndex > -1 ){
            radioVal += makeNode(selNm, obj.options[obj.selectedIndex].value);
            radioVal += makeNode(selNm+"_TEXT", obj.options[obj.selectedIndex].text);
        }else{
            radioVal += makeNode(selNm, "");
            radioVal += makeNode(selNm+"_TEXT", "");
        }
        return   radioVal;
    }

    /*** 데이터 뿌려주기 ***/
    function innerHtmlData(nodeNm, nodeVal){
	    if (document.getElementsByName(nodeNm) != undefined) {
		    if (nodeNm.indexOf("FORM_ATTACH") != -1) {
			    setForm_Attach(nodeVal);
			    document.getElementsByName(nodeNm)[0].value = nodeVal;
		    } else if (nodeNm.indexOf("tbContentElement") != -1) {
			    var dom = tbContentElement.getDom();	dom.body.innerHTML= nodeVal.replace(/<BR>/gi,"");
		    } else if(nodeNm.indexOf("OPT") != -1) {
			    setRadio(nodeNm, nodeVal);
		    } else if(nodeNm.indexOf("CHK") != -1) {
			    setChk(nodeNm, nodeVal);
		    } else if(nodeNm.indexOf("JEONKEUL") != -1) {
			    spnJEONKEUL.innerHTML = nodeVal;
			} else {
			    if(document.getElementsByName(nodeNm)[0]!=null) document.getElementsByName(nodeNm)[0].value = nodeVal;
		    }
	    }
    }

    /*** 레디오버튼 체크선택 (수정모드시) ***/
    function setRadio(szname, szvalue) {
        /*
        var objrdo = eval(szname);
        for(i=0;i<objrdo.length;i++){	
        if(objrdo[i].value == szvalue) objrdo[i].checked = true;
        }
        */
        var objrdo = $("[name=" + szname + "]");
        for (i = 0; i < objrdo.length; i++) {
            if (objrdo[i].value == szvalue)
                objrdo[i].checked = true;
        }
    }

    /*** 체크박스 체크선택 (수정모드시) ***/
    function setChk(szname, szvalue) {
        /*
        var objrdo = eval(szname);
        if (objrdo.value == szvalue) objrdo.checked = true;
        */
        var objrdo = $("input:checkbox[name=" + szname + "]");
        if (objrdo[0].value == szvalue)
            objrdo[0].checked = true;
    }

	
        //편집모드시 날짜필드 셋팅 (HIW)
        function SetDateField() {
            for (var i = 1; i < 6; i++) {
                $("#dpApprFormDTStart" + i).val($("input[name=hdn_dpApprFormDTStart" + i + "]").val());
                $("#dpApprFormDTEnd" + i).val($("input[name=hdn_dpApprFormDTEnd" + i + "]").val());
            }

            //20171208 대체근무일 기간설정 추가 PSW
            for (var i = 1; i < 6; i++) {
                $("#dpApprFormDTSingleStart" + i).val($("input[name=hdn_dpApprFormDTSingleStart" + i + "]").val());
                $("#dpApprFormDTSingleEnd" + i).val($("input[name=hdn_dpApprFormDTSingleEnd" + i + "]").val());
                if ($("#dpApprFormDTSingleStart" + i).val() != "") {
                    //대체근무일 행 보이게
                    $("#trRepVacat" + i).css({ "display": "" });
                    $("#tdNo" + i).attr("rowSpan", 3);  //RowSpan
                }
            }
            //추가 끝
        }



        //편집모드시 콤보박스 셋팅 (HIW)
        function SetComboBox() {
            for (var i = 1; i < 6; i++) {
                $("select[name=cmbGoobun" + i + "]").val($("input[name=hdnGoobunVal" + i + "]").val());
            }
        }

        //행데이터 초기화 (2012-12-07 HIW)
        function ResetRowData(pNo) {
            $("#dpApprFormDTStart" + pNo).val("");
            $("#dpApprFormDTEnd" + pNo).val("");
            $("input[name=hdn_dpApprFormDTStart" + pNo + "]").val("");
            $("input[name=hdn_dpApprFormDTEnd" + pNo + "]").val("");
            $("input[name=txtTotDay" + pNo + "]").val("");
            $("input[name=txtApplyDay" + pNo + "]").val("");
        }

        //20171207 PSW 추가 - 대체휴가 선택 시 대체근무일 기간 설정 초기화
        function ResetRowData2(pNo) {
            $("#dpApprFormDTSingleStart" + pNo).val("");
            $("#dpApprFormDTSingleEnd" + pNo).val("");
            $("input[name=hdn_dpApprFormDTSingleStart" + pNo + "]").val("");
            $("input[name=hdn_dpApprFormDTSingleEnd" + pNo + "]").val("");
        }

        //사용자기본정보 셋팅
        var vSabun = "";
        function SetUserBasicInfo() {

            var url = "/CoviWeb/Approval/CallBack.aspx";
            var param = "CODE=60&PERSON_CODE=" + getInfo("usid") + "&LANGUAGE=" + getInfo("uslng");

            var xml = DoCallback(url, param);
            var result = xml.responseXML;

            var elmRoot = result.documentElement;
            //debugger;
            if (SelectSingleNode(elmRoot, "result") != "SUCEESS") {
                alert("[Error]\n\r\n\r" + SelectSingleNode(elmRoot, "result"));
                return;
            }
            else {//debugger;

                var vUserNm = "";
                var vJobPosition = "";
                var vUnitNm = "";

                try {
                    $(elmRoot).find("Table").each(function (i) {

                        vSabun = $(this).find("SABUN").text();
                        vUserNm = $(this).find("DISPLAY_NAME").text();
                        vJobPosition = $(this).find("JBO_POSITION").text();
                        vUnitNm = $(this).find("UNIT_NAME").text();
                    });
                    //alert(vUnitNm);
                    $("input[name=txtSabun]").val(vSabun);
                    $("input[name=txtUserName]").val(vUserNm);
                    $("input[name=txtJobPosition]").val(vJobPosition);
                    $("input[name=txtUnitName]").val(vUnitNm);

                } catch (e) {
                    alert(e.message);
                }
            }
            //CallRemainDays();

        }

		function ChangeGuboonRdo(pKind) {
            if (pKind == 1) {
                document.getElementById("first").style.display = "";
                document.getElementById("second").style.display = "none";
                document.getElementById("second1").style.display = "none";
                document.getElementById("tblDataRowPerson").style.display = "none";
                document.getElementById("tblDataRowPrice").style.display = "none";

                document.getElementById("third").style.display = "";
                document.getElementById("third1").style.display = "";
                document.getElementById("third2").style.display = "none";
                document.getElementById("third3").style.display = "none";



            } else if (pKind == 2) {
                document.getElementById("first").style.display = "";
                document.getElementById("second").style.display = "none";
                document.getElementById("second1").style.display = "none";
                document.getElementById("tblDataRowPerson").style.display = "none";
                document.getElementById("tblDataRowPrice").style.display = "none";
                document.getElementById("third").style.display = "";
                document.getElementById("third1").style.display = "";
                document.getElementById("third2").style.display = "none";
                document.getElementById("third3").style.display = "none";

            } else if (pKind == 3) {
                document.getElementById("first").style.display = "none";
                document.getElementById("second").style.display = "";
                document.getElementById("second1").style.display = "";
                document.getElementById("tblDataRowPerson").style.display = "";
                document.getElementById("tblDataRowPrice").style.display = "";
                document.getElementById("third2").style.display = "";
                document.getElementById("third3").style.display = "";
                document.getElementById("third").style.display = "none";
                document.getElementById("third1").style.display = "none";

                //AddRowDataPerson();

            } else {

            }
        }
		
		 function inNumber() {
            if (event.keyCode < 48 || event.keyCode > 57) {
                event.returnValue = false;
            }
        }


        //신청부서 출장자 행추가
        function AddRowDataPerson() {
            //debugger;
            if (gRowCnt > 29) {
                alert("30개 항목까지만 추가할 수 있습니다");
                return;
            }

            gRowCnt++;

            var vRowStr = "";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:25px; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + gRowCnt + "</td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><select id = 'mField' name = 'txtClass_" + gRowCnt + "' style = 'height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' ><option value='0'>선택하세요</option ><option value='토지'>토지</option><option value='건물'>건물</option><option value='구축물'>구축물</option><option value='기계장치'>기계장치</option><option value='저장조'>저장조</option><option value='차량운반구'>차량운반구</option><option value='기타의 유형자산'>기타의 유형자산</option><option value='기타의 무형자산'>기타의 무형자산</option><option value='무형자산(회원권등)'>무형자산(회원권등)</option><option value='공통'>공통</option><option value='G/L계정'>G/L계정</option><option value='기타'>기타</option></select></td>";
            //< input type = 'text' id = 'mField' name = 'txtClass_" + gRowCnt + "' style = 'height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' />-->
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtGubun_" + gRowCnt + "'  style='height:20px;width:60%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' />&nbsp;</td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtMaster_" + gRowCnt + "'  style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtProduct_" + gRowCnt + "'  style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtPrice_" + gRowCnt + "' onKeyPress='return numkeyCheck(event);' onblur='this.value=numberFormat(this.value);' style='height:20px;width:90%; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px'  /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtEndBigo_" + gRowCnt + "'  style='height:20px;width:90%; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px'  /></td>";
            vRowStr += "</tr>";


            $("#tblDataRowPerson").append(vRowStr);


            $("input[name=hdnDataRowCnt]").val(gRowCnt);

        }

        //신청부서 출장자 행삭제
        function DelRowDataPerson() {

            var vRowCnt = $("#tblDataRowPerson tr").length;

            if (vRowCnt > 2) {
                $("#tblDataRowPerson tr").each(function (i) {

                    if (i == vRowCnt - 1) {
                        $(this).remove();
                    }
                });

                gRowCnt--;
                $("input[name=hdnDataRowCnt]").val(gRowCnt);


            }
        }

        //입력값 숫자체크 함수 psw
        function numkeyCheck(e) {
            //alert("numkeycheck");
            var keyValue = event.keyCode;
            if (((keyValue >= 48) && (keyValue <= 57))) {
                return true;
            } else {
                alert("숫자를 입력하세요");
                return false;

            }


        }

        //세자리마다 콤마찍기 함수 psw
        function numberFormat(num) {

            var pattern = /(-?[0-9]+)([0-9]{3})/;
            while (pattern.test(num)) {
                num = num.replace(pattern, "$1,$2");
            }
            return num;
        }


        //합계 계산하기 psw
        function goSum() {
            var sumTotal = 0;
            for (var c = 1; c < gRowCnt + 1; c++) {
                if ($("input[name=txtPrice_" + c + "]").val() == "") {
                    $("input[name=txtPrice_" + c + "]").val(0); 
                }
                var total = $("input[name=txtPrice_" + c + "]").val();
                var totalValue = parseInt(total.replace(/,/g, "")); 
                sumTotal += totalValue;
            }
            $("input[name=hdnSumTotalPrice]").val(sumTotal);
            $("input[name=hdnSumTotalPrice]").innerHTML = sumTotal;
            $("input[name=hdnSumTotalPrice]").focus();
        }

</script>
</body>
</html>
