<!--
2013.07.09 hblee 결재완료 시 특정 필드 숨김
검색 단어 : 
if( getInfo("mode") != "COMPLETE" || getInfo("usid") == "gwadmin" || getInfo("usid") == "hblee" )
-->
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma" content="no-cache"/>		
	<link rel="stylesheet" href="/GWImages/common/css/css_style.css" type="text/css" />
	<title></title>
    <!--필수 양식파일에 쓰이는 js 파일-->
	<script language="javascript" type="text/javascript" src="/CoviWeb/SiteReference/js/Config.js"></script>
    <script language="javascript" type="text/javascript" src="/CoviWeb/SiteReference/js/EmbedObject.js"></script>
    <script language="javascript" type="text/javascript" src="/CoviWeb/SiteReference/js/Utility.js"></script>
    <script language="javascript" type="text/javascript" src="../../Common/script/COVIFlowNet/openWindow.js"></script>		
	<script language="javascript" type="text/javascript" src="formedit.js" ></script>
	<script language="javascript" type="text/javascript" src="../../Common/script/progress.js"></script>
	<script language="javascript" type="text/javascript" src="../../common/script/NameControl.js"></script>
	<!-- 안드로이드 계열 mobile 기기에서 결재문서 원문보기 시 결재선 표시가 안됨 -->
	<!--<script type="text/javascript" language="javascript" src="../../common/script/jquery-1.3.2.min.js"></script>-->
	<script type="text/javascript" language="javascript" src="../Common/jQuery/jquery-1.9.1.min.js"></script>
	<!-- 달력 선택 참조  -->
	<link type="text/css" rel="stylesheet" href="/CoviWeb/SiteReference/calendar/datepickercontrol.css" />
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/calendar/datepickercontrol.js"></script>
    <style type="text/css">
            td
            {
                font-size:11px;
            }
    </style>
    </head>
<body topmargin=0 leftmargin=0 scroll="yes">
	<!-- COMMON FIELDS -->
	<input type="hidden" id="dField" name="INITIATOR_INFO" dataFld="usinfo">
	<input type="hidden" id="dField" name="INITIATOR_ID" dataFld="usid">
	<input type="hidden" id="dField" name="INITIATOR_OU_ID" dataFld="dpid_apv">
	<input type="hidden" id="dField" name="INITIATOR_NAME" dataFld="usdn">
	<input type="hidden" id="dField" name="INITIATOR_OU_NAME" dataFld="dpdn_apv">
	<!--<input type="hidden" id="dField" name="APV_NO" dataFld="apv_no">-->
	
	<input type="hidden" id="cField" name="LAST_MODIFIER_ID"> 
	<input type="hidden" id="cField" name="attach">
	<input type="hidden" id="cField" name="filelocation" dataFld="fmfl">
	<input type="hidden" id="cField" name="ATTACH_FILE" >
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO" dataFld="ATTACH_FILE_INFO">
	<input type="hidden" id="dField" name="SUBJECT" dataFld="SUBJECT">
	
	<input type="hidden" id="cField" name="attach3">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO3" dataFld="ATTACH_FILE_INFO3">
	<input type="hidden" id="cField" name="attach4">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO4" dataFld="ATTACH_FILE_INFO4">
	<input type="hidden" id="cField" name="attach5">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO5" dataFld="ATTACH_FILE_INFO5">
	<input type="hidden" id="cField" name="attach6">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO6" dataFld="ATTACH_FILE_INFO6">
	<input type="hidden" id="cField" name="attach7">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO7" dataFld="ATTACH_FILE_INFO7">
	<input type="hidden" id="cField" name="attach8">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO8" dataFld="ATTACH_FILE_INFO8">
	<input type="hidden" id="cField" name="attach9">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO9" dataFld="ATTACH_FILE_INFO9">
	<input type="hidden" id="cField" name="attach10">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO10" dataFld="ATTACH_FILE_INFO10">
	<input type="hidden" id="cField" name="attach11">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO11" dataFld="ATTACH_FILE_INFO11">
	<input type="hidden" id="cField" name="attach12">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO12" dataFld="ATTACH_FILE_INFO12">
	<input type="hidden" id="cField" name="attach13">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO13" dataFld="ATTACH_FILE_INFO13">
	<input type="hidden" id="cField" name="attach14">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO14" dataFld="ATTACH_FILE_INFO14">
	<input type="hidden" id="cField" name="attach15">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO15" dataFld="ATTACH_FILE_INFO15">
	<input type="hidden" id="cField" name="attach16">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO16" dataFld="ATTACH_FILE_INFO16">
	<input type="hidden" id="cField" name="attach17">
	<input type="hidden" id="dField" name="ATTACH_FILE_INFO17" dataFld="ATTACH_FILE_INFO17">
	
	<input type="hidden" id="dField" name="REAL_DATE" dataFld="REAL_DATE">
	<input type="hidden" id="dField" name="REDRAFT_DATE" dataFld="REDRAFT_DATE">
	<input type="hidden" id="dField" name="EBH_DATE" dataFld="EBH_DATE">
	
	<textarea id="dhtml_body" style="DISPLAY:none" NAME="dhtml_body"></textarea>
	<textarea style="DISPLAY:none" id="cField" name="xsl"></textarea> 
	<input type="hidden" id="cField" name="BODY_CONTEXT">
	<input type="hidden" id="mField" name="nmName">
	<input type="hidden" id="mField" name="qmName">
	<input type="hidden" id="mField" name="nmSvdate">
	<input type="hidden" id="mField" name="FileLinkInfo">
	<input type="hidden" id="AttFileInfo5" />
    <input type="hidden" id="AttFileInfo6" />
    <input type="hidden" id="AttFileInfo7" />
    <input type="hidden" id="AttFileInfo11" />
    <input type="hidden" id="AttFileInfo12" />
	<!-- 2008.01 발신부서 결재라인 추가 -->
	<input type="hidden" id="mField" name="PreApvLineInfo">
	<input type="hidden" name="Address" id="Address">
	<!-- END -->
	<!-- 양식추가정보 -->
	<input type="hidden" id="dField" name="RECEIVE_NO" dataFld="RECEIVE_NO">
	<!-- END -->
	<input type="hidden" name="NIGHTS">
		<!-- 문서link 2006.12 -->
		<textarea id="cField" name="DOCLINKS" style="DISPLAY:none"></textarea>
	<!-- 양식전체본문 -->
	<div id="bodytable">
		<!-- header start -->
		<table id="headtable" border="0" cellpadding="3" cellspacing="0" style="border-collapse: collapse;" align="center" width="90%">	
	        <tr>
		        <td nowrap="t" height="46" width="100%" align="center" >
			        <table border="0" bordercolor="#111111" style="border-collapse: collapse;MARGIN-TOP: 0px; width:100%;height:100%;" >
				        <tr>
					        <td align="center" id="headname" class="Approval_headname"></td>
				        </tr>
			        </table>
			        <table style="height:30px;"><tr><td></td></tr></table>
		        </td>
	        </tr>
	        <tr>
		        <td id="ApvLine">
			        <table border="0" style="border-collapse: collapse;MARGIN-TOP: 0px; width:100%;height:100%;" align="center">							
				        <!-- 발신처 결재란 보이는 부분(왼쪽) -->
				        <tr>
					        <td id="LApvLine" align="left" width="50%">
					        </td>
					        <!-- 수신처 결재란 보이는부분 (오른쪽)-->
					        <td id="RApvLine" align="right" width="50%">
					        </td>
				        </tr>
				        <tr>
					        <td colspan="2" height="10">&nbsp;</td>
				        </tr>
				        <tr>
					        <td id="CmtLineList" width="100%" colspan = "2">
					        </td>
				        </tr>
				        <tr>
					        <td colspan="2" height="10">&nbsp;</td>
				        </tr>
				        <tr>
					        <td id="AssistLine" width="100%" colspan = "2">
					        </td>
				        </tr>				        
			        </table>
		        </td>
	        </tr>
	        <tr>
		        <td height="20">&nbsp;</td>
	        </tr>
        </table>
		<!-- header end -->
		<!-- bodycontext start -->
		<table id="bodycontext" style="MARGIN-TOP: 0px;WIDTH: 740px;BORDER-COLLAPSE: collapse; padding-left:20px;" align="center" cellpadding="0" cellspacing="0">
			  <tr style="padding-left:20px;">
				<td>
					<table border="0" width="100%">
						<tr>
							<td width="33%" align="left">1. 거래처 현황</td>
							<td width="33%" align="center"><u><span id="Gian"></span></u></td>
							<td width="33%" align="right"><u><span id="Wday"></span></u></td>
						</tr>
					</table>
				</td>
			</tr>
			
			<tr>
			<td>
				<table border="1" width="100%" height="100%" style="MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse"   bordercolor="#111111">
					<tr align="center" height="24px;">
						<td width="9%" bgColor="#f2f2f2">담당MD명</td>
						<TD width="11%"><span id="MD_Manager"></span></TD>
						<TD width="10%" bgColor="#f2f2f2">상선위시<br />방송예정일</td>
						<td width="11%" colspan="2">
						    <span type="text" id="nmFDATE"></span>
						</td>
						<TD width="12%" bgColor="#f2f2f2">방송예정일</td>
						<td width="11%">
						    <span type="text" id="nmWDATE"></span>
						</td>
						<td width="7%" bgColor="#f2f2f2">방송 시간</td>
						<td width="8%" >
						    <span id ="nmtime1"></span>시
						    <span id="textTime"></span>분
					   </td>
						<TD width="7%" bgColor="#f2f2f2">담당QM명</TD>
						<TD width="14%"><span id="QM_Manager"></span></TD>
					</TR>
					<tr align="center" height="24px;">
						<TD bgColor="#f2f2f2">협력사명</TD>
						<TD ><span id="Companyname"></span></TD>
						<TD bgColor="#f2f2f2">협력사코드</TD>
						<TD colspan="2" ><span id="Companycode"></span></TD>
						<TD bgColor="#f2f2f2"><a target="go_ksrm" onclick="OpenKSRM();" style="cursor:hand;color:blue">사업자등록번호</a></TD>
						<TD colspan="5" ><span id="Licensenum"></span></TD>
					</TR>
					<tr align="center" height="24px;">
						<TD bgColor="#f2f2f2">주&nbsp;&nbsp;소</TD>
						<TD colspan="4"><span id="nmAddress"></span></TD>
						<TD bgColor="#f2f2f2">대표자성명</TD>
						<TD colspan="5"><span id="Ceo"></span></TD>
					</TR>
				</table>
				<table border="1" width="100%" height="100%" style="MARGIN-TOP: -1px;BORDER-COLLAPSE: collapse"   bordercolor="#111111">
					<tr align="center" height="24px;">
						<TD width="9%" bgColor="#f2f2f2">담보내역</TD>
						<TD width="11%"><span id="nmWarrant"></span></TD>
						<TD width="10%" bgColor="#f2f2f2">신상품여부</TD>
						<TD width="11%" colspan="2"><span id="nmNewGoods"></span></TD>
						<TD width="12%" bgColor="#f2f2f2">제조사<BR>(벤더사 표기 포함)</TD>
						<TD width="11%"><span id="nmManuCompany"></span></TD>
						<TD width="15%" bgColor="#f2f2f2">원산지</TD>
						<TD width="21%" colspan ="2" style="text-align:center;"><span id="nmOriginPlace"></span></TD>
					</TR>
					<tr align="center" height="24px;">
						<TD bgColor="#f2f2f2">협력사유형</TD>
						<TD ><span id="nmEntType"></span></TD>
						<TD ><span id="nmEntAlphabet"></span></TD>
						<TD colspan="2" ><span id="nmEntSize"></span></TD>
						<TD bgColor="#f2f2f2">NS신용등급표기</TD>
						<TD ><span id="nmNS"></span></TD>
						<TD colspan="2" bgColor="#f2f2f2">부가세여부</TD>
						<TD ><span id="nmTax"></span></TD>
			        </tr>				
				</table>
			</td>
			</tr>
			
			<tr height="20"><td>&nbsp;</td></tr>
			<tr>
				<td align="left">
				<table width="100%" ID="Table7">
					<tr>
						<td width="50%">2. 공급상품내역</td>
						<td width="50%" align="right">(금액단위:원)</td>
					</tr>
				</table>
				</td>
			</tr>
			<tr >
				<td valign="top">
					<div id="tblList_REQ"></div>
				</td>
				
			</tr>
			<tr height="20"><td>&nbsp;</td></tr>
			<tr id="trCondition1">
				<td align="left">
				<table width="100%">
					<tr>
					    
						<td width="27%" id="tdTxtChg0">※ 상선위조건 및 상선위대비 변경사항</td>
						<td width="20%"><span id="nmCondition"></span></td>
						<td width="13%">※ 거래조건 </td>
					</tr>
				</table>
				</td>
			</tr>
			<tr id="trCondition2">
				<td valign="top">
					<div id="tblList_OLD"></div>
				</td>
			</tr>
			<tr height="20" id="trCondition3"><td>&nbsp;</td></tr>
			<tr style="padding-left:20px;" id="trCondition4">
				<td align="left">
				    <table width="740px;">
					    <tr>
						    <td width="50%">3. 예상실적</td>
						    <td width="47%" align="right">(금액단위:원)</td>
						    <input type="hidden" id="confirm_key" value="YES" />
					    </tr>
				    </table>
				</td>
			</tr>
			<tr align="center" id="trCondition5">
			    <td valign="top">
					<div id="tblList_EXP"></div>
				</td>
			</tr>
			<tr height="30"><td>&nbsp;</td></tr>
			<tr>
				<td valign="top">
					<div id="tblList_EX1"></div>
				</td>
			</tr>
			
			<tr height="20"><td>&nbsp;</td></tr>
			<tr>
				<td align="left">
				<table width="100%">
					<tr>
						
					</tr>
				</table>
				</td>
			</tr>
			<tr>
				<td valign="top">
					<div id="tblList_EX2"></div>
				</td>
			</tr>

			<tr height="20"><td>&nbsp;</td></tr>
			<tr>
				<td align="left">
				<table width="100%">
					<tr>
						
					</tr>
				</table>
				</td>
			</tr>
			<tr>
				<td valign="top">
					<div id="tblList_CHG"></div>
				</td>
			</tr>
			
			<tr height="20"><td>&nbsp;</td></tr>
			<tr>
				<td align="left">
				<table width="100%" ID="Table6">
					<tr>
						<td width="36%">4. 신용평가 등급에 따른 구비서류</td>
						<td width="64%">(<span id="nmTrust"></span>)</td>
					</tr>
				</table>
				</td>
			</tr>
			<tr>
				<td>
					<table border="1" width="100%" height="100%" style="MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse" bordercolor="#111111">
						<tr>
							<td width="18%" align="center" bgColor='#f2f2f2'>서류명</td>
							<td width="15%" align="center" bgColor='#f2f2f2'>확인</td>
							<td width="18%" align="center" bgColor='#f2f2f2'>서류명</td>
							<td width="15%" align="center" bgColor='#f2f2f2'>확인</td>
							<td width="18%" align="center" bgColor='#f2f2f2'>서류명</td>
							<td width="15%" align="center" bgColor='#f2f2f2'>확인</td>
						</tr>
						<tr>
							<td bgColor='#f2f2f2'><a href="javascript:void(0)" onclick="OpenTransact();return false;">1.전자거래기본계약서</a></td>
							<td ><span id="txtTransact"></td>
							<td bgColor='#f2f2f2'>4.협력사간 거래계약서사본 수입신고필증 외</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table14">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo4"></span></nobr></td>
									</tr>
								</table>
							</td>
							<td bgColor='#f2f2f2'>6.이행(지급)보증보험증권</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table10">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo9"></span></nobr></td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td bgColor='#f2f2f2'><a href="javascript:void(0)" onclick="OpenProduct();return false;">2.상품공급신청서</a></td>
							<td ><span id="txtProduct"></td>
							<td bgColor='#f2f2f2'>5.결제계좌사본</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table15">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo8"></span></nobr></td>
									</tr>
								</table>
							</td>
							<td  id="td10" bgColor='#f2f2f2'>7.연대보증 계약서(대표자 외)</td>
							<td >
								<table id="td10_1" width="100%" style="table-layout:fixed">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo10"></span></nobr></td>
									</tr>
								</table>&nbsp;
							</td>
						</tr>
						<tr>
							<td bgColor='#f2f2f2'>3.상품개발기획서</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table12">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo3"></span></nobr></td>
									</tr>
								</table>
							</td>
							<td bgColor='#f2f2f2'>*종전실적</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table17">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo14"></span></nobr></td>
									</tr>
								</table>
							</td>
							<td bgColor='#f2f2f2'>*기타서류</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table18">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo15"></span></nobr></td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td bgColor='#f2f2f2'>*원가내역서</td>
							<td >
								<table width="100%" style="table-layout:fixed" ID="Table16">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo13"></span></nobr></td>
									</tr>
								</table>
							</td>
							<td bgColor='#f2f2f2'>사업자등록증사본</td>
							<td >
								<table width="100%" style="table-layout:fixed">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo16"></span></nobr></td>
									</tr>
								</table>
							</td>
							<td bgColor='#f2f2f2'>법인등기부등본</td>
							<td >
								<table width="100%" style="table-layout:fixed">
									<tr>
										<td  width="75%"><nobr><span id="AttFileInfo17"></span></nobr></td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>		
			<tr>
				<td>&nbsp;</td>
			</tr>
			<tr>	
				<!--2012.04.05	이해봉	법인명수정-->
				<!--td class="aligncenter"><b>(주)농수산홈쇼핑</b></td-->
				<td class="aligncenter"><b>(주)엔에스쇼핑</b></td>
			</tr>
			
		</table>
		
		<table border="0" style="MARGIN-TOP: 0px;WIDTH: 740px;BORDER-COLLAPSE: collapse" align="center">								
			<tr>
				<td height="10"></td>
			</tr>
		</table> 
		<!--read_의견입력-->
        <table border="0" cellpadding="0" cellspacing="0" align="center" width="740" id ="tbCommentView">
            <tr>
                <td align="center" id="tdCommentView"  width="100%" style="display:none;">				
            </td>
            </tr>
        </table>
        <!--read_의견입력끝 -->
	<!-- bodycontext end -->
	</div>							
	<!-- 양식 전체 end -->
	<p></p>
	<p></p>
	<table border="0" cellpadding="0" cellspacing="0" align="center" width="90%">
		<tr>
			<td align="center">
				<div id="DivAtt" name="DivAtt" >
			    <!-- 연결문서 수정 2006.12 -->
			    <table border="0" cellpadding="0" cellspacing="0" align="center" width="740"><tr><td height="2"></td></tr></table>
	            <table cellpadding="2" cellspacing="0" bgcolor="#FFFFFF" border="1" bgcolor="#FFFFFF" border="2"  bordercolor="#111111" style="border-collapse: collapse;" align="center" width="100%" height="75">
                    <tr height="25">
                        <td width="15%" height="25" align="center" valign="middle" bgcolor="#F2F2F2">참&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;조</td> 
	                    <td width="85%" id="CCLine" class="Approval_common">
	                        <div id="SendCC"></div>
	                        <div id="RecCC"></div>
	                    </td>
                    </tr>
                    <tr height="25" style="display:none;">
	                    <td width="15%" align="center" valign="middle" bgcolor="#F2F2F2">연결파일</td>
	                    <td width="85%" id="FileLink" class="Approval_common"></td>
                    </tr>
                    <tr height="25">
	                    <td width="15%" align="center" valign="middle" bgcolor="#F2F2F2">첨부파일</td>
	                    <td width="85%" id="AttFileInfo" class="Approval_common"></td>
                    </tr>
                    <tr height="25">
	                    <td width="15%" height="24" align="center" valign="middle" bgcolor="#F2F2F2">연결문서</td>
	                    <td width="85%" id="DocLinkInfo" class="Approval_common"></td>
                    </tr>
	            </table>
				</div>
			</td>
		</tr>	
	</table>	
							
	<input type="hidden" name="write" value="write" ID="Hidden15">
	<div id='divErrorMessage' class='errormessage'></div>
	<div id='FMBDBODY' style="display:none;">
	<form name='Form1' ID="Form1" METHOD='POST'>
	<input type='hidden' name='fmbd' ID="fmbd">
	</form>
	</div>		

<script language="javascript" type="text/javascript">
var m_xmlHTTP = CreateXmlHttpRequest();	  //new ActiveXObject("Msxml2.XMLHTTP");
var m_evalXML = CreateXmlDocument();    //new ActiveXObject("Msxml2.DOMDocument");
var m_addField, m_index;

var refreshinterval=2; // 리프레쉬 시킬 시간 간격을 지정 하세요 (초)
var starttime;
var nowtime;
var reloadseconds=0;
var secondssinceloaded=0;



window.onload = initOnload;
function initOnload() { 
initialize();
}

function OpenResult(){
	
		var fmid= getInfo("fmid");
		var fmnm= getInfo("fmnm");
		var fmpf= getInfo("fmpf");
		var scid= getInfo("scid");
		var fmrv= getInfo("fmrv");
		var fmfn= getInfo("fmfn");
		var fmbd = getInfo("BODY_CONTEXT");
		
		document.all.fmbd.value = fmbd;
		var strURL = "../forms/form.aspx?blegacy=1&fmid=" + fmid + "&fmnm=" + escape(fmnm)
			+ "&fmpf="+fmpf+"&scid="+scid
			+ "&mode=DRAFT&fmrv="+fmrv+"&fmfn="+fmfn+"&olocation=target";
			
		var width = 800;
		var height = window.screen.height - 65;
		openWindow('',"FormAC",width,height,'resize');
		document.Form1.target = 'FormAC';
		document.Form1.action = strURL;
		document.Form1.submit();
		//parent.close()
		
	}

function initialize(){	

	if(window.parent.document.readyState == "complete"){
		window.parent.document.onreadystatechange = event_noop;		
		initForm();
		initApvList();		
	}else{
		window.setTimeout(initialize,500);
	}
}
function initForm() {
	//거래변경품의서 수정 시작 2007.03
	//2차 결재일 경우 내부 품의만 존재한다. 스키마 강제 변경
	try{
		//if (APV_NO.value == "1" || getInfo("APV_NO") == "1"){
		//	parent.menu.setInfo('scChgrOU','0');parent.menu.setInfo('scChgrOUV','');parent.menu.setInfo('scCHBisV','');	
		//}
	}catch(e){}
	//거래변경품의서 수정 끝 2007.03
	
	initFields();
	G_displaySpnAttInfo(false);
	G_displaySpnAttInfo_EBH(false);
	
	//2014.09.15 추가 시작
	if(getInfo("mode") == "COMPLETE" && getInfo("loct") == "COMPLETE") {
	    getFinishDate();
	    if(sFinishdate != ""){
    	    if(sFinishdate <= "2014-09-12") {
    	        document.getElementById("AttFileInfo6").style.display = "none";
    	        document.getElementById("AttFileInfo7").style.display = "none";
    	        document.getElementById("AttFileInfo11").style.display = "none";
    	        document.getElementById("AttFileInfo12").style.display = "none";
    	    } 
	    }
	}
	//2014.09.15 추가 종료
}

function initFields() {
    setFields((window.addEventListener) ? document.getElementById("dField") : dField); //editable field
	setBodyContext();
 
//	if ((sMode == "COMPLETE") && (APV_NO.value!="1") && (getInfo("dpid")==getInfo("scChgrOUV").split("@")[0])){
//			// pop.style.display="";
//			// parent.menu.btReqAdd1.style.display=""; // 2차품의 비활성화 : 2008/01/30 윤승용[wingman@nseshop.com]
//	}else{pop.style.display="none";}
	
    document.getElementById("headname").innerHTML = getInfo("fmnm");
	
    if(getInfo("mode")=="DRAFT"|| getInfo("mode")=="TEMPSAVE")
		{
			document.getElementsByName("INITIATOR_NAME")[0].value = m_oFormMenu.getLngLabel(getInfo("usdn"));
			document.getElementsByName("INITIATOR_OU_NAME")[0].value = m_oFormMenu.getLngLabel(getInfo("dpdn_apv"),false);	
			INITIATOR_INFO.value=INITIATOR_OU_NAME.value+"&nbsp;&nbsp;&nbsp;"+INITIATOR_NAME.value+"&nbsp;&nbsp;&nbsp;"+getInfo("uspn");
			document.getElementById("Gian").innerHTML = document.getElementsByName("INITIATOR_INFO")[0].value; //기안자 출력
			document.getElementById("Wday").innerHTML = "작성일 : "+ formatDate(getInfo("svdt"),"R");
			document.getElementsByName("nmSvdate")[0].value = formatDate(getInfo("svdt"),"R");
		}else{
		    document.getElementById("Gian").innerHTML = document.getElementsByName("INITIATOR_INFO")[0].value; //기안자 출력					
		    document.getElementById("Wday").innerHTML = "작성일 : " + formatDate(getInfo("INITIATED_DATE"),"R"); 
		}
 
//	setBodyContext();
	if(document.getElementsByName("FileLinkInfo")[0].value!=""){document.getElementById("FileLink").innerHTML = document.getElementsByName("FileLinkInfo")[0].value;}
//	
}
 

//BODY_CONTEXT로 구성될 cField, mField 정보를 읽어옴.
function getBodyContext(){
	szBodyContext = '';
	//alert("szBodyContext:"+szBodyContext);
	return szBodyContext;
}
//인쇄를 위한 BODY_CONTEXT로 구성될 cField, mField 정보를 읽어옴
function getPrintBodyContext(){
	var szPrintBodyContext='';	
	szPrintBodyContext = getCFields(cField)+ getMFields(mField);	
	return szPrintBodyContext;	
}

function setFields(Fields){
    //	for(var i=0;i<Fields.length;i++){
    //		var fld = Fields[i];
 
    //		if(fld.dataFld!="" ){(getInfo(fld.name)!=undefined)? fld.value=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.value=getInfo(fld.dataFld):fld.value='';}
    //        /*
    //		if(fld.name == "SAVE_TERM"){fld.value = getSaveTerm(getInfo("SAVE_TERM"));}
    //		if(fld.name == "DOC_LEVEL"){fld.value = getDocLevel(getInfo("DOC_LEVEL"));}
    //		*/
    //	}
    if (window.addEventListener) {
        var szId = Fields.id;
        var unFiltered = document.getElementsByTagName('*');
        for (i = 0; i < unFiltered.length; i++) {
            if (unFiltered[i].getAttribute('id') == szId) {
                var fld = unFiltered[i];
                if (fld.getAttribute("dataFld") != null) { (getInfo(fld.getAttribute("name")) != undefined) ? fld.value = getInfo(fld.getAttribute("name")) : (getInfo(fld.getAttribute("dataFld")) != undefined) ? fld.value = getInfo(fld.getAttribute("dataFld")) : fld.value = ''; }
                if (fld.getAttribute("name") != null) {
                    if (fld.getAttribute("name") == 'POSITION' && getInfo(fld.getAttribute("name")) == "") {
                        fld.value = getInfo(fld.getAttribute("dataFld"));
                    }
                }
            }
        }
    } else {
        for (var i = 0; i < Fields.length; i++) {
            var fld = Fields[i];
 
            if (fld.dataFld != "") { (getInfo(fld.name) != undefined) ? fld.value = getInfo(fld.name) : (getInfo(fld.dataFld) != undefined) ? fld.value = getInfo(fld.dataFld) : fld.value = ''; }
            /*
            if(fld.name == "SAVE_TERM"){fld.value = getSaveTerm(getInfo("SAVE_TERM"));}
            if(fld.name == "DOC_LEVEL"){fld.value = getDocLevel(getInfo("DOC_LEVEL"));}
            */
        }
    }
}



// 문서가 로드될떄 호출되어 값을 불러와서 본문에 채워줌
function setBodyContext(){			
	
	var xmlschema = CreateXmlDocument(); //new ActiveXObject("MSXML2.DOMDocument");
	xmlschema.loadXML(getInfo("BODY_CONTEXT"));					   	
	var oindex=0;  
	var oindex1=0;
	var oindex2=0;     	
    var oNodeList= xmlschema.documentElement.childNodes;        	
	var elmRoot, elmList1, elmList2,elmList2_1, elmList3, elmList4, elmList5, elmList6, elm;
  
	elmRoot = xmlschema.documentElement;
	elmList1 = elmRoot.selectNodes("OPERATIONINFO/ITEM");
    
	
	if(getInfo("mode") == "COMPLETE")
	{
	   tdlHTML ="";
	   tdlHTML +="<table border='1' width='100%' height='100%' style='MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse' id='REQ' bordercolor='#111111'>";
	   tdlHTML +="<tr>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='13%' bgColor='#f2f2f2'>상품명</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='7%' bgColor='#f2f2f2'>광고특약<br>유형</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='8%' bgColor='#f2f2f2'>방송시간<br>가중치</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='8%' bgColor='#f2f2f2'>상품<br>코드</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='8%'  bgColor='#f2f2f2'>원가<br>(VAT포함)</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='8%' bgColor='#f2f2f2'>판매가<br>(VAT포함)</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='8%' bgColor='#f2f2f2'>상품<br>매출비율</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='8%' bgColor='#f2f2f2'>분당<br>광고특약수수료</td>";
       tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='6%' bgColor='#f2f2f2'>무이자<br />개월수</td>";
	   tdlHTML +="<td align='center' colspan='2' class='condition' width='14%' bgColor='#f2f2f2'>ARS</td>";
	   tdlHTML +="</tr>";
	   tdlHTML +="<tr>";
	   tdlHTML +="<td align='center' class='condition' width='7%' bgColor='#f2f2f2'>협력사</td>";
	   tdlHTML +="<td align='center' class='condition' width='7%' bgColor='#f2f2f2'>NS</td>";
	   tdlHTML +="</tr>";
	}
	else
	{
	   tdlHTML ="";
	   tdlHTML +="<table border='1' width='100%' height='100%' style='MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse' id='REQ' bordercolor='#111111'>";
	   tdlHTML +="<tr>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='13%' bgColor='#f2f2f2'>상품명</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='7%' bgColor='#f2f2f2'>광고특약<br>유형</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='8%' bgColor='#f2f2f2'>방송시간<br>가중치</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='8%' bgColor='#f2f2f2'>상품<br>코드</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='8%'  bgColor='#f2f2f2'>원가<br>(VAT포함)</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='8%' bgColor='#f2f2f2'>판매가<br>(VAT포함)</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='8%' bgColor='#f2f2f2'>상품<br>매출비율</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='8%' bgColor='#f2f2f2'>분당<br>광고특약수수료</td>";
	   tdlHTML +="<td align='center' rowspan='2' width='12%' bgColor='#ffff00'>분당 예상공헌이익액<br>(예상공헌이익율)</td>";
	   tdlHTML +="<td align='center' rowspan='2' class='condition_title' width='6%' bgColor='#f2f2f2'>무이자<br />개월수</td>";
	   tdlHTML +="<td align='center' colspan='2' class='condition' width='14%' bgColor='#f2f2f2'>ARS</td>";
	   tdlHTML +="</tr>";
	   tdlHTML +="<tr>";
	   tdlHTML +="<td align='center' class='condition' width='7%' bgColor='#f2f2f2'>협력사</td>";
	   tdlHTML +="<td align='center' class='condition' width='7%' bgColor='#f2f2f2'>NS</td>";
	   tdlHTML +="</tr>";
	}
	
	for(var i=0;i<elmList1.length;i++)
	{
		var Winchk="";
		elm = elmList1.nextNode();
		if (elm.selectSingleNode("nmREQ_Pname").text != "")
		{ 
	        if(getInfo("mode") == "COMPLETE")
	        {
                 tdlHTML += "<tr>";
                 tdlHTML += "<td class='condition3' align='center'>"+elm.selectSingleNode("nmREQ_Pname").text+"</td>";
                 if(elm.selectSingleNode("nmREQ_Win").text == "1" ) 
                 { 
                   Winchk = "<b>V</b>";
                 }
                 else
                 {
                   Winchk= elm.selectSingleNode("nmREQ_Win").text;
                 }  
                tdlHTML += "<td class='condition1' align='center'>"+Winchk+"</td>";
                tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_TimeText").text+"</td>";
                tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_Pcode").text+"</td>";
                tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_Cost").text+"</td>"
                tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_SPrice").text+"</td>";
                tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_SaleRatio").text+"</td>";
                tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_TPrice").text+"</td>";
                tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_InterMon").text+"</td>";
                tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_ARS_C").text+"</td>";
                tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_ARS_W").text+"</td>";
                tdlHTML += "</tr>";
			}
			else
			{
		        tdlHTML += "<tr>";
		        tdlHTML += "<td class='condition3' align='center'>"+elm.selectSingleNode("nmREQ_Pname").text+"</td>";
		        if(elm.selectSingleNode("nmREQ_Win").text == "1" ) 
		        { 
			       Winchk = "<b>V</b>";
		        }
		        else
		        {
		           Winchk= elm.selectSingleNode("nmREQ_Win").text;
		        }
		        tdlHTML += "<td class='condition1' align='center'>"+Winchk+"</td>";
		        tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_TimeText").text+"</td>";
	            tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_Pcode").text+"</td>";
		        tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_Cost").text+"</td>"
		        tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_SPrice").text+"</td>";
		        tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_SaleRatio").text+"</td>";
		        tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_TPrice").text+"</td>";
		        tdlHTML += "<td class='condition2' align='center'>"
		        tdlHTML += "<table>";
		        tdlHTML += "<tr>";
		        tdlHTML += "<td width ='100px'class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_Margin").text+"</td>";      
		        tdlHTML += "</tr>";
		        tdlHTML += "<tr>";
		        tdlHTML += "<td bgcolor='black'class='condition2' align='center' width='100%'></td>";
		        tdlHTML += "</tr>";
		        tdlHTML += "<tr>";
		        tdlHTML += "<td width ='100px'class='condition2' align='center'>"+"("+elm.selectSingleNode("nmREQ_Profit").text+")"+"</td>";
		        tdlHTML += "</tr>";
		        tdlHTML += "</table>";
		        tdlHTML += "</td>";
		        tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmREQ_InterMon").text+"</td>";
		        tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_ARS_C").text+"</td>";
		        tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmREQ_ARS_W").text+"</td>";
		        tdlHTML += "</tr>";
			}
		}
	}
	
	tdlHTML += "</table>";
	document.getElementById("tblList_REQ").innerHTML = tdlHTML;
	
	elmList2 = elmRoot.selectNodes("OLD_OPERATION/ITEM");
	tdlHTML ="";
    tdlHTML +="<table border='1' width='100%' height='100%' style='MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse' id='OLD' bordercolor='#111111'>";
	tdlHTML +="<tr height='60px;' ><td align='center' class='condition_title' width='8%' bgColor='#f2f2f2'>구분</td>";
	tdlHTML +="<td align='center' class='condition_title' width='7%' bgColor='#f2f2f2'>광고특약<br>유형</td>";
	tdlHTML +="<td align='center' class='condition_title' width='5%' bgColor='#f2f2f2'>원가<br>(VAT포함)</td>";
	tdlHTML +="<td align='center' class='condition_title' width='11%' bgColor='#f2f2f2'>판매가<br>(VAT포함)</td>";
	tdlHTML +="<td align='center' class='condition_title' width='6%' bgColor='#f2f2f2'>상품<br>매출비율</td>";
    tdlHTML +="<td align='center' class='condition_title' width='7%' bgColor='#f2f2f2'>분당 공헌이익액<br>(공헌이익율)</td>";
	tdlHTML +="<td align='center' class='condition_title' width='13%' bgColor='#f2f2f2'>분당<br>광고특약수수료</td>";
    tdlHTML +="<td align='center' class='condition_title' width='9%' bgColor='#f2f2f2'>무이자<br />개월수</td>";
	tdlHTML +="<td align='center' class='condition_title' width='5%' bgColor='#f2f2f2'>상품<br />코드</td>";
	tdlHTML +="<td align='center' id='tdTxtChg' class='condition_title' width='7%' bgColor='#f2f2f2'>상선회회차</td>";
	tdlHTML +="<td >&nbsp;</td>";
	tdlHTML +="<td align='center'  class='condition_title' width='6%' bgColor='#f2f2f2'>거래<br />형태</td>";
	tdlHTML +="<td align='center'  class='condition_title' width='8%' bgColor='#f2f2f2'>배송<br />형태</td>";
	tdlHTML +="<td align='center'  class='condition_title' width='8%' bgColor='#f2f2f2'>배송<br />기일</td>";  
	
	for(var j=0;j<elmList2.length;j++)
	{
		elm = elmList2.nextNode();
		var oWinchk="";
		if (elm.selectSingleNode("nmOLD_Win1").text != ""){
			tdlHTML += "<tr height='27px;'>";
			tdlHTML += "<td class='condition3' align='center'id='tdTxtChg2' bgColor='#f2f2f2'>상선위 조건</td>";
			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_Win1").text+"</td>";
			tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmOLD_Cost1").text+"</td>";
			tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmOLD_SPrice1").text+"</td>";
			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_SaleRatio1").text+"</td>";

			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_TPU1").text + "<br/>"+"(" +elm.selectSingleNode("nmOLD_TPD1").text+")"+"</td>";

			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_TPrice1").text+"</td>";
		    tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_InterMon1").text+"</td>";
			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_Pcode1").text+"</td>";
			tdlHTML += "<td class='condition2' align='center'>"+elm.selectSingleNode("nmOLD_Sang1").text+"</td>";
			tdlHTML += "<td >&nbsp;</td>";
			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_Type1").text+"</td>";
			tdlHTML += "<td class='condition1' align='center'>"+elm.selectSingleNode("nmOLD_Delivery_21").text+"</td>";
			tdlHTML += "<td class='condition1' align='center' >"+elm.selectSingleNode("nmOLD_Delivery_Day1").text+"</td>";
			tdlHTML += "</tr>";	
			
		}
		

	}
	
    elmList2_1 = elmRoot;
     
	tdlHTML += "<tr height='27px;'>";
	tdlHTML += "<td class='condition3' align='center'id='tdTxtChg3' bgColor='#f2f2f2'>상선위<br>대비<br> 변경내용</td>";
	tdlHTML += "<td class='condition2' align='center'>-</td>";
	tdlHTML += "<td class='condition2' align='center'><span id='nmOLD_Cost1_S1'/></td>";
    tdlHTML += "<td class='condition2' align='center'><span id='nmOLD_SPrice1_S1'/></td>";
	tdlHTML += "<td class='condition1' align='center'><span id='nmOLD_SaleRatio1_S1'/></td>";
    tdlHTML += "<td class='condition1' align='center'>"+elmList2_1.selectSingleNode("nmOLD_TPU1_S1").text + "<br/>"+"(" +elmList2_1.selectSingleNode("nmOLD_TPD1_S1").text+")" + "</td>";
	tdlHTML += "<td class='condition1' align='center'><span id='nmOLD_Tprice1_S1'/></td>";
	tdlHTML += "<td class='condition2' align='center'><span id='nmOLD_InterMon1_S1'/></td>";
	tdlHTML += "<td class='condition2' align='center'>-</td>";
	tdlHTML += "<td class='condition2' align='center'>-</td>";
	tdlHTML +="<td >&nbsp;</td>";
	tdlHTML +="<td class='condition2' align='center'>-</td>";
	tdlHTML +="<td class='condition2' align='center'>-</td>";
	tdlHTML +="<td class='condition2' align='center'>-</td>";
	
	tdlHTML += "<tr height='27px;'>";
    tdlHTML += "<td class='condition3' align='center'id='tdTxtChg4' bgColor='#f2f2f2'>상선위<br > 대비<br > 변경사유</td>";
	tdlHTML += "<td class='condition3' align='left'colspan='13'><span id='nmOLD_Sangtext1'/></td>";
			
	
	tdlHTML += "</table>";
	document.getElementById("tblList_OLD").innerHTML = tdlHTML; 
	
	elmList3 = elmRoot.selectNodes("CHG_OPERATION/ITEM");       	
    tdlHTML ="";
    tdlHTML +="<table border='1' width='100%' height='100%' style='MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse' id='CHG' bordercolor='#111111'>";
	
	for(var m=0;m<elmList3.length;m++)
	{
		oindex++;
		elm = elmList3.nextNode();
		if (elm.selectSingleNode("nmChg_Reason").text != ""){
			tdlHTML += "<tr>";
			if (oindex == 1) {
				tdlHTML += "<td class='condition' width='5%' align='center' bgColor='#f2f2f2' rowspan='" + elmList3.length + "'>특기사항</td>";
			}
			tdlHTML += "<td class='condition' width='5%' align='center'>" + oindex + "</td>";
			tdlHTML += "<td class='condition3'>&nbsp;"+" "+elm.selectSingleNode("nmChg_Reason").text+"</td>";
			tdlHTML += "</tr>";
		}
	}
	tdlHTML += "</table>";
    document.getElementById("tblList_CHG").innerHTML = tdlHTML;
    
    //woong 추가
    //debugger;
    try{
        elmList4 = elmRoot.selectNodes("EX1_OPERATION/ITEM");       	
        tdlHTML ="";
        tdlHTML +="<table border='1' width='100%' height='100%' style='MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse' id='CHG' bordercolor='#111111'>";
    	
	    for(var m=0;m<elmList4.length;m++)
	    {
		    oindex1++;
		    elm = elmList4.nextNode();
		    if (elm.selectSingleNode("nmChg_Reason1").text != ""){
			    tdlHTML += "<tr>";
			    if (oindex1 == 1) {
				    tdlHTML += "<td class='condition' width='5%' align='center' bgColor='#f2f2f2' rowspan='" + elmList4.length + "'>상품기능(설명)</td>";
			    }
			    tdlHTML += "<td class='condition' width='5%' align='center'>" + oindex1 + "</td>";
			    tdlHTML += "<td class='condition3'>&nbsp;"+" "+elm.selectSingleNode("nmChg_Reason1").text+"</td>";
			    tdlHTML += "</tr>";
		    }
	    }
	    tdlHTML += "</table>";
        document.getElementById("tblList_EX1").innerHTML = tdlHTML;
    }catch(e){}
    
    try{
        elmList5 = elmRoot.selectNodes("EX2_OPERATION/ITEM");       	
        tdlHTML ="";
        tdlHTML +="<table border='1' width='100%' height='100%' style='MARGIN-TOP: 0px;BORDER-COLLAPSE: collapse' id='CHG' bordercolor='#111111'>";
    	
	    for(var m=0;m<elmList5.length;m++)
	    {
		    oindex2++;
		    elm = elmList5.nextNode();
		    if (elm.selectSingleNode("nmChg_Reason2").text != ""){
			    tdlHTML += "<tr>";
			    if (oindex2 == 1) {
				    tdlHTML += "<td class='condition' width='5%' align='center' bgColor='#f2f2f2' rowspan='" + elmList5.length + "'>고객<br />제공<br />가치</td>";
			    }
			    tdlHTML += "<td class='condition' width='5%' align='center'>" + oindex2 + "</td>";
			    tdlHTML += "<td class='condition3'>&nbsp;"+" "+elm.selectSingleNode("nmChg_Reason2").text+"</td>";
			    tdlHTML += "</tr>";
		    }
	    }
	    tdlHTML += "</table>";
        document.getElementById("tblList_EX2").innerHTML = tdlHTML;
    }catch(e){}
    
    //woong 추가 끝
    var elmList6Len = 0;
    var initdate = getInfo("INITIATED_DATE").substring(0,10);
    if(initdate > "2014-08-13")
    {
	    try{
            elmList6 = elmRoot.selectNodes("EXP_OPERATION/ITEM");
            var elmList7 = elmRoot.selectNodes("EXP_OPERATION/ITEM");
            var elmList8 = elmRoot.selectNodes("EXP_OPERATION/ITEM");
            elmList6Len = elmList6.length;
            
            var elm1 = "";
            var elm2 = "";
            var elm3 = "";
            if(getInfo("mode") == "COMPLETE"){
            
            tdlHTML ="";
            tdlHTML +="<table border='2' id='exp1' style='width:30%; height:70px; border-color:#3300ff; margin-top:0px; border-collapse:collapse; float:left; margin-left:-1px;'>";
            tdlHTML +="<tr align='center'>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 취급고<br>매출액 목표</td>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 예상<br>취급고매출액</td>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>예상 PGM<br>취급고달성율</td>";
            tdlHTML +="</tr>";
        
            for(var m=0;m<elmList6.length;m++)
	        {
		        elm1 = elmList6.nextNode();
		        if (elm1.selectSingleNode("nmSalePerSec_ys1").text != "")
		        {
		            tdlHTML +="<tr align='center'>";
		            tdlHTML += "<td align='center'>"+elm1.selectSingleNode("nmSalePerSec_P1").text+"</td>";
			        tdlHTML += "<td align='center'>"+elm1.selectSingleNode("nmSalePerSec_ys1").text+"</td>";
			        tdlHTML += "<td align='center'>"+elm1.selectSingleNode("nmSalePerSec_PGM1").text+"</td>";
			        tdlHTML +="</tr>";
		        }
		    }
		    tdlHTML += "</table>";
		    
		    tdlHTML +="<table border='2' id='exp2' style='width:42%; height:70px; border-color:#3300ff; margin-top:0px; border-collapse:collapse; float:left; margin-left:-1px;'>";
            tdlHTML +="<tr align='center'>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 수수료<br>매출액 목표</td>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 상품<br>수수료액</td>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 광고<br>특약수수료</td>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>예상 PGM<br>매출액달성율</td>";
            tdlHTML +="</tr>";
            
            for(var m=0;m<elmList7.length;m++)
	        {
		        elm2 = elmList7.nextNode();
		        if (elm2.selectSingleNode("nmSalePerSec_ys1").text != "")
		        {
		            tdlHTML +="<tr align='center'>";
		            tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_P2").text+"</td>";
			        tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_ww3").text+"</td>";
			        tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_ww4").text+"</td>";
			        tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_PGM2").text+"</td>";
			        tdlHTML +="</tr>";
		        }
		    }
		    tdlHTML += "</table>";
		    
		    tdlHTML +="<table border='1' id='exp3' style='width:27%; height:70px; border-color:#111111; margin-top:0px; border-collapse:collapse; float:left; margin-left:-1px;'>";
            
            tdlHTML +="<tr align='center'>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 예상<br/>취급고량</td>";
            tdlHTML +="<td style='background-color:#f2f2f2;'>분당 예상<br/>공헌이익액</td>";
            tdlHTML +="</tr>";
           
             for(var m=0;m<elmList8.length;m++)
	        {
		        elm3 = elmList8.nextNode();
		        if (elm3.selectSingleNode("nmSalePerSec_ys1").text != "")
		        {
		            tdlHTML +="<tr align='center'>";
		            tdlHTML += "<td align='center'>"+elm3.selectSingleNode("nmSalePerSec_ys2").text+"</td>";
		            tdlHTML += "<td align='center'>"+elm3.selectSingleNode("nmSalePerSec_yadd1").text+"</td>";
			        tdlHTML +="</tr>";
		        }
		    }
		    tdlHTML += "</table>";
            
            document.getElementById("tblList_EXP").innerHTML = tdlHTML;
            
            }
            else
            {
                tdlHTML ="";
                tdlHTML +="<table border='2' id='exp1' style='width:30%; height:70px; border-color:#3300ff; margin-top:0px; border-collapse:collapse; float:left; margin-left:-1px;'>";
                tdlHTML +="<tr align='center'>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당 취급고<br>매출액 목표</td>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당 예상<br>취급고매출액</td>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>예상 PGM<br>취급고달성율</td>";
                tdlHTML +="</tr>";
            
                for(var m=0;m<elmList6.length;m++)
	            {
		            elm1 = elmList6.nextNode();
		            if (elm1.selectSingleNode("nmSalePerSec_ys1").text != "")
		            {
		                tdlHTML +="<tr align='center'>";
		                tdlHTML += "<td align='center'>"+elm1.selectSingleNode("nmSalePerSec_P1").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm1.selectSingleNode("nmSalePerSec_ys1").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm1.selectSingleNode("nmSalePerSec_PGM1").text+"</td>";
			            tdlHTML +="</tr>";
		            }
		        }
		        tdlHTML += "</table>";
    		    
		        tdlHTML +="<table border='2' id='exp2' style='width:42%; height:70px; border-color:#3300ff; margin-top:0px; border-collapse:collapse; float:left; margin-left:-1px;'>";
                tdlHTML +="<tr align='center'>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당수수료<br>매출액 목표</td>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당 상품<br>수수료액</td>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당 광고<br>특약수수료</td>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>예상 PGM<br>매출액달성율</td>";
                tdlHTML +="</tr>";
                
                for(var m=0;m<elmList7.length;m++)
	            {
		            elm2 = elmList7.nextNode();
		            if (elm2.selectSingleNode("nmSalePerSec_ys1").text != "")
		            {
		                tdlHTML +="<tr align='center'>";
		                tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_P2").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_ww3").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_ww4").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm2.selectSingleNode("nmSalePerSec_PGM2").text+"</td>";
			            tdlHTML +="</tr>";
		            }
		        }
		        tdlHTML += "</table>";
    		    
		        tdlHTML +="<table border='1' id='exp3' style='width:27%; height:70px; border-color:#111111; margin-top:0px; border-collapse:collapse; float:left; margin-left:-1px;'>";
                
                tdlHTML +="<tr align='center'>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당 예상<br/>취급고량</td>";
                tdlHTML +="<td style='background-color:#ffff00;'>수수료<br/>매출율</td>";
                tdlHTML +="<td style='background-color:#f2f2f2;'>분당 예상<br/>공헌이익액</td>";
                tdlHTML +="<td style='background-color:#ffff00;'>예상<br/>공헌이익율</td>";
                tdlHTML +="</tr>";
               
                for(var m=0;m<elmList8.length;m++)
	            {
		            elm3 = elmList8.nextNode();
		            if (elm3.selectSingleNode("nmSalePerSec_ys1").text != "")
		            {
		                tdlHTML +="<tr align='center'>";
		                tdlHTML += "<td align='center'>"+elm3.selectSingleNode("nmSalePerSec_ys2").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm3.selectSingleNode("nmSalePerSec_y2").text+"</td>";
		                tdlHTML += "<td align='center'>"+elm3.selectSingleNode("nmSalePerSec_yadd1").text+"</td>";
			            tdlHTML += "<td align='center'>"+elm3.selectSingleNode("nmSalePerSec_yadd2").text+"</td>";
			            tdlHTML +="</tr>";
		            }
		        }
		        tdlHTML += "</table>";
                
                document.getElementById("tblList_EXP").innerHTML = tdlHTML;
            }         
        }catch(e){}        
    }
			    
    //결재 완료 CAY
	if(getInfo("mode") == "COMPLETE" && getInfo("readtype") != "preview")
	{   
		document.getElementById("trCondition1").style.display = "none";
		document.getElementById("trCondition2").style.display = "none";
		document.getElementById("trCondition3").style.display = "none";
		document.getElementById("trCondition4").style.display = "none";
		document.getElementById("trCondition5").style.display = "none";
    }

	for (var k=0; k<oNodeList.length; k++){
		var oNode = oNodeList.item(k);
		var szname = oNode.nodeName;
		if(szname == "nmName") {MD_Manager.innerHTML = oNode.text;}
		else if(szname == "qmName") {QM_Manager.innerHTML = oNode.text;}
		else if(szname == "nmFDATE") { nmFDATE.innerHTML = oNode.text;}
		else if(szname == "nmWDATE") { nmWDATE.innerHTML = oNode.text;}
		else if(szname == "nmCompanyname") { Companyname.innerHTML = oNode.text;}
		else if(szname == "nmCompanycode") { Companycode.innerHTML = oNode.text;}
		else if(szname == "nmLicensenum") { Licensenum.innerHTML = (oNode.text.length==10 ?(oNode.text.substring(0,3)+"-"+oNode.text.substring(3,5)+"-"+oNode.text.substring(5,10)):(oNode.text.substring(0,6)+"-"+oNode.text.substring(6,14)));}
		else if(szname == "nmAddress") {nmAddress.innerHTML = oNode.text;}
		else if(szname == "nmCeo") { Ceo.innerHTML = oNode.text;}
		else if(szname == "nmWarrant") { nmWarrant.innerHTML = oNode.text;}
		else if(szname == "nmNewGoods") { nmNewGoods.innerHTML = oNode.text;}
		else if(szname == "nmManuCompany") { nmManuCompany.innerHTML = oNode.text;}
		else if(szname == "nmOriginPlace") { nmOriginPlace.innerHTML = oNode.text;}
		else if(szname == "nmEntType") { nmEntType.innerHTML = oNode.text;}
		else if(szname == "nmEntAlphabet") { nmEntAlphabet.innerHTML = oNode.text;}
		else if(szname == "nmEntSize") { nmEntSize.innerHTML = oNode.text;}
		else if(szname == "nmTax") { nmTax.innerHTML = oNode.text;}
		else if(szname == "nmNS") { nmNS.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_em") { SalePerSec_em.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_emy") { SalePerSec_emy.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_eb") { SalePerSec_eb.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_ww1") { SalePerSec_ww1.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_ars1") { SalePerSec_ars1.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_ars2") { SalePerSec_ars2.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_ars3") { SalePerSec_ars3.innerHTML = oNode.text;}
		else if(szname == "nmSalePerSec_en") { SalePerSec_en.innerHTML = oNode.text;}
		else if(szname == "nmCondition") { 
			//nmCondition.innerHTML = oNode.text;
			document.getElementById("nmCondition").innerHTML = oNode.text;
			if(oNode.text == "상선위 조건" || oNode.text == "") 
			{
			    document.getElementById("tdTxtChg").innerText = "상선위 회차"; //2013.10.02 수정
			} 
			else
	        {
	          document.getElementById("tdTxtChg").innerText =  "상품구성";
	          document.getElementById("tdTxtChg0").innerText =  "※ 종전조건 및 종전대비 변경사항";
		      document.getElementById("tdTxtChg2").innerText = "종전조건";
		      document.getElementById("tdTxtChg3").innerText = "종전대비변경내용";
		      document.getElementById("tdTxtChg4").innerText = "종전대비변경사유";
	        }
		}
		else if(szname == "nmTrust") { nmTrust.innerHTML = oNode.text;}
		else if(szname == "txtTransact") { txtTransact.innerHTML = oNode.text;}
		else if(szname == "txtProduct") { txtProduct.innerHTML = oNode.text;}
		
		
		else if ( szname == "schema" ){
		 if(oNode.getAttribute("Gusung") == "1" ) { eval("chk"+"Gusung").innerHTML = "<b>V</b>"; }
		 if(oNode.getAttribute("SGusung") == "1") { eval("chk"+"SGusung").innerHTML = "<b>V</b>"; }
		 if(oNode.getAttribute("Cost") == "1") { eval("chk"+"Cost").innerHTML = "<b>V</b>"; }
		 if(oNode.getAttribute("Deliver") == "1") { eval("chk"+"Deliver").innerHTML = "<b>V</b>"; }
		 if(oNode.getAttribute("Promotion") == "1") { eval("chk"+"Promotion").innerHTML = "<b>V</b>"; }
		 if(oNode.getAttribute("Winwin") == "1") { eval("chk"+"Winwin").innerHTML = "<b>V</b>"; }	
		 if(oNode.getAttribute("Etc") == "1") { eval("chk"+"Etc").innerHTML = "<b>V</b>"; }
		}
		if(initdate < "2014-08-14")
		{
		    if(szname == "nmSalePerSec_ys1") { SalePerSec_ys1.innerHTML = oNode.text;}
		    else if(szname == "nmSalePerSec_ys2") { SalePerSec_ys2.innerHTML = oNode.text;}
		    else if(szname == "nmSalePerSec_ww2") { SalePerSec_ww2.innerHTML = oNode.text;}
		    else if(szname == "nmSalePerSec_y") { if(oNode.text==""){SalePerSec_y.innerHTML = "&nbsp;";}else{SalePerSec_y.innerHTML = oNode.text;}}
		    else if(szname == "nmSalePerSec_y2") { SalePerSec_y2.innerHTML = oNode.text;}
		    else if(szname == "nmSalePerSec_yadd1") { SalePerSec_yadd1.innerHTML = oNode.text;}
		    else if(szname == "nmSalePerSec_yadd2") { SalePerSec_yadd2.innerHTML = oNode.text;}
		    
		    if( getInfo("mode") != "COMPLETE" || getInfo("usid") == "gwadmin" || getInfo("usid") == "hblee" )
		    {
		        document.getElementById("y2_1").style.display = "";
			    document.getElementById("y2_2").style.display = "";
			    document.getElementById("yadd2_1").style.display = "";
			    document.getElementById("yadd2_2").style.display = "";
		    }
		}
        innerHtmlData(szname, oNode.text);
	}
}



// checkbox 값을 얻어옴(1또는 0)
function getCFields(Field){
	var sText = "<schema ";
	var fieldname, fieldvalue;
	
	for(var i=0;i<cField.length;i++){
		fieldname = cField[i].name;
		fieldname = fieldname.replace("chk","");
		sText += fieldname  + "=\"" + (cField[i].checked == true?"1":"0")+"\"" + " ";
	}	
	sText+="/>";
	return sText;		
}

function checkForm(bTempSave){    //debugger
	if (bTempSave){	
	}else{
		//2009.12 jju 재기안일자 추출
		//if(getInfo("mode") == "RECAPPROVAL"){
		if(getInfo("mode") == "REDRAFT"){
		//debugger;
			var xmlApv= new ActiveXObject("MSXML2.DOMDocument");
			xmlApv.loadXML("<apvlist>"+getInfo("apst")+"</apvlist>");

			//var oFirstNode=xmlApv.selectSingleNode("apvlist/steps/step[@unittype='ou' and @routetype='receive']/ou[@code='"+getInfo("dpid_apv")+"' and taskinfo/@status='pending']");
			//var oFirstNode=xmlApv.selectSingleNode("apvlist/steps/step[@unittype='ou' and @routetype='receive']/ou[@code='"+getInfo("dpid_apv")+"' and taskinfo/@kind='charge']");
			//var oFirstNode=xmlApv.selectSingleNode("apvlist/steps/step[@unittype='ou' and @routetype='receive']/ou[@code='"+getInfo("dpid_apv")+"' and person/taskinfo/@kind='charge']");
			//var oFirstNode=xmlApv.selectS1
			var oFirstNode=xmlApv.selectSingleNode("apvlist/steps/division/step[@unittype='ou' and @routetype='receive']/ou[@code='"+getInfo("dpid_apv")+"']");
			if(oFirstNode != null){
				//dField["REDRAFT_DATE"].value = oFirstNode.selectSingleNode("person/taskinfo[@status='pending']").getAttribute("datereceived");
				//dField["REDRAFT_DATE"].value = oFirstNode.selectSingleNode("person/taskinfo[@status='pending']").getAttribute("datecompleted");
				
				/*
				dField["REDRAFT_DATE"].value = oFirstNode.selectSingleNode("person/taskinfo[@kind='charge']").getAttribute("datecompleted");
				//alert(dField["REDRAFT_DATE"].value);
				dField["REDRAFT_DATE"].value = dField["REDRAFT_DATE"].value.substring(0,10);
				*/
				
				var oToday = new Date();
				//dField["REDRAFT_DATE"].value = oToday.getYear() + "-" + (oToday.getMonth()+1) + "-" + oToday.getDate();
				dField["REDRAFT_DATE"].value = oToday.getYear() + "-" + ( (oToday.getMonth()+1) <= 9 ? ('0'+ (oToday.getMonth()+1)) : (oToday.getMonth() +1)) + "-" + oToday.getDate();
				//dField["REDRAFT_DATE"].value = oToday.getYear() + "-" + ( (oToday.getMonth()+1) <= 9 ? ('0'+ (oToday.getMonth()+1)) : (oToday.getMonth() +1)) + "-" + ( (oToday.getDate()+1) <= 9 ? ('0'+ (oToday.getDate()+1)) : (oToday.getDate() +1));
				
				//document.getElementsByName("REDRAFT_DATE")[0].value = oFirstNode.selectSingleNode("ou/taskinfo[@kind='normal']").getAttribute("datereceived");
				//dField["REDRAFT_DATE"].value = oFirstNode.selectSingleNode("taskinfo[@kind='normal']").getAttribute("datereceived");
				//dField["REDRAFT_DATE"].value = dField["REDRAFT_DATE"].value.substring(0,10);
								
				//dField["EBH_DATE"].value = getDayInterval(getInfo("INITIATED_DATE").substring(0,10), dField["REDRAFT_DATE"].value);	//프로세스 개설기일(기안일자-재기안일자)
				dField["EBH_DATE"].value = getDayInterval(getInfo("INITIATED_DATE").substring(0,10), dField["REDRAFT_DATE"].value);	//프로세스 개설기일(기안일자-재기안일자)
				dField["EBH_DATE"].value = parseInt(dField["EBH_DATE"].value) + parseInt(1);
				//dField["REAL_DATE"].value = nmWDATE.value.replace(/[.]/g, "-");  nmFDATE
				dField["REAL_DATE"].value = document.getElementById("nmWDATE").innerHTML;
				dField["REAL_DATE"].value = dField["REAL_DATE"].value.substring(0,10);
			}
		}
	}
	
	if(qmName.value == '') {
		alert('담당QM명을 입력하세요');
		return false;
//	}else if(nmFDATE.value == '') {
//		alert('상선위시 방소예정일을 입력하세요');
//		return false;
//	}else if(nmWDATE.value == '') {
//		alert('실 방송예정일을 입력하세요');
//		return false;
//	}else if(nmCompanyname.value == '') {
//		alert('업체명을 입력하세요');
//		return false;
//	}else if(nmCompanycode.value == '') {
//		alert('업체코드를 입력하세요');
//		return false;
//	}else if(nmLicensenum.value == '') {
//		alert('사업자등록번호를 입력하세요');
//		return false;
//	}else if(nmAddress.value == '') {
//		alert('주소를 입력하세요');
//		return false;
//	}else if(nmCeo.value == '') {
//		alert('대표자성명을 입력하세요');
//		return false;
//	}else if(nmWarrant.value == '') {
//		alert('담보내역을 선택하세요');
//		return false;
//	}else if(nmNewGoods.value == '') {
//		alert('신상품여부를 선택하세요');
//		return false;
//	}else if(nmManuCompany.value == '') {
//		alert('제조사를 입력하세요');
//		return false;
//	}else if(nmOriginPlace.value == '') {
//		alert('원산지를 입력하세요');
//		return false;
//	}else if(nmEntType.value == '') {
//		alert('업체유형을 선택하세요');
//		return false;
//	}else if(nmEntAlphabet.value == '') {
//		alert('업체유형을 선택하세요');
//		return false;
//	}else if(nmEntSize.value == '') {
//		alert('업체유형을 선택하세요');
//		return false;
//	}else if(nmTax.value == '') {
//		alert('부가세여부를 선택하세요');
//		return false;
//	}else if(nmREQ_Pname.value == '') {
//		alert('상품명을 입력하세요');
//		return false;
//	}else if(nmREQ_Pcode.value == '') {
//		alert('상품코드를 입력하세요');
//		return false;
//	}else if(nmREQ_Mcode.value == '') {
//		alert('머더코드를 입력하세요');
//		return false;
//	}else if(nmREQ_SaleRatio.value == '') {
//		alert('매출비율을 입력하세요');
//		return false;
//	}else if(nmREQ_Profit.value == '') {
//		alert('공헌이익율을 입력하세요');
//		return false;
//	}else if(nmREQ_Margin.value == '') {
//		alert('단위당 공헌이익액을 입력하세요');
//		return false;
//	}else if(nmREQ_Win.value == '') {
//		alert('윈윈여부를 선택하세요');
//		return false;
//	}else if(nmOLD_Type1.value == '') {
//		alert('거래형태를 입력하세요');
//		return false;
//	}else if(nmOLD_Delivery_11.value == '') {
//		alert('배송형태를 입력하세요');
//		return false;
//	}else if(nmOLD_Delivery_Day1.value == '') {
//		alert('배송기일을 입력하세요');
//		return false;
//	}else if(nmCondition.value == '') {
//		alert('4번 항목을 선택하세요');
//		return false;
//	}else if(nmOLD_SaleRatio1.value == '') {
//		alert('매출비율을 입력하세요');
//		return false;
//	}else if(nmOLD_Profit1.value == '') {
//		alert('공헌이익율을 입력하세요');
//		return false;
//	}else if(nmOLD_Win1.value == '') {
//		alert('윈윈여부를 입력하세요');
//		return false;
//	}else if(nmOLD_Delivery_21.value == '') {
//		alert('배송형태를 입력하세요');
//		return false;
//	}else if(nmOLD_Pcode1.value == '') {
//		alert('상품코드를 입력하세요');
//		return false;
//	}else if(nmOLD_Sang1.value == '') {
//		alert('상선위회차를 입력하세요');
//		return false;
	}else if(nmName.value == '') {
		alert('담당QM명을 입력하세요');
		return false;
	}else {
		return true;
	}

/*	if(nmCompanyname.value == '' ){
		alert('회사이름을 입력하세요');	
		return false;
	}else if(nmCompanycode.value == ''){
		alert('회사코드를 입력하세요');		
		return false;
	//}else if(nmREQ_Pname[0].value == ''){
	}else if(nmREQ_Pname.value == ''){
		alert('상품명을 입력하세요');		
		return false;							*/
/*	}else if(nmChargeDuty.value == ''){
		alert('담당직무를 입력하세요');		
		return false;
	}else if(nmEducationTitle.value == ''){
		alert('교육명을 입력하세요');
		return false;
	}else if(nmEducationObject.value == ''){
		alert('교육목적을 입력하세요');		
		return false;
	}else if(nmEducationContent.value == ''){
		alert('교육내용을 입력하세요');			
		return false;
	}else if(SDATE.value == ''){
		alert('교육기간 시작일을 입력하세요');
		return false;		
	}else if(EDATE.value == ''){
		alert('교육기간 종료일을 입력하세요');
		return false;	
	}else if(nmSuperviseCompany.value == ''){
		alert('주관업체명을 입력하세요');
		return false;
	}else if(nmCharge.value == ''){
		alert('담당자를 입력하세요');	
		return false;
	}else if(nmEducationalExpenses.value == ''){
		alert('교육비를 입력하세요');	
		return false;	
	}else{		
		return true;*/
	//}
	return true;
}

//input box에 
function getMFields(Fields){
		var sText = "";
		for(var i=0;i<Fields.length;i++){
			sText += makeNode(Fields[i].name, Fields[i].value);
		}
		return sText;
}


function addList(){
	var rgParams=null;
	rgParams=new Array();
	rgParams["bMail"]  = false;
	rgParams["bUser"] = true;
	rgParams["bGroup"] =false;
	rgParams["bRef"] = false;
	rgParams["bIns"] = false; 
	rgParams["bRecp"] = false; 
	rgParams["sCatSignType"] = "수신결재"; 
	rgParams["sDeptSignType"] = "일반결재";
	rgParams["sDeptSignStatus"] = "수신"; 
	rgParams["sUserSignType"] = "일반결재";
	rgParams["sUserSignStatus"] = "대기"; 
	rgParams["objMessage"] = window;

	var szFont = "FONT-FAMILY: '굴림';font-size:9px;";
	var nWidth = 640;
	var nHeight = 480;
	var vRetval = window.showModelessDialog("../address/address.htm", rgParams, szFont+"dialogHeight:"+nHeight+"px;dialogWidth:"+nWidth+"px;status:no;resizable:yes;help:no;");
}

function ADD(sobj){alert("function ADD");
  sobj = eval(sobj).id; 
  switch (sobj){
	case "REQ":  
		var tbl = document.all["REQ"];
		var tr = tbl.insertRow();
		var td1 = tr.insertCell();
		var td2 = tr.insertCell();
		var td3 = tr.insertCell();
		var td4 = tr.insertCell();
		var td5 = tr.insertCell();
		var td6 = tr.insertCell();
		var td7 = tr.insertCell();
		var td8 = tr.insertCell();
		var td9 = tr.insertCell();
		var td10 = tr.insertCell();
		var td11 = tr.insertCell();

		td1.className ='aligncenter';
		td1.innerHTML ='<input type="text" id="mField" class="valuefield1" name="nmREQ_Pname" style="text-align:center;ime-mode:active;" maxlength="8" size="8">';	
		td2.className ='aligncenter';
		td2.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_Pcode" style="text-align:center;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk()">';
		td3.className ='aligncenter';
		td3.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_Mcode" style="text-align:center;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk()">';
		td4.className ='aligncenter';
		td4.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_Cost" style="text-align:right;ime-mode:disabled;" maxlength="10" size="10" onkeypress="num_chk()" onkeyup="auto_comma(this);" onblur="get_float(this);">';
		td5.className ='aligncenter';
		td5.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_SPrice" style="text-align:right;ime-mode:disabled;" maxlength="10" size="10" onkeypress="num_chk()" onkeyup="auto_comma(this);" onblur="get_float(this);">';
		td6.className ='aligncenter';
		td6.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_SaleRatio" style="text-align:right;ime-mode:disabled;" onblur="add_percent(this);" maxlength="5" size="5">';
		td7.className ='aligncenter';
		td7.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_Profit" style="text-align:right;ime-mode:disabled;" onkeypress="num_chk();" onblur="add_percent(this);" maxlength="5" size="5"><input type="text" id="mField" class="valuefield1" name="nmREQ_Margin" style="text-align:right;ime-mode:disabled;" onkeypress="num_chk();" onkeyup="auto_comma(this);" onblur="get_float(this);" maxlength="9" size="9">';
		td8.className ='aligncenter';
		td8.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_Win" style="text-align:center;ime-mode:active;" maxlength="2" size="2">';        
		td9.className ='aligncenter';
		td9.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_InterMon" style="text-align:center;ime-mode:disabled;" maxlength="2" size="2">';        
		td10.className ='aligncenter';
		td10.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_ARS_W" style="text-align:right;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk();" onkeyup="auto_comma(this);" onblur="get_float(this);">';        
		td11.className ='aligncenter';
		td11.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmREQ_ARS_C" style="text-align:right;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk();" onkeyup="auto_comma(this);" onblur="get_float(this);">';        
	
		break;

	case "OLD":  
		var tbl = document.all["OLD"];
		var tr = tbl.insertRow();
		var td1 = tr.insertCell();
		var td2 = tr.insertCell();
		var td3 = tr.insertCell();
		var td4 = tr.insertCell();
		var td5 = tr.insertCell();
		var td6 = tr.insertCell();
		var td7 = tr.insertCell();
		var td8 = tr.insertCell();
		var td9 = tr.insertCell();
		var td10 = tr.insertCell();
		var td11 = tr.insertCell();

		td1.className ='aligncenter';
		td1.innerHTML ='<input type="text" id="mField" class="valuefield1" name="nmOLD_Pname" style="text-align:center;ime-mode:active;" maxlength="8" size="8">';	
		td2.className ='aligncenter';
		td2.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_Pcode" style="text-align:center;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk()">';
		td3.className ='aligncenter';
		td3.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_Mcode" style="text-align:center;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk()">';
		td4.className ='aligncenter';
		td4.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_Cost" style="text-align:right;ime-mode:disabled;" maxlength="10" size="10" onkeypress="num_chk()" onkeyup="auto_comma(this);" onblur="get_float(this);">';
		td5.className ='aligncenter';
		td5.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_SPrice" style="text-align:right;ime-mode:disabled;" maxlength="10" size="10" onkeypress="num_chk()" onkeyup="auto_comma(this);" onblur="get_float(this);">';
		td6.className ='aligncenter';
		td6.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_SaleRatio" style="text-align:right;ime-mode:disabled;" onblur="add_percent(this);" maxlength="5" size="5">';
		td7.className ='aligncenter';
		td7.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_Profit" style="text-align:right;ime-mode:disabled;" onkeypress="num_chk();" onblur="add_percent(this);" maxlength="5" size="5"><input type="text" id="mField" class="valuefield1" name="nmOLD_Margin" style="text-align:right;ime-mode:disabled;" onkeypress="num_chk();" onkeyup="auto_comma(this);" onblur="get_float(this);" maxlength="9" size="9">';
		td8.className ='aligncenter';
		td8.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_Win" style="text-align:center;ime-mode:active;" maxlength="2" size="2">';        
		td9.className ='aligncenter';
		td9.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_InterMon" style="text-align:center;ime-mode:disabled;" maxlength="2" size="2">';        
		td10.className ='aligncenter';
		td10.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_ARS_W" style="text-align:right;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk();" onkeyup="auto_comma(this);" onblur="get_float(this);">';        
		td11.className ='aligncenter';
		td11.innerHTML = '<input type="text" id="mField" class="valuefield1" name="nmOLD_ARS_C" style="text-align:right;ime-mode:disabled;" maxlength="6" size="6" onkeypress="num_chk();" onkeyup="auto_comma(this);" onblur="get_float(this);">';        
		
		break;

	case "CHG":  
		var tbl = document.all["CHG"];
		var tr = tbl.insertRow();
		var td1 = tr.insertCell();

		td1.className ='aligncenter';
		td1.innerHTML ='<input type="text" id="mField" class="valuefield1" name="nmChg_Reason" style="width:100%">';		        
		break;
		
	}
}

function REMOVE(sobj){	
  sobj = eval(sobj).id;  	
  switch (sobj){
	case "REQ":  	
		var tbl = document.all["REQ"];
		if(tbl.rows.length > 5){
			var tr = tbl.deleteRow();}
		break;
	case "OLD":
		var tbl = document.all["OLD"];
		if(tbl.rows.length > 5){
			var tr=tbl.deleteRow();}
		break;
	case "CHG":
		var tbl = document.all["CHG"];
		if(tbl.rows.length > 4){
			var tr=tbl.deleteRow();}
		break;
	}
}



//숫자만 가져오기
function get_number(val) {
    var str = ""+val;
    var temp = "";
    var num = "";
    for(var i=0; i<str.length; i++) {
        temp = str.charAt(i);
        if (temp >= "0" && temp <= "9") {
            num += temp;
        }
    }
    if ( (num != null) && (num != "") && (num != "0") ) {
        return parseInt(num,10); //십진수로 변환하여 리턴
    } else {
        return "0";
    }   
} 

//"%"삽입
function add_percent(val){
	var num = val.value;
	var str="";
	if(num.length!=0){
		for(i=0;i<num.length;i++){
			if(num.charAt(i)=="%")
			{
				str=num;
			}else{
			str = num+"%";
			}
		}
		
	}
	val.value=str;
}

//"%"삽입 소수점 1자리까지
function add_percent3(val){
	var num = val.value;
	var str="";
	str = parseFloat(num).toFixed(1);
	str= str+"%";
	val.value=str;
}
//정수 %고정
function add_percent4(val){
	var num = val.value;
	var str="";
	str = parseInt(num);
	str= str+"%";
	val.value=str;
}



//콤마삽입
function add_comma(val) {
    var num = val;
    if(num.length <= 3) return num;
    var loop = Math.ceil(num.length / 3);
    var offset = num.length % 3;
    if(offset==0) offset = 3;
    var str = num.substring(0, offset);
    for(i=1;i<loop;i++) {
        str += "," + num.substring(offset, offset+3);
        offset += 3;
    }
    return str;
}


function auto_comma(val) {
    if (navigator.userAgent.indexOf("MSIE") != -1) {
        var keyCode = window.event.keyCode;
        if ( ((keyCode>=48) && (keyCode <= 105)) || (keyCode==8) || (keyCode==13) || (keyCode==35) || (keyCode==46) ) {
            //0(48)~숫자키패드9(105), enter(13), bakspace(8), delete(46), end(35) key 일 때만 처리한다.
            var str = "" + get_number(val.value); //숫자만 가져온다
            var target = val;
            if ( (str != null) && (str != "") && (str != "0") ) {
                target.value = add_comma(str); //콤마삽입
            } else {
                target.value = "";
                target.focus();
                return false;
            }
        }
    }
    return true;
}



//소숫점 없애기
function get_float(val)
{
    var str = val.value;
    var position = str.length-1;
    if(str.lastIndexOf(".")==position)
    {
        val.value = str.substring(0,position);
    }
}



//숫자만 입력받기
function num_chk() {
    if (navigator.userAgent.indexOf("MSIE") != -1) {
        var keyCode = window.event.keyCode;
        if (( (keyCode < 48) || (keyCode > 57) ) && (keyCode != 46) ){
            event.returnValue=false;
            alert("숫자와 소수점만 입력 가능합니다.");
        }
    }
    return;
}


function addList(){
	var rgParams=null;
	rgParams=new Array();
	rgParams["bMail"]  = false;
	rgParams["bUser"] = true;
	rgParams["bGroup"] =false;
	rgParams["bRef"] = false;
	rgParams["bIns"] = false; 
	rgParams["bRecp"] = false; 
	rgParams["sCatSignType"] = "수신결재"; 
	rgParams["sDeptSignType"] = "일반결재";
	rgParams["sDeptSignStatus"] = "수신"; 
	rgParams["sUserSignType"] = "일반결재";
	rgParams["sUserSignStatus"] = "대기"; 
	rgParams["objMessage"] = window;

	var szFont = "FONT-FAMILY: '굴림';font-size:9px;";
	var nWidth = 640;
	var nHeight = 480;
	var vRetval = window.showModelessDialog("../address/address.htm", rgParams, szFont+"dialogHeight:"+nHeight+"px;dialogWidth:"+nWidth+"px;status:no;resizable:yes;help:no;");
}

function readCheck(i){readCheck[i]="1";}

function OpenKSRM() {
    if (document.getElementById("Licensenum").innerText == ""){
		//alert("사업자등록번호를 선택하세요.");
	}else{
		var License = document.getElementById("Licensenum").innerText;
		//현재 페이지를 유지하기 위해 테스트페이지를 띄우고, 그 페이지에서 링크페이지를 호출하는 방식으로 수정
		var szURL = "/CoviWeb/Approval/Forms/Test_Link.htm?License=" + License;
		window.open(szURL, "go_ksrm", "width=900,height=600,scrollbar=auto");
	}
}

function OpenTransact() {
	if(document.getElementById("txtTransact").innerText == "") {
		//alert("계약서 번호를 입력하세요.");
	}else {
		//window.open("https://ebiz.nsmall.com/common/Main.jsp?_param=NSS_LOGIN_HANDLER&user_id=ebiz&password=ebiz&_origin=/contract/nss/CONTRACT_ONE_Main.jsp?cont_seq=244174", "", "center=yes,scrollbars=yes,status=no,toolbar=no,resizable=yes,location=no,menu=no,width=1024,height=600");
		var szURL = "https://ebiz.nsmall.com/common/Main.jsp?_param=NSS_LOGIN_HANDLER&user_id=ebiz&password=ebiz&_origin=/contract/nss/CONTRACT_ONE_Main.jsp?cont_seq=" + document.getElementById("txtTransact").innerText;
		window.open(szURL, "", "center=yes,scrollbars=yes,status=no,toolbar=no,resizable=yes,location=no,menu=no,width=1024,height=600");
	}
}
function OpenProduct() {
	if(document.getElementById("txtProduct").innerText == "") {
		//alert("계약서 번호를 입력하세요.");
	}else {
		//window.open("https://ebiz.nsmall.com/common/Main.jsp?_param=NSS_LOGIN_HANDLER&user_id=ebiz&password=ebiz&_origin=/contract/nss/CONTRACT_ONE_Main.jsp?cont_seq=237782", "", "center=yes,scrollbars=yes,status=no,toolbar=no,resizable=yes,location=no,menu=no,width=1024,height=600");
		var szURL = "https://ebiz.nsmall.com/common/Main.jsp?_param=NSS_LOGIN_HANDLER&user_id=ebiz&password=ebiz&_origin=/contract/nss/CONTRACT_ONE_Main.jsp?cont_seq=" + document.getElementById("txtProduct").innerText;
		window.open(szURL, "", "center=yes,scrollbars=yes,status=no,toolbar=no,resizable=yes,location=no,menu=no,width=1024,height=600");
	}
}
/*** 데이터 뿌려주기 ***/
function innerHtmlData(nodeNm, nodeVal){
    if (document.getElementById(nodeNm) != undefined) {
        if (nodeNm.indexOf("OPT") != -1) {
            setRadio(nodeNm, nodeVal);
        } else if (nodeNm.indexOf("FORM_ATTACH") != -1) {
            setForm_Attach(nodeVal);
        } else if (nodeNm.indexOf("tbContentElement") != -1) {
            tbContentElement.innerHTML = nodeVal;
        } else if (nodeNm.indexOf("CHK") != -1) {
            setChk(nodeNm, nodeVal);
        } else {
            try {
                document.getElementById(nodeNm).innerHTML = nodeVal.replace(/\n/gi, "<br />");
            } catch (e) {
                document.getElementById(nodeNm).value = nodeVal;
            }
        }
    }
}
 
 function getDayInterval(time1,time2) { 
	if(time1.length != 10 || time2.length != 10) { 
	return 0; 
	} 
	var sTimeArr = time1.split("-"); 
	var eTimeArr = time2.split("-"); 
	if(sTimeArr.length != 3 || eTimeArr.length != 3) { 
	return 0; 
	} 
	var sDate = new Date(sTimeArr[0],(parseInt(sTimeArr[1], 10)-1),sTimeArr[2]); 
	var eDate = new Date(eTimeArr[0],(parseInt(eTimeArr[1], 10)-1),eTimeArr[2]); 
	var day = 1000 * 3600 * 24; //24시간 

	return parseInt((eDate - sDate) / day, 10); 
}

</script>
	</body>
</html>