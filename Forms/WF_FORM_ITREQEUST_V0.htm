<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma" content="no-cache" />
	<title></title>			
	<link rel="stylesheet" href="/GWImages/common/css/approval_form.css" type="text/css" />
    <!--필수 양식파일에 쓰이는 js 파일-->
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Config.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/EmbedObject.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Utility.js" ></script>
    <script type="text/javascript" language="javascript" src="../../Common/script/COVIFlowNet/openWindow.js" ></script>		
	<script type="text/javascript" language="javascript" src="../../Common/script/progress.js" ></script>
	<script type="text/javascript" language="javascript" src="../../common/script/NameControl.js"></script>
	<script type="text/javascript" language="javascript" src="../../common/script/jquery-1.3.2.min.js"></script>
	<script type="text/javascript" language="javascript" src="formedit.js" ></script>
	<!-- 달력 -->
    <script type="text/javascript" language="javascript" src="calendar/datepickercontrol.js"></script>
    <link type="text/css" rel="stylesheet" href="calendar/datepickercontrol.css" />   
		
</head>

<body topmargin="0" leftmargin="0" scroll="auto" align=center>
<!-- COMMON FIELDS -->
<input type="hidden" id="dField" name="INITIATOR_NAME" dataFld="usdn">
<input type="hidden" id="dField" name="INITIATOR_ID" dataFld="usid">
<input type="hidden" id="dField" name="INITIATOR_OU_NAME" dataFld="dpdn_apv">
<input type="hidden" id="dField" name="INITIATOR_OU_ID" dataFld="dpid_apv">
<input type="hidden" id="cField" name="LAST_MODIFIER_ID"> 
<input type="hidden" id="cField" name="attach">
<input type="hidden" id="cField" name="filelocation" dataFld="fmfl">
<input type="hidden" id="cField" name="ATTACH_FILE" value="">
<input type="hidden" id="dField" name="ATTACH_FILE_INFO" value="" dataFld="ATTACH_FILE_INFO">
<input type="hidden" id="dField" name="INITIATOR_INFO" value="" dataFld="INITIATOR_INFO">
<input type="hidden" id="dField" name="APPLIED" dataFld="APPLIED">										
<input type="hidden" id="dField" name="ISPUBLIC" dataFld="ISPUBLIC">
<input type="hidden" id="dField" name="APPLIED_TERM" dataFld="APPLIED_TERM">
<input type="hidden" id="dField" name="RECEIVE_NO" dataFld="RECEIVE_NO">
<input type="hidden" id="dField" name="RECEIVE_NAMES" dataFld="RECEIVE_NAMES">
<input type="hidden" id="dField" name="RECEIPT_LIST" dataFld="RECEIPT_LIST">
<!--<input type="hidden" id="dField" name="DOC_LEVEL"  dataFld="DOC_LEVEL">
<input type="hidden" id="dField" name="SAVE_TERM"  dataFld="SAVE_TERM">-->
<input type="hidden" id="dField" name="DOC_CLASS_ID" dataFld="DOC_CLASS_ID">
<!--<input type="hidden" id="dField" name="SUBJECT" dataFld="SUBJECT">-->
<input type="hidden" id="dField" name="DOC_NO" dataFld="DOC_NO">
<input type="hidden" id="dField" name="DOC_OU_NAME" dataFld="dpdsn">
<input type="hidden" id="dField" name="ENT_CODE" dataFld="etid">
<input type="hidden" id="dField" name="ENT_NAME" dataFld="etnm"><input type="hidden" id="mField" name="DOC_LEVEL_NAME" />

<textarea  id="dField" name="DOC_SUMMARY" dataFld="DOC_SUMMARY" style="display:none"></textarea>
<textarea id="dhtml_body" style="display:none"></textarea>
<textarea style="display:none" id="cField" name="xsl"></textarea> 

<!-- 문서link 2006.01 -->
<textarea id="dField" name="DOCLINKS" style="display:none"  dataFld="DOCLINKS"></textarea>
<!-- 반송문서 추가 시작 2007.11-->
<textarea id="mField" name="REJECTDOCLINKS" style="display:none"></textarea>
<!-- 반송문서 추가 끝 2007.11-->
<!-- 결재선 관리 UI 변경 2008.01 -->
<textarea style="display:none;" id="cField" name="APVLIST"></textarea> 
<!-- 결재선 관리 UI 변경 끝 2008.01 --><!-- END -->
<!-- 양식전체본문 -->
<div id="bodytable">
	<!-- header start -->
	<div class="draft_tit"><h4><span id="headname"></span><a href="#"><span class="drop_menu"></span></a></h4></div>
    <div class="draft_page">
		<table width="100%" cellpadding="0" cellspacing="0">
        <!-- 결재선 정보 시작-->
        <!-- 일반결재/합의 -->
            <tr>
                <td id="AppLine" width="100%">
                    <table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0" bordercolordark="white" bordercolorlight="gray">
                        <tr>
                        <!-- 발신처 결재란 보이는 부분(왼쪽) -->
                            <td id="LApvLine" align="left" width="50%"></td>
                        <!-- 수신처 결재란 보이는부분 (오른쪽)-->
                            <td id="RApvLine" align="right" width="50%"></td>
                        </tr>
                    </table>
                </td>
            </tr>
            <!-- 협조자 -->
            <tr>
                <td id="AssistLine" width="100%" style="display:none;"></td>
            </tr>
            <!--참조자 -- 첨부파일 영역으로 옮김 -->
            <!--수신자 -->
            <tr>
                <td id="RRLine" width="100%" style="display:none;"></td>
            </tr>			
        <!-- 결재선 정보 종료-->
        </table>
        <table class="table_2" summary="문서분류" cellpadding="0" cellspacing="0">		    
            <tr>
                <th>보안등급</th>
                <td><select id="dField" name="DOC_LEVEL" onchange="DOC_LEVEL_Change(this);"></select></td>	
                <th>보존년한</th>
                <td colspan="3"><select id="dField" name="SAVE_TERM"></select></td>	
            </tr>
            <tr>
                <th>문서분류</th>
                <td>
                    <input type="text" id="dField" name="DOC_CLASS_NAME" dataFld="DOC_CLASS_NAME" size="20" readonly="readonly" style="width:70%;height:20px;" />&nbsp;
                    <img src="/GWImages/Common/btn/btn_organization.gif" name="btn_Process" id="btn_Process" align="absMiddle" border="0" onClick="OpenDocClass();" style="cursor:hand" />
                </td>	
                <th>문서번호</th><td></td>	                	
            </tr>                   
            <tr id="workrequestdisplay" style="display:;">
                <th>관련업무의뢰</th>
                <td colspan="3">
                    <input type="hidden" id="mField" name="WORKREQUEST_ID" />
                    <input type="text" id="mField" name="WORKREQUEST_NAME" size="20" readonly="readonly" style="height:20px" />&nbsp;
                    <a href="#" class="Btn02" onClick="javascript:OpenWorkRequest();"><span>추가</span></a> 
                    <a href="#" class="Btn02" onClick="javascript:DelWorkRequest();"><span>삭제</span></a>
                </td>
            </tr>			
	    </table>	
	    <!-- header end -->
        <!-- bodycontext start -->
        <table class="table_3" summary="내용" cellpadding="0" cellspacing="0">
            <tr>
                <th>제&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;목<span class="txt_red">*</span></th>
                <td colspan="3"><input id="dField" name="SUBJECT" datafld="SUBJECT" style="width:100%; height:20px;" /></td>	
            </tr>
		    <!--실 결재양식 내용 부분 시작 -->
		    <tr>
				<th colspan="4">신청자 정보</th>				
			</tr>
			<tr>
				<th>신청자</th>
				<td>&nbsp;&nbsp;<input type="text" id="mField"  name="EMPLOYEE_NAME" dataFld="usdn" readonly style="height:22px;">
				    <img src="/GWImages/Common/btn/btn_organization.gif" name="btnRequest" id="Img2" class="Out" align="absmiddle" border="0" onclick="addList();" style="display:;cursor:hand;" />
				</td>
				<th>부서</th>
				<td>&nbsp;
					<input type="text" id="mField"  name="EMPLOYEE_OU_NAME" dataFld="dpdn" style='width:90%; border:0px solid #C0C0C0;'  readonly />
					<input type="hidden" id="mField"  name="EMPLOYEE_OU_ID" dataFld="dpid" CLASS='INPUTTEXT' />
					<input type="hidden" id="mField"  name="EMPLOYEE_COST_CENTER" dataFld="uscc" CLASS='INPUTTEXT' /></td>
			</tr>
			<tr>
				<th>직위</th>
				<td>&nbsp;&nbsp;<input type="text" id="mField"  name="EMPLOYEE_INFO" dataFld="uspn" style='width:90%; border:0px solid #C0C0C0;' readonly></td>
				<th>신청일</th>
				<td>&nbsp;&nbsp;<span id="initiated2"></span></td>
			</tr>
			<tr>
				<th>전화번호</th>
				<td>&nbsp;
					<input type="text" id="mField"  name='EMPLOYEE_TEL' dataFld='ustp' style='width:90%; border:1px solid #C0C0C0;height:22px;' maxlength="15">
				</td>
				<th>휴대전화번호</th>
				<td>&nbsp;
					<input type="text" id="mField"  name='EMPLOYEE_MOBILE_TEL' dataFld='usmt' style='width:90%; border:1px solid #C0C0C0;height:22px;'  maxlength="15">
				</td>
			</tr>
			<tr>
				<th>이메일</th>
				<td>&nbsp;
					<input type="text" id="mField"  name='EMPLOYEE_EMAIL' dataFld='usem'  style='width:90%; border:1px solid #C0C0C0;height:22px;'  maxlength="50">
				</td>
				<th>지역</th>
				<td>
					<input type="hidden" id="mField"  name='COMCODE' dataFld="etid"  style='width:90%; border:1px solid #C0C0C0;height:22px;' maxlength="15">&nbsp;
					<SELECT ID="mField" name="REGION" style="width:90%;height:25px;"></SELECT>
				</td>
			</tr>
			<tr>
				<th colspan="4">신청내용</th>
			</tr>
			<tr>
			    <th>신청업무</th>
			    <td>&nbsp;&nbsp;
			        <SELECT ID="mField" name="REQDUTY" style="width:90%" onchange="ReturnData(2,this.value);"></SELECT>
			    </td>
			    <th>세부업무</th>
			    <td>&nbsp;&nbsp;
			        <SELECT ID="mField" name="REQDUTYSUB" style="width:90%"></SELECT>
			    </td>
			</tr>
			<tr>
				<th>완료희망일</th>
				<td colspan='3'>&nbsp;&nbsp;
					<input type="text" id="mField" name='HOPED' style='border:1px solid #C0C0C0;height:22px;'  datepicker="true" datepicker_format="YYYY-MM-DD" readonly>
					<!--<img src="/GWImages/Common/icon/icon_calendar.gif" name="btnSdate" id="Img3" class="Out" align="absmiddle" border="0" onclick="MiniCal(HOPED,-200,0);" style="cursor:hand;">-->
				</td>
			</tr>
			<tr>
			    <th>내용</th>
			    <td colspan="3">
			        <span class="txt_red">*PC A/S 신청 방법 : 업무도우미 - 전산지원 -  개인 PC 현황에서 신청해주세요. </span><br />
			        <span class="txt_red">*개인 IT 자산현황 자료가 없는 경우에는  IT 자산 담당자에게 문의 부탁드립니다. </span><br />
			        <textarea id="mField" rows="6" name="REMARK"  wrap="hard" style="font-size:9pt;border:1px solid #C0C0C0; width:97%; padding-left:4; padding-right:4; padding-top:3; padding-bottom:0; overflow-x:hidden; overflow-y:auto;" ></textarea><br />&nbsp;
			    </td>
			</tr>
			<tr>
				<th colspan="4">담당자</th>
			</tr>
			<tr>
				<th>검토의견</th>
				<td colspan='3'>
					<textarea id="mField" rows="8"  name="COMMENT" readonly wrap="hard" style="font-size:9pt;border:0px solid #C0C0C0; padding-left:4; padding-right:4; padding-top:3; padding-bottom:0; overflow-x:hidden; overflow-y:auto;"></textarea>
				</td>
			</tr>
		    <!--실 결재양식 내용 부분 끝 -->
	    </table>
		<!-- bodycontext end -->
		<table class="table_5" summary="참조" cellpadding="0" cellspacing="0">
            <tr>
                <th>참조</th>
                <td  id="CCLine">
                    <div id="SendCC"></div>
                    <div id="RecCC"></div>&nbsp;
                </td>
            </tr>
            <tr>
                <th>첨부파일</th>
                <td id="AttFileInfo"></td>
            </tr>
            <tr>
                <th>연결문서</th>
                <td id="DocLinkInfo"></td>
            </tr>
            <tr>
                <th>원 문 서</th>
                <td id="RejectDocLinkInfo">-</td>
            </tr>
            <!-- 프로세스 메뉴얼 연결 추가 시작 2008.01-->
            <tr id="trPMLinkInfo" style="display:none;">
	            <th>관련 프로세스 메뉴얼</th>
                <td id="PMLinkInfo"></td>
            </tr>
        </table>
        <div id="divforminfo"  style="display:none">
        <table class="table_6" summary="원문서" cellpadding="0" cellspacing="0">
            <tr>
                <th>문서설명</th>
                <td id="tdforminfo"></td>
            </tr>
        </table>
        </div>
        <!--write_의견입력-->
        <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%">
            <tr>
                <td align="center" id="tdCommentView"  width="100%" style="display:none;">				
                </td>
            </tr>
        </table>
        <!--write_ 의견입력끝 -->	
    </div>  
</div> 
       <script language="javascript" src="formedit_object.js" type="text/javascript"></script>    

<script type="text/javascript">
function window.onload(){
    Region(getInfo("etid"));	
    ReturnData(1,1);			
	initialize();
}

function initialize(){
	if(window.parent.document.readyState == "complete"){
		window.parent.document.onreadystatechange = event_noop;	
		//initENTPART();//사업장 코드 조회		
		initForm();
		initApvList();
//		if(document.tbContentElement.ActiveTab >0)
//		 {
//				window.setTimeout(setTagFreeBug,500);
//		 }
	}else{
		window.setTimeout(initialize,500);
	}				
}

function initForm(){
	// window.top.resizeTo(800,720);
	initFields();
	G_displaySpnAttInfo(false);
	//if(getInfo("pdefname").indexOf("ApprovalSystem-Draft") != -1) {parent.menu.recedit.style.display="none";}
}
function initFields(szBody){
	setFields(dField);//editable field
	setFields(cField); //readonly field

	headname.innerHTML = initheadname(getInfo("fmnm"), true);
	if (getInfo("mode") == "DRAFT" || getInfo("mode") == "TEMPSAVE" ){		
		INITIATOR_INFO.value = getInfo("usdn");//getInfo("dpdn_apv")+" "+getInfo("usdn") + " "+ getInfo("ustn") ;
		EMPLOYEE_NAME.value = m_oFormMenu.getLngLabel(getInfo("usdn"),false);	//신청자
		EMPLOYEE_OU_NAME.value = m_oFormMenu.getLngLabel(getInfo("dpdn"),false);	//부서명
		EMPLOYEE_EMAIL.value = getInfo("usem");	//이메일
		APPLIED.value = formatDate(getInfo("svdt"),"D");
		initiated2.innerHTML = formatDate(getInfo("svdt"),"R");		
	}else{
	    SUBJECT.disabled = true;
	}
	//기타 필드 채우기	
	setSaveTerm(); //보존년한 create	
	setDocLevel();  // 보안등급 create

	//본문 내용 
	if (getInfo("BODY_CONTEXT") != undefined){	
		setBodyContext(getInfo("BODY_CONTEXT"));
	}else{
	}
}
function getBodyContext(){
	//dhtml_body.value = tbContentElement.HtmlValue;	
    //본문 내용 및 기타 계산 필드 넘기기, 현재 본문내용만 넘김
	//UpdateImageData(); //이미지 업로드
	var sBodyContext = makeBodyContext();
	return makeNode("BODY_CONTEXT",sBodyContext,null,false);
}

function setFields(Fields){
	for(var i=0;i<Fields.length;i++){
		var fld = Fields[i];
		if(fld.dataFld!=""){(getInfo(fld.name)!=undefined)? fld.value=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.value=getInfo(fld.dataFld):fld.value='';}
		if(fld.name == 'POSITION' && getInfo(fld.name) == ""){
			fld.value = getInfo(fld.dataFld);
		}

	}
}
function checkForm(bTempSave){
	if (bTempSave){
		return true;
	}else{
		if(SUBJECT.value == '' ){
			alert('제목을 입력하세요.');
			//SUBJECT.focus();
			return false;
		}else if(SAVE_TERM.value == ''){
			alert('보존년한을 선택하세요.');
			return false;
		}else if (EMPLOYEE_MOBILE_TEL.value == ''){
		    alert("MOBILE번호를 입력하세요");
		    return false;
	    }else if (EMPLOYEE_EMAIL.value == ''){
		    alert("이메일을 입력하세요");
		    return false;
	    }else if (SUBJECT.value == ''){
		    alert("제목 입력하세요");
		    return false;
	    }else if (HOPED.value == ''){
		    alert("완료희망일 입력하세요");
		    return false;
	    }else if (REMARK.value == ''){
		    alert("내용을 입력하세요");
		    return false;
		}else{
			return true;
		}
	}
}

//function setBodyContext(sBodyContext){
//	//본문 채우기
//	var m_objXML=new ActiveXObject("MSXML2.DOMDocument");
//	var elmList, elm;
//	var elmListLan;
//	
//	m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>"+getInfo("BODY_CONTEXT"));
//	try{
//		elmList = m_objXML.documentElement.childNodes;
//		for(var i=0; i < elmList.length; i++){
//			var elm = elmList.item(i);
//			innerHtmlData(elm.nodeName, elm.text);
//		}
//		//본문 채우기
//		setdField();
//	}
//	catch(e){ }
//}
function setBodyContext(sBodyContext){
	//본문내용 display - 일반 display
	var m_objXML = new ActiveXObject("MSXML2.DOMDocument");
	var elmList, elm;
	var elmListLan;
	m_objXML.loadXML("<root>"+getInfo("BODY_CONTEXT")+"</root>");
	//m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>"+getInfo("BODY_CONTEXT"));
	try{
		elmList = m_objXML.documentElement.childNodes;
		for(var i=0; i<elmList.length; i++){
			var elm = elmList.nextNode();
			if(elm.nodeName.indexOf("OPT") != -1){
				setRadio(elm.nodeName, elm.text);
			}else{
				if(elm.nodeName =="REQDUTY"){
					ReturnData(2,elm.text);
				}else if(elm.nodeName == "COMCODE"){
					Region(elm.text)
				}
				eval(elm.nodeName).value = elm.text;
			}
		}
	}catch(e){
	}
}
//본문 XML로 구성
//function makeBodyContext(){
//	var sBodyContext="";	
//	//xml 구성 예제 : <body><item><name></name></item><item><name></name></item></body>
//	//sBodyContext="<body><item><name>첫번째</name></item><item><name>두번째</name></item></body>";
//	
//	//sBodyContext = "<BODY_CONTEXT>" +  "<tbContentElement><![CDATA[" + dhtml_body.value +  "]]></tbContentElement>" + getFields(mField) + "</BODY_CONTEXT>";	
//	return sBodyContext;
//}
function makeBodyContext(){
	var szBodyContext="";	
	//szBodyContext="<body><item><name>첫번째</name></item><item><name>두번째</name></item></body>";
	//sBodyContext = "<BODY_CONTEXT>" + getFields(mField) + getInfo('fmbd') + "</BODY_CONTEXT>";
	szBodyContext = "<BODY_CONTEXT>" + getFields(mField);// +getFields(nField) ;
	//szBodyContext+= getRadio("OPTFLAG");
	//szBodyContext+= makeNode("DOC_LEVEL",DOC_LEVEL.options[DOC_LEVEL.selectedIndex].text);
	szBodyContext+= makeNode("REGDUTYNAME",mField["REQDUTY"].options[REQDUTY.selectedIndex].text);
	szBodyContext+= makeNode("REGDUTYSUBNAME",mField["REQDUTYSUB"].options[REQDUTYSUB.selectedIndex].text);
	szBodyContext+= makeNode("REGION_NAME",mField["REGION"].options[REGION.selectedIndex].text) + "</BODY_CONTEXT>";

	return szBodyContext;
}
/*** form data -> xml ***/
function getFields(Fields){
	var sText = "";
	for(var i=0;i<Fields.length;i++){
	    if (Fields[i].name.indexOf("SEL_") > -1){
    		sText += getSelRadio(Fields[i].name);
	    }else{
    		sText += makeNode(Fields[i].name, Fields[i].value);
	    } 
	}
	return sText;
}	

/*** Radio Button 값 가져오기***/
function getRadio(radioNm){	
	var radioVal = "";
	//alert("이름:"+radioNm+"\n객체여부:"+eval(radioNm)+"\n길이:"+eval(radioNm).length+"\n체크여부:"+eval(radioNm).checked);
	for(i=0;i<eval(radioNm).length;i++){				
		if(eval(radioNm)[i].checked){
			radioVal = makeNode(radioNm, eval(radioNm)[i].value);
		}
	}
	return radioVal;
}

/*** Single Radio Button Value 가져오기 ***/
function getChkRadio(radioNm){
	if(eval(radioNm).checked){
		radioVal = makeNode(radioNm, eval(radioNm).value);
		return radioVal;
	}
}
/** SELECT BOX VALUE 가져오기 **/
function getSelRadio(selNm){
	var radioVal = "";
    if ( eval(selNm).selectedIndex > -1 ){
        radioVal += makeNode(selNm+"_TEXT", eval(selNm).options[eval(selNm).selectedIndex].text);
    }else{
        radioVal += makeNode(selNm+"_TEXT", "");
    }
    return   radioVal  
}
/*** 데이터 뿌려주기 ***/
function innerHtmlData(nodeNm, nodeVal){
	if (document.all[nodeNm] != undefined) {
		if (nodeNm.indexOf("FORM_ATTACH") != -1) {
			setForm_Attach(nodeVal);
			eval(nodeNm).value = nodeVal;
		} 
//		else if (nodeNm.indexOf("tbContentElement") != -1) {
//			var dom = tbContentElement.getDom();	dom.body.innerHTML= nodeVal.replace(/<BR>/gi,"");
//		} 
		else if(nodeNm.indexOf("OPT") != -1) {
			setRadio(nodeNm, nodeVal);
		} else if(nodeNm.indexOf("CHK") != -1) {
			setChk(nodeNm, nodeVal);
		} else if(nodeNm.indexOf("JEONKEUL") != -1) {
		    spnJEONKEUL.innerHTML = nodeVal;
		} else {
			eval(nodeNm).value = nodeVal;
		}
	}
}

/*** 라디오 버튼 value display ***/
function setRadio(szname, szvalue){	
	var objrdo = eval(szname);
	for(i=0;i<objrdo.length;i++){	
		if(objrdo[i].value == szvalue) objrdo[i].checked = true;
	}
}

/*** single 라디오 버튼 value display ***/
function setChk(szname, szvalue){	
	var objrdo = eval(szname);
	if(objrdo.value == szvalue) objrdo.checked = true;
}
//사용자 선택 Modal창
	function addList(){
		var rgParams=null;
		rgParams=new Array();
		rgParams["bMail"]  = false;
		rgParams["bUser"] = true;
		rgParams["bGroup"] =false;
		rgParams["bRef"] = false;
		rgParams["bIns"] = false; 
		rgParams["bRecp"] = false; 
		rgParams["bViewAll"] = true; //전체조회여부
		rgParams["sCatSignType"] = "수신결재"; 
		rgParams["sDeptSignType"] = "일반결재";
		rgParams["sDeptSignStatus"] = "수신"; 
		rgParams["sUserSignType"] = "일반결재";
		rgParams["sUserSignStatus"] = "대기"; 
		rgParams["objMessage"] = window;

		var szFont = "FONT-FAMILY: '굴림';font-size:9px;";
        var nWidth = 640;
        var nHeight = 610;
        var sFeature = szFont+"dialogHeight:"+nHeight+"px;dialogWidth:"+nWidth+"px;status:no;resizable:yes;help:no;";
        var strNewFearture = ModifyDialogFeature(sFeature);
        var vRetval = window.showModelessDialog("/COVIWeb/approval/address/address.aspx", rgParams, strNewFearture);
        //var vRetval = window.showModelessDialog("/CoviWeb/Approval/Address/address.aspx", rgParams, szFont+"dialogHeight:"+nHeight+"px;dialogWidth:"+nWidth+"px;status:no;resizable:yes;help:no;");
	}
	//선택된사용자 화면에 보여주기
	function insertToList(oList){
		var m_oChargeList = new ActiveXObject("MSXML2.DOMDocument");
		m_oChargeList.loadXML("<?xml version='1.0' encoding='utf-8'?>"+oList.xml);
		
		//alert(oList.xml);

		var elmRoot = m_oChargeList.documentElement;
		var elmlist = elmRoot.selectNodes("item");
		var elm;
		if (elmlist.length > 1 ){alert('신청자는 1명만 입력가능합니다');return;}
		for(var i=0; i< elmlist.length; i++){
			elm = elmlist.nextNode();
			try{
				EMPLOYEE_NAME.value = m_oFormMenu.getLngLabel(elm.selectSingleNode("DN").text,false);		//신청자
			    //EMPLOYEE_NUM.value = elm.selectSingleNode("USEC").text;			//사번
			    //EMPLOYEE_ID.value = elm.selectSingleNode("AN").text;			//아이디
			    EMPLOYEE_INFO.value = m_oFormMenu.getLngLabel(elm.selectSingleNode("PO").text,false);	//직위
			    EMPLOYEE_OU_NAME.value = m_oFormMenu.getLngLabel(elm.selectSingleNode("DP").text,false);	//부서명
			    EMPLOYEE_OU_ID.value = elm.selectSingleNode("RG").text;	//부서코드
			    //JOIN_COM_DATE.value = elm.selectSingleNode("JDT").text;		//입사일
			    //EMPLOYEE_COST_CENTER.value = elm.selectSingleNode("USCC").text;		//코스트센터
			    EMPLOYEE_EMAIL.value  = elm.selectSingleNode("EM").text;		//이메일
			    EMPLOYEE_TEL.value  = elm.selectSingleNode("OT").text;		//전화번호
			    EMPLOYEE_MOBILE_TEL.value  = elm.selectSingleNode("MT").text;		//휴대전화번호
			    COMCODE.value = elm.selectSingleNode("CY").text;//elm.selectSingleNode("ETID").text;				//회사코드
			    Region(COMCODE.value);
			    REGION.value = elm.selectSingleNode("USRC").text;	
			}catch(e){}
		}
	}
function Region(Val){
	//var szURL = "/COVILegacy/Query/VarQuery.aspx";
	var szURL = "VarQuery.aspx";
	var query = "SELECT REGION_CODE,NAME FROM COVI_GROUPWARE.dbo.ORG_REGION WHERE ENT_CODE='"+ Val +"'"
	var querystring = "COVI_GROUPWARE";
	var sText = "<request><query><![CDATA[" + query + "]]></query><querystring><![CDATA[" + querystring + "]]></querystring></request>";
	requestHTTP("POST",szURL,false,"text/xml",receiveGETHTTP, sText);
}
//신청업무 및 세부항목검색
function ReturnData(num,code){
	//var szURL = "/COVILegacy/Query/VarQuery.aspx";
	var szURL = "VarQuery.aspx";
	if(num == "1"){
		var query = "SELECT UID,NAME FROM COVI_FLOW_SI.dbo.JW_IT_BIZ WHERE P_SIGN='Y'";//WHERE UID<>'1'"
	}else{
		var query = "SELECT SUB_ID,NAME FROM COVI_FLOW_SI.dbo.JW_IT_SUB_BIZ WHERE PARENT_UID='"+code+"' AND NAME <> 'PCAS'";
	}
	var querystring = "COVI_FLOW_SI";
	var sText = "<request><query><![CDATA[" + query + "]]></query><querystring><![CDATA[" + querystring + "]]></querystring></request>";
	if(num == "1"){
		requestHTTP("POST",szURL,false,"text/xml",receiveGETHTTP1, sText);
	}else{
		requestHTTP("POST",szURL,false,"text/xml",receiveGETHTTP2, sText);
	}
}
function requestHTTP(sMethod,sUrl,bAsync,sCType,pCallback,vBody){
	m_xmlHTTP.open(sMethod,sUrl,bAsync);
	m_xmlHTTP.setRequestHeader("Accept-Language","ko");
	m_xmlHTTP.setRequestHeader("Content-type", sCType);
	if(pCallback!=null)m_xmlHTTP.onreadystatechange = pCallback;
	(vBody!=null)?m_xmlHTTP.send(vBody):m_xmlHTTP.send();
}
function receiveGETHTTP(){
	if(m_xmlHTTP.readyState==4){
		m_xmlHTTP.onreadystatechange=event_noop;
		if(m_xmlHTTP.responseText.charAt(0)=="\r"){
			alert(m_xmlHTTP.responseText);
		}else{
			var errorNode = m_xmlHTTP.responseXML.selectSingleNode("//response/error");
			if(errorNode != null){
				alert("Desc: " + errorNode.text);
			}else{
				try{
				//alert("text: "+m_xmlHTTP.responsetext);
					var elmList = m_xmlHTTP.responseXML.selectNodes("//response/NewDataSet/Table");
					var optObjlen = REGION.length;
					for (var j=0;j<optObjlen; j++){
						REGION.options.remove(0)
					}
				    for (var i=0; i<elmList.length; i++){
					    var oOption = document.createElement("OPTION");
					    REGION.options.add(oOption);
					    oOption.innerText=elmList.item(i).selectSingleNode("NAME").text;
					    oOption.value=elmList.item(i).selectSingleNode("REGION_CODE").text;
					}
				}catch(e){alert("Error : " + e.description + "\r\nError number: " + e.number);}
			}
		}
	}
}
function receiveGETHTTP1(){
	if(m_xmlHTTP.readyState==4){
		m_xmlHTTP.onreadystatechange=event_noop;
		if(m_xmlHTTP.responseText.charAt(0)=="\r"){
			alert(m_xmlHTTP.responseText);
		}else{
			var errorNode = m_xmlHTTP.responseXML.selectSingleNode("//response/error");
			if(errorNode != null){
				alert("Desc: " + errorNode.text);
			}else{
				try{
				//alert("text: "+m_xmlHTTP.responsetext);
					var elmList = m_xmlHTTP.responseXML.selectNodes("//response/NewDataSet/Table");
					for (var i=0; i<elmList.length; i++){
						var oOption = document.createElement("OPTION");
						REQDUTY.options.add(oOption);
						oOption.innerText=elmList.item(i).selectSingleNode("NAME").text;
						oOption.value=elmList.item(i).selectSingleNode("UID").text;
						if(getInfo("loct")=="DRAFT" && i==0){
							ReturnData(2,elmList.item(i).selectSingleNode("UID").text)
						}
					}
				}catch(e){alert("Error : " + e.description + "\r\nError number: " + e.number);}
			}
		}
	}
}
function receiveGETHTTP2(){
	if(m_xmlHTTP.readyState==4){
		m_xmlHTTP.onreadystatechange=event_noop;
		if(m_xmlHTTP.responseText.charAt(0)=="\r"){
			alert(m_xmlHTTP.responseText);
		}else{
			var errorNode = m_xmlHTTP.responseXML.selectSingleNode("//response/error");
			if(errorNode != null){
				alert("Desc: " + errorNode.text);
			}else{
				try{
				//alert("text: "+m_xmlHTTP.responsetext);
					var elmList = m_xmlHTTP.responseXML.selectNodes("//response/NewDataSet/Table");
					var optObjlen = REQDUTYSUB.length;
					for (var j=0;j<optObjlen; j++){
						REQDUTYSUB.options.remove(0)
					}
					for (var i=0; i<elmList.length; i++){
						var oOption = document.createElement("OPTION");
						REQDUTYSUB.options.add(oOption);
						oOption.innerText=elmList.item(i).selectSingleNode("NAME").text;
						oOption.value=elmList.item(i).selectSingleNode("SUB_ID").text;
					}
				}catch(e){alert("Error : " + e.description + "\r\nError number: " + e.number);}
			}
		}
	}
}
</script>
<!-- 태그프리 추가-->
<!--<script language="JScript" FOR="tbContentElement" EVENT="OnControlInit">
   //본문 내용 
   if (getInfo("BODY_CONTEXT") != undefined){     //기안,임시저장으로 저장된 값 setting
        /*
       var m_objXML = new ActiveXObject("MSXML2.DOMDocument");
       m_objXML.loadXML("<root>"+getInfo("BODY_CONTEXT")+"</root>");

       try{tbContentElement.HtmlValue = m_objXML.documentElement.selectSingleNode("TagFree").text;}catch(e){}
       */
       setBodyContext(getInfo("BODY_CONTEXT"));
       try{G_displaySpnDocLinkInfo();}catch(e){}

   }else {//양식 생성 시 입력한 본문내역 조회            
        if (getInfo("fmbd") != "undefined")
        {
         try{var dom = tbContentElement.getDom();	dom.body.innerHTML= getInfo("fmbd");}catch(e){}
        }
   }     

</script>-->
</body>
</html>
