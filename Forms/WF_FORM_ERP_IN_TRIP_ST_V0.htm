<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Pragma" content="no-cache" />
	<title></title>	
	<link rel="stylesheet" href="/GWImages/common/css/approval_form.css" type="text/css" />
    <style type="text/css">
        a.a1 {color:#FF8C00; text-decoration:underline}
        a.a2 {color:#FF8C00;}
        td.tH1 {BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: #D5D5D5 1px solid}
    </style>
    <!--필수 양식파일에 쓰이는 js 파일-->
	<script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Config.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/EmbedObject.js" ></script>
    <script type="text/javascript" language="javascript" src="/CoviWeb/SiteReference/js/Utility.js" ></script>
    <script type="text/javascript" language="javascript" src="../../Common/script/COVIFlowNet/openWindow.js" ></script>		
	<script type="text/javascript" language="javascript" src="../../Common/script/progress.js" ></script>
	<script type="text/javascript" language="javascript" src="../../common/script/NameControl.js"></script>
	<script type="text/javascript" language="javascript" src="../../common/script/jquery-1.6.1.min.js"></script>
	<script type="text/javascript" language="javascript" src="formedit.js" ></script>
	<script type="text/javascript" language="javascript" src="formedit_apvlinemgr.js" ></script>
    <!-- 캘린더 관련 시작 -->
    <link rel="stylesheet" href="/CoviWeb/SiteReference/Jcalendar/themes/base/jquery.ui.all.css"/>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/jquery-1.8.2.js"></script>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/JqueryDatePicker.js"></script>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/ui/jquery.ui.core.js"></script>
    <script type="text/javascript" language="javascript"  src="/CoviWeb/SiteReference/Jcalendar/ui/jquery.ui.datepicker.js"></script>
    <!-- 캘린더 관련 종료 -->
</head>

<body topmargin="0" leftmargin="0" style="OVERFLOW: auto; overflow-x: hidden;" >
<!-- COMMON FIELDS -->
<input type="hidden" id="dField" name="INITIATOR_NAME" dataFld="usdn" />
<input type="hidden" id="dField" name="INITIATOR_ID" dataFld="usid" />
<input type="hidden" id="dField" name="INITIATOR_OU_NAME" dataFld="dpdn_apv" />
<input type="hidden" id="dField" name="INITIATOR_OU_ID" dataFld="dpid_apv" />
<input type="hidden" id="cField" name="LAST_MODIFIER_ID" /> 
<input type="hidden" id="cField" name="attach" />
<input type="hidden" id="cField" name="filelocation" dataFld="fmfl" />
<input type="hidden" id="cField" name="ATTACH_FILE" value="" />
<input type="hidden" id="dField" name="ATTACH_FILE_INFO" value="" dataFld="ATTACH_FILE_INFO" />
<input type="hidden" id="dField" name="INITIATOR_INFO" value="" dataFld="INITIATOR_INFO" />
<input type="hidden" id="dField" name="APPLIED" dataFld="APPLIED" />										
<input type="hidden" id="dField" name="ISPUBLIC" dataFld="ISPUBLIC" />
<input type="hidden" id="dField" name="APPLIED_TERM" dataFld="APPLIED_TERM" />
<input type="hidden" id="dField" name="RECEIVE_NO" dataFld="RECEIVE_NO" />
<input type="hidden" id="dField" name="RECEIVE_NAMES" dataFld="RECEIVE_NAMES" />
<input type="hidden" id="dField" name="RECEIPT_LIST" dataFld="RECEIPT_LIST" />
<!--<input type="hidden" id="dField" name="DOC_LEVEL"  dataFld="DOC_LEVEL">
<input type="hidden" id="dField" name="SAVE_TERM"  dataFld="SAVE_TERM">-->
<input type="hidden" id="dField" name="DOC_CLASS_ID" dataFld="DOC_CLASS_ID" />
<!--<input type="hidden" id="dField" name="SUBJECT" dataFld="SUBJECT" />-->
<input type="hidden" id="dField" name="DOC_NO" dataFld="DOC_NO" />
<input type="hidden" id="dField" name="DOC_OU_NAME" dataFld="dpdsn" />
<input type="hidden" id="dField" name="ENT_CODE" dataFld="etid" />
<input type="hidden" id="dField" name="ENT_NAME" dataFld="etnm" />
<input type="hidden" id="mField" name="DOC_LEVEL_NAME" />

<textarea  id="dField" name="DOC_SUMMARY" dataFld="DOC_SUMMARY" style="display:none"></textarea>
<textarea id="dhtml_body" style="display:none"></textarea>
<textarea style="display:none" id="cField" name="xsl"></textarea> 

<!-- 문서link 2006.01 -->
<textarea id="dField" name="DOCLINKS" style="display:none"  dataFld="DOCLINKS"></textarea>
<!-- 반송문서 추가 시작 2007.11-->
<textarea id="mField" name="REJECTDOCLINKS" style="display:none"></textarea>
<!-- 반송문서 추가 끝 2007.11-->
<!-- 결재선 관리 UI 변경 2008.01 -->
<textarea style="display:none;" id="cField" name="APVLIST"></textarea> 
<!-- 결재선 관리 UI 변경 끝 2008.01 -->
<!-- process 메뉴얼 추가 2008.01 -->
<textarea id="mField" name="PMLINKS" style="display:none"></textarea>
<!-- process 메뉴얼 추가 2008.01 -->
<!-- END -->

<!-- 양식전체본문 -->
<div id="bodytable">
    <!-- header start -->
    <div class="draft_tit"><h4><span id="headname"></span><a href="#"><span class="drop_menu"></span></a></h4></div>
    <div class="draft_page">

        <!--######## 양식상단부분 공통 시작 #################################-->
        <table class="table_2" summary="문서분류" cellpadding="0" cellspacing="0">
            <tr style="display:none;">
                <th>보안등급</th>
                <td><select id="dField" name="DOC_LEVEL" onchange="DOC_LEVEL_Change(this);"></select></td>	
                <th>문서번호</th><td width="100px"></td>		
            </tr>
            <tr>
                <th>문서분류</th>
                <td>
                    <input type="text" id="dField" name="DOC_CLASS_NAME" dataFld="DOC_CLASS_NAME" size="20" readonly="readonly" style="width:70%; width:70%; height:20px;" />&nbsp;
                    <img src="/GWImages/Common/btn/btn_organization.gif" name="btn_Process" id="btn_Process" align="absMiddle" border="0" onClick="OpenDocClass();" style="cursor:hand" />
                </td>	
                <th>보존년한</th>
                <td colspan="3"><select id="dField" name="SAVE_TERM"></select></td>		
            </tr>
        </table>	
        <!-- header end -->
        <!-- bodycontext start -->		
        <table class="table_3" summary="제목" cellpadding="0" cellspacing="0">
            <tr>
                <th>제&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;목<span class="txt_red">*</span></th>
                <td colspan="3"><input id="dField" name="SUBJECT" datafld="SUBJECT" onkeyup="SetSubjectTbxSync();" style="width:100%; height:20px;" /></td>	
            </tr>            
        </table>
        <!--######## 양식상단부분 공통 종료 #################################-->
        
        <!--######## 본문부분 시작 #########################################-->
        <div id="divBodyContent">  <!--추가(인쇄용) HIW-->
        <table border="0" width="100%">
            <tr>
                <td align="center" style="padding-top:15px; padding-bottom:15px;">다음과 같이 출장 계획서를 제출하오니, 출장을 승인하여 주시기 바랍니다.</td>
            </tr>
        </table>
        
        <table class="table_html" id="tblBodyContent" summary="내용" cellpadding="0" cellspacing="0">
           <!--
            <tr>
                <td rowspan="5" align="center" style="width:40px; font-weight:bold; background-color:#F6F6F6">출<br/>장<br/>부<br/>서<br/>작<br/>성<br/>란<br/><a class="a2" href="javascript:AddRowDataPerson();"><b>[+]</b></a><br /><a class="a2" href="javascript:DelRowDataPerson();"><b>[-]</b></a></td>
                <td colspan="4" valign="top">
                    <table id="tblDataRowPerson" cellpadding="0" cellspacing="0" border="0" width="100%">
                        <tr>
                            <td align="center" style="height:30px;width:60px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">구분</td>
                            <td align="center" style="height:30px;width:90px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">사번</td>
                            <td align="center" style="height:30px;width:120px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">성명</td>
                            <td align="center" style="height:30px;width:80px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">직위</td>
                            <td align="center" style="height:30px;width:120px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">소속</td>
                            <td align="center" style="height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">예산사용부서</td>              
                        </tr>
                        <tr>
                            <td align="center" style="height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"></td>
                            <td align="center" style="BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"><input type="text" id="Text1" name="txtSabun_" + gRowCnt + "" readonly="readonly" style="height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" /></td>
                            <td align="center" style="BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"><input type="text" id="Text2" name="txtUserName_" + gRowCnt + "" readonly="readonly" style="height:20px;width:60%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" />&nbsp;<img src="/GwImages/BLUE/common/devs/btn_search.gif" onclick="SearchUserFromHR(" + gRowCnt + ");" style="cursor:hand;" /></td>
                            <td align="center" style="BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"><input type="text" id="Text3" name="txtJobPosition_" + gRowCnt + "" readonly="readonly" style="height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" /></td>
                            <td align="center" style="BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"><input type="text" id="Text4" name="txtUnitName_" + gRowCnt + "" readonly="readonly" style="height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" /><input type="hidden" id="Hidden1" name="hdnUnitCd_" + gRowCnt + "" /></td>
                            <td align="center" style="BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"><input type="hidden" id="Hidden2" name="hdnBudgetDeptVal_" + gRowCnt + "" /><input type="hidden" id="Hidden3" name="hdnBudgetDeptText_" + gRowCnt + "" /></td>
                        </tr>
                    </table>
                </td>
            </tr>
            
            <tr>                
                <td align="center" style="height:30px;width:100px;  font-weight:bold; background-color:#F6F6F6">출장지</td>
                <td align="center" width="250px;"><input type="text" id="mField" name="txtPlace" style="height:20px;width:93%" /></td>
                <td align="center" style="height:30px; width:100px; font-weight:bold; background-color:#F6F6F6">교통수단</td>
                <td align="center"><input type="text" id="mField" name="txtWay" style="height:20px;width:90%;" /></td>              
            </tr>
            <tr>                
                <td align="center" style="height:30px; font-weight:bold; background-color:#F6F6F6">출장(예정)기간</td>
                <td colspan="3" align="left" style="padding-left:5px;">
                    &nbsp;<input type="text" id="dpApprFormDTStart1" name="dpApprFormDTStart" readonly="readonly" style="font-size: 9pt; padding-left: 3px; width: 70px;"/>
                    <b>~</b>
                    <input type="text" id="dpApprFormDTEnd1" name="dpApprFormDTEnd" readonly="readonly" style="font-size: 9pt; padding-left: 3px; width: 70px;"/>&nbsp;<a class="a1" href="javascript:ResetDateField(1);">초기화</a>
                    <input type="hidden" id="mField" name="hdn_dpApprFormDTStart1" /><input type="hidden" id="mField" name="hdn_dpApprFormDTEnd1" />&nbsp;&nbsp;&nbsp;&nbsp;
                    <b>(<input type="text" id="mField" name="txtNights" style="height:25px;width:15px; font-weight:bold; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;" />박 <input type="text" id="mField" name="txtDays" style="height:25px;width:15px; font-weight:bold; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;" />일)</b>
                </td>                         
            </tr>
            <tr>                
                <td align="center" style="height:30px; font-weight:bold; background-color:#F6F6F6">출장목적</td>
                <td colspan="3" align="center"><input type="text" id="mField" name="txtPurpose" style="height:20px;width:96%" /></td>                          
            </tr>
            <tr>                
                <td align="center" style="height:30px; font-weight:bold; background-color:#F6F6F6">비 고</td>
                <td colspan="3" align="center"><input type="text" id="mField" name="txtBigo1" style="height:20px;width:96%" /></td>                          
            </tr>   
                     
            <tr>
                <td colspan="5" style="height:10px; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"></td>
            </tr>
            -->
        </table>
        <table class="table_html" id="mgmtDepart_main2" cellpadding="0" cellspacing="0">
        </table>

        <table class="table_html" id="tblBodyContent2" summary="내용" cellpadding="0" cellspacing="0">
            <tr>
                <td rowspan="2" align="center" style="width:40px; font-weight:bold;">주<br/>관<br/>부<br/>서<br/>작<br/>성<br/>란</td>
                <td colspan="4" valign="top">
                    <table id="tblDataRowCost" cellpadding="0" cellspacing="0" border="0" width="100%">
                        <tr>
                            <td align="center" style="height:30px; width:60px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">구분</td>
                            <td align="center" style="width:100px;font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">일비<br />(식비포함)</td>
                            <td align="center" style="width:100px;font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">숙박비</td>
                            <td align="center" style="font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">교통비</td>
                            <td align="center" style="font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">소계</td>       
                            <td align="center" style="font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;">계정코드</td>    
                        </tr>
                    </table>
                </td>      
            </tr>      
            <tr>                
                <td align="center" style="height:30px; width:60px; font-weight:bold; background-color:#F6F6F6">비고</td>
                <td colspan="3"><textarea type="text" rows="4" id="mField" name="txtBigo2" style="height:80%;width:90%;  BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"></textarea></td>
                
                <!--
                <td align="center"><textarea type="text" rows="4" id="mField" name="txtBigo2" style="height:80%;width:90%;  BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;"></textarea></td>
                <td align="center" style="height:30px; font-weight:bold; background-color:#F6F6F6">입금대상자</td>
                <td align="center">
                    <input type="text" id="mField" name="txtReceipterNm" readonly="readonly" style="height:20px;width:70%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;" />&nbsp;<img src="/GwImages/BLUE/common/devs/btn_search.gif" onclick="SearchReceipter();" style="cursor:hand;" />
                    <input type="hidden" id="mField" name="txtReceipterSabun" /> 
                </td>
                -->
            </tr>
        </table>
        <input type="hidden" id="mField" name="hdnDataRowCnt" /> <!--데이터행갯수-->
        <input type="hidden" id="hdnBudgetDeptOptioin" name="hdnBudgetDeptOptioin" /> <!--예산사용부서콤보박스<option>문자열-->  
        <input type="hidden" id="hdnAccountOptioin" name="hdnAccountOptioin" /> <!--계정콤보박스<option>문자열-->
        </div>
        <!--######## 본문부분 종료 ##########################################-->
		
		<!--######## 양식하단부분 공통 시작 #################################-->

        <div id="divApprovalLine"> <!--추가(인쇄용) HIW-->
            <table class="table_5" summary="참조" cellpadding="0" cellspacing="0">
                <tr>
                    <th>첨부파일</th>
                    <td id="AttFileInfo" align="left"></td>
                </tr>
                <tr>
                    <th>연결문서</th>
                    <td id="DocLinkInfo" align="left"></td>
                </tr>
                <tr style="display:none;">
                    <th>원 문 서</th>
                    <td id="RejectDocLinkInfo" align="left">-</td>
                </tr>
                <tr>
                    <th>참조</th>
                    <td  id="CCLine" align="left">
                        <div id="SendCC"></div>
                        <div id="RecCC"></div>&nbsp;
                    </td>
                </tr>
            </table>
        
            <!-- 결재선 정보 시작-->
            <table width="100%" cellpadding="0" cellspacing="0">
                <!-- 일반결재/합의 -->
                <tr>
                    <td style="height:7px;"></td>
                </tr>
                <tr>
                    <td id="AppLine" width="100%">
                        <table border="0" width="100%" height="100%" cellpadding="0" cellspacing="0" bordercolordark="white" bordercolorlight="gray">
                            <tr>
                            <!-- 발신처 결재란 보이는 부분(왼쪽) -->
                                <td id="LApvLine" align="left" width="100%"></td>
                            </tr>
                            <tr>
                            <!-- 수신처 결재란 보이는부분 (오른쪽)-->
                                <td id="RApvLine" align="left" width="100%"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <!-- 협조자 -->
                <tr>
                    <td id="AssistLine" width="100%" style="display:none;"></td>
                </tr>
                <!--참조자 -- 첨부파일 영역으로 옮김 -->
                <!--수신자 -->
                <tr>
                    <td id="RRLine" width="100%" style="display:none;"></td>
                </tr>		
            </table>
            <!-- 결재선 정보 종료-->

            <!--의견 시작-->
            <table id ="tbCommentView" border="0" cellpadding="0" cellspacing="0" align="center" width="100%">
                <tr>
                    <td align="center" id="tdCommentView"  width="100%" style="display:none;">				
                    </td>
                </tr>
            </table>
            <!--의견 종료-->
        </div>

        <!--문서설명 시작-->
        <div id="divforminfo" style="display:none">
        <table class="table_6" summary="원문서" cellpadding="0" cellspacing="0">
            <tr>
                <th>문서설명</th>
                <td id="tdforminfo"></td>
            </tr>
        </table>
        </div>
        <!--문서설명 종료-->
        	
        <!--######## 양식하단부분 공통 종료 #################################-->

    </div>
    <!-- bodycontext end -->
</div>
<!-- 양식 전체 end -->
<script language="javascript" src="formedit_object.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript">

    var gRowCnt = 0;  //HIW

    //캘린더 JdatePicker 선언 (HIW)
    $(function () {
        jDatePicker("dpApprFormDTStart1", "ko-KR"); // id, 다국어 정보(한국어: ko-KR)
        jDatePicker("dpApprFormDTEnd1", "ko-KR"); // id, 다국어 정보(한국어: ko-KR)  
    });

    window.onload = initOnload;
    function initOnload() {
        initialize();

        //예산사용부서 콤보박스항목 가져오기
        GetBudgetDeptComboStr();

        //계정코드 콤보박스항목 가져오기
        GetAccountComboStr();

        //편집모드시 날짜필드 셋팅 (HIW)
        SetDateField();

        if ($("input[name=hdnDataRowCnt]").val() == "") {  //기안시  (HIW)
            AddRowDataPerson();
            //사용자기본정보 셋팅
            SetUserBasicInfo();
        }
        else  //편집시
            SetRepeatData();

        //편집모드시 콤보박스 셋팅 (HIW)
        SetComboBox();

        //2017-09-04 PSW 추가
        //ChangeGuboonRdo(2, ); //기본값 - 시외  
    }

    function initialize() {
        if (window.parent.document.readyState == "complete") {
            window.parent.document.onreadystatechange = event_noop;
  		
            initForm();
            initApvList();
        } else {
            window.setTimeout(initialize, 500);
        }				
    }

    function initForm(){
	    initFields();
	    G_displaySpnAttInfo(false);

        /*
	    //문서이관 여부에 따른 셋팅
	    if (getInfo("scEdmsLegacy")=="1"){
	        document.getElementById("trDocInfo01").style.display="";
	       // document.getElementById("trDocInfo02").style.display="";
	    }else{
	        document.getElementById("trDocInfo01").style.display="none";
	       // document.getElementById("trDocInfo02").style.display="none";
	    }
        */
    }

    function initFields(szBody){
        setFields((!window.ActiveXObject) ? document.getElementById("dField") : dField); //editable field
        setFields((!window.ActiveXObject) ? document.getElementById("cField") : cField); //readonly field
	    setFields((!window.ActiveXObject)?document.getElementById("mField"):mField);//form editable field

        document.getElementById("headname").innerHTML = initheadname(getInfo("fmnm"), true);
    	    if (getInfo("mode") == "DRAFT" || getInfo("mode") == "TEMPSAVE" ){		
		    document.getElementsByName("INITIATOR_INFO")[0].value = getInfo("usdn");//getInfo("dpdn_apv")+" "+getInfo("usdn") + " "+ getInfo("ustn") ;
		    document.getElementsByName("APPLIED").value = formatDate(getInfo("svdt"),"D");
		
	    }else{
		    document.getElementsByName("SUBJECT")[0].disabled = true
    }

        //기타 필드 채우기	
        setSaveTerm(); //보존년한 create	
        setDocLevel();  // 보안등급 create

        //본문 내용
        if (getInfo("BODY_CONTEXT") != undefined) {
            setBodyContext(getInfo("BODY_CONTEXT"));
        } else {
            setBodyContext(getInfo("fmbd").replace("euc-kr","utf-8"));
        }
    }


    function getBodyContext(){   
	    //UpdateImageData(); //이미지 업로드
	    var sBodyContext = makeBodyContext();
	    return makeNode("BODY_CONTEXT",sBodyContext,null,false);
    }

    function setFields(Fields){
        if(!window.ActiveXObject){
            var szId = Fields.id;
	        var unFiltered = document.getElementsByTagName('*');
	        for (i = 0; i < unFiltered.length; i++){
	            if (unFiltered[i].getAttribute('id') == szId){
                    var fld = unFiltered[i];
		            if(fld.getAttribute("dataFld")!=null){(getInfo(fld.getAttribute("name"))!=undefined)?fld.value=getInfo(fld.getAttribute("name")):(getInfo(fld.getAttribute("dataFld"))!=undefined)?fld.value=getInfo(fld.getAttribute("dataFld")):fld.value='';}
		            if (fld.getAttribute("name") != null){
		                if(fld.getAttribute("name") == 'POSITION' && getInfo(fld.getAttribute("name")) == ""){
			                fld.value = getInfo(fld.getAttribute("dataFld"));
		                }
		            }
	            }
	        }
       }else{
	        for(var i=0;i<Fields.length;i++){
		        var fld = Fields[i];
		        if(fld.dataFld!=""){(getInfo(fld.name)!=undefined)? fld.value=getInfo(fld.name):(getInfo(fld.dataFld)!=undefined)?fld.value=getInfo(fld.dataFld):fld.value='';}
		        if(fld.name == 'POSITION' && getInfo(fld.name) == ""){
			        fld.value = getInfo(fld.dataFld);
		        }
	        }
	    }
    }

    function checkForm(bTempSave){
	    if (bTempSave){
		    return true;
	    }else{
		    if(document.getElementsByName("SUBJECT")[0].value == '' ){
			    alert('제목을 입력하세요.');
			    //SUBJECT.focus();
			    return false;
			} else if (document.getElementsByName("DOC_CLASS_NAME")[0].value == '') {  //HIW
			    alert('문서분류를 선택하세요.');
			    return false;
			} else {

			    if (!CheckValidDataRowPerson()) {  //데이터반복부(출장자) Validation 체크
			        return false;
			    }

			    if ($("input[name=txtPlace]").val() == "") {
			        alert("출장지를 입력하세요");
			        $("input[name=txtPlace]").focus();
			        return false;
			    }
			    if ($("input[name=txtWay]").val() == "") {
			        alert("교통수단을 입력하세요");
			        $("input[name=txtWay]").focus();
			        return false;
			    }
			    if ($("input[name=hdn_dpApprFormDTEnd1]").val() == "") {
			        alert("출장기간을 선택하지 않았습니다");
			        return false;
			    }
			    if ($("input[name=txtPurpose]").val() == "") {
			        alert("출장목적을 입력하세요");
			        $("input[name=txtPurpose]").focus();
			        return false;
			    }

			    return true;
		    }
	    }
    }

    //신청양식 주관부서작성란 Validation체크 (2013-01-18 HIW)
    function CheckValidationByReceiptDept() {

        if (String(window.location).indexOf("_read.htm") == -1) {

            if (!CheckValidDataRowCost()) {  //데이터반복부(비용) Validation 체크
                return false;
            }
            /*
            if ($("input[name=txtDepositerNm]").val() == "") {
                alert("입금대상자를 입력하세요");
                $("input[name=txtDepositerNm]").focus();
                return false;
            }
            */
            return true;
        }
    }

    //데이터반복부(출장자) Validation 체크 (HIW)
    function CheckValidDataRowPerson() {
        
        var bResult = true;
        $("#tblDataRowPerson tr").each(function (i) {
            //debugger;
            if (i > 0) {
                if ($("input[name=txtSabun_" + i + "]").val() == "") {
                    alert("출장자를 지정하지 않았습니다");
                    $("input[name=txtUserName_" + i + "]").focus();
                    bResult = false;
                    return false;
                }
                if ($("select[name=cmbBudgetDept_" + i + "]").val() == "선택하세요") {
                    alert("예산사용부서를 선택하세요");
                    $("select[name=cmbBudgetDept_" + i + "]").focus();
                    bResult = false;
                    return false;
                }
            }
        });

        return bResult;
    }

    //데이터반복부(비용) Validation 체크 (HIW)
    function CheckValidDataRowCost() {
        var bResult = true;
        var vRowCnt = $("#tblDataRowCost tr").length;

        $("#tblDataRowCost tr").each(function (i) {
            //debugger;
            if (i > 0 && (i < vRowCnt-1)) {
                if ($("input[name=txtSubTot_" + i + "]").val() == "" || $("input[name=txtSubTot_" + i + "]").val() == "0") {
                    alert("비용을 입력하세요");
                    bResult = false;
                    return false;
                }
                if ($("select[name=cmbAccount_" + i + "]").val() == "선택하세요") {
                    alert("계정코드를 선택하세요");
                    $("select[name=cmbAccount_" + i + "]").focus();
                    bResult = false;
                    return false;
                }
            }
        });

        return bResult;
    }


    function setBodyContext(sBodyContext){
	    //본문 채우기
	    var m_objXML=CreateXmlDocument();
	    var elmList, elm;
	    var elmListLan;
	
	    m_objXML.loadXML("<?xml version='1.0' encoding='utf-8'?>"+getInfo("BODY_CONTEXT"));
	    try{
		    elmList = m_objXML.documentElement.childNodes;
		    for(var i=0; i < elmList.length; i++){
			    var elm = elmList[i];
			    innerHtmlData(elm.nodeName, elm.text);
		    }
		    //본문 채우기
		    //setdField();
	    }
	    catch(e){ }
    }

    //본문 XML로 구성
    function makeBodyContext(){
	    var sBodyContext="";	
	    //xml 구성 예제 : <body><item><name></name></item><item><name></name></item></body>
	    //sBodyContext="<body><item><name>첫번째</name></item><item><name>두번째</name></item></body>";

	    sBodyContext = "<BODY_CONTEXT>" + getFields(document.getElementById("mField")) + "</BODY_CONTEXT>";	
	    return sBodyContext;
    }

    /*** 폼데이터 XML문 만들기 ***/
    function getFields(Fields) {
        /*
        var sText = "";
        if(Fields!=null){
        var szId = Fields.id;
        sText+= makeCBFormXML("input", szId);
        sText+= makeCBFormXML("select", szId);
        sText+= makeCBFormXML("radio", szId);
        sText+= makeCBFormXML("textarea", szId);
        }	
        return sText;
        */
        var sText = "";
        if (Fields != null) {
            var szId = Fields.id;
            var unFiltered = document.getElementsByTagName('*');
            for (var i = 0; i < unFiltered.length; i++) {

                if (unFiltered[i].getAttribute('id') == szId) {
                    if (unFiltered[i].getAttribute("name").indexOf("SEL_") > -1) {
                        sText += getSelRadio(unFiltered[i]);
                    } else if (unFiltered[i].getAttribute("name").indexOf("OPT_") > -1) {
                        if (sText.indexOf("<" + unFiltered[i].name + ">") == -1) sText += getRadio(unFiltered[i].name);
                    } else if (unFiltered[i].getAttribute("name").indexOf("CHK_") > -1) {
                        sText += getChkRadio(unFiltered[i].name);
                    } else {
                        sText += makeNode(unFiltered[i].getAttribute("name"), unFiltered[i].value);
                    }
                }
            }
        }
        return sText;
    }	

    function getFieldsCB(szTagName, szFieldId){
        var szReturn ="";
        var unFiltered = document.getElementsByTagName(szTagName);
        for (var i = 0; i < unFiltered.length; i++){
            if (unFiltered[i].getAttribute("id") == szFieldId){
                if (unFiltered[i].getAttribute("name").indexOf("SEL_") > -1){
		            szReturn += getSelRadio(unFiltered[i]);
                }else{
		            szReturn += makeNode(unFiltered[i].getAttribute("name"), unFiltered[i].value);
                }
            }
        } 
        return  szReturn;  
    }

    /** 레디오버튼 XML노드 생성 **/
    function getRadio(radioNm) {
        var radioVal = "";
        /*
        //alert("이름:"+radioNm+"\n객체여부:"+eval(radioNm)+"\n길이:"+eval(radioNm).length+"\n체크여부:"+eval(radioNm).checked);
        for(i=0;i<eval(radioNm).length;i++){				
        if(eval(radioNm)[i].checked){
        radioVal = makeNode(radioNm, eval(radioNm)[i].value);
        }
        }
        */
        radioVal = makeNode(radioNm, $("input:radio[name=" + radioNm + "]:checked").val());

        return radioVal;
    }

    /** 체크박스 XML노드 생성 **/
    function getChkRadio(chkBoxNm) {
        /*
        if(eval(radioNm).checked){
        radioVal = makeNode(radioNm, eval(radioNm).value);
        return radioVal;
        }
        */
        var chkVal = "";
        if ($("input:checkbox[name=" + chkBoxNm + "]").is(":checked"))
            chkVal = makeNode(chkBoxNm, $("input:checkbox[name=" + chkBoxNm + "]:checked").val());

        return chkVal;
    }

    /** SELECT BOX VALUE 가져오기 **/
    function getSelRadio(obj){ //selNm
	    var radioVal = "";
	    var selNm = obj.getAttribute("name");
        if ( obj.selectedIndex > -1 ){
            radioVal += makeNode(selNm, obj.options[obj.selectedIndex].value);
            radioVal += makeNode(selNm+"_TEXT", obj.options[obj.selectedIndex].text);
        }else{
            radioVal += makeNode(selNm, "");
            radioVal += makeNode(selNm+"_TEXT", "");
        }
        return   radioVal;
    }

    /*** 데이터 뿌려주기 ***/
    function innerHtmlData(nodeNm, nodeVal){
	    if (document.getElementsByName(nodeNm) != undefined) {
		    if (nodeNm.indexOf("FORM_ATTACH") != -1) {
			    setForm_Attach(nodeVal);
			    document.getElementsByName(nodeNm)[0].value = nodeVal;
		    } else if (nodeNm.indexOf("tbContentElement") != -1) {
			    var dom = tbContentElement.getDom();	dom.body.innerHTML= nodeVal.replace(/<BR>/gi,"");
		    } else if(nodeNm.indexOf("OPT") != -1) {
			    setRadio(nodeNm, nodeVal);
		    } else if(nodeNm.indexOf("CHK") != -1) {
			    setChk(nodeNm, nodeVal);
		    } else if(nodeNm.indexOf("JEONKEUL") != -1) {
			    spnJEONKEUL.innerHTML = nodeVal;
			} else {
			    if(document.getElementsByName(nodeNm)[0]!=null) document.getElementsByName(nodeNm)[0].value = nodeVal;
		    }
	    }
    }

    /*** 레디오버튼 체크선택 (수정모드시) ***/
    function setRadio(szname, szvalue) {
        /*
        var objrdo = eval(szname);
        for(i=0;i<objrdo.length;i++){	
        if(objrdo[i].value == szvalue) objrdo[i].checked = true;
        }
        */
        var objrdo = $("[name=" + szname + "]");
        for (i = 0; i < objrdo.length; i++) {
            if (objrdo[i].value == szvalue)
                objrdo[i].checked = true;
        }
    }

    //2017-09-05 PSW 추가
    //사용자기본정보 셋팅
    var vSabun = "";
    function SetUserBasicInfo() {

        var url = "/CoviWeb/Approval/CallBack.aspx";
        var param = "CODE=60&PERSON_CODE=" + getInfo("usid") + "&LANGUAGE=" + getInfo("uslng");

        var xml = DoCallback(url, param);
        var result = xml.responseXML;

        var elmRoot = result.documentElement;
        //debugger;
        if (SelectSingleNode(elmRoot, "result") != "SUCEESS") {
            alert("[Error]\n\r\n\r" + SelectSingleNode(elmRoot, "result"));
            return;
        }
        else {//debugger;

            var vUserNm = "";
            var vJobPosition = "";
            var vUnitNm = "";

            try {
                $(elmRoot).find("Table").each(function (i) {

                    vSabun = $(this).find("SABUN").text();
                    vUserNm = $(this).find("DISPLAY_NAME").text();
                    vJobPosition = $(this).find("JBO_POSITION").text();
                    vUnitNm = $(this).find("UNIT_NAME").text();
                });
                //alert(vUnitNm);
                $("input[name=txtSabun_1]").val(vSabun);
                $("input[name=txtUserName_1]").val(vUserNm);
                $("input[name=txtJobPosition_1]").val(vJobPosition);
                $("input[name=txtUnitName_1]").val(vUnitNm);

            } catch (e) {
                alert(e.message);
            }
        }
        //CallRemainDays();
    }


    //2017-09-05 PSW 수정 - 시내/시외 콤보박스 변경시
    function ChangeGuboonRdo(pKind, gRowCnt) {//debugger;
        if (pKind == 1) {

            $("input[name=txtDayAmt_" + gRowCnt + "]").val(7000);
        } else if (pKind == 2) {
            $("input[name=txtDayAmt_" + gRowCnt + "]").val(20000);
        }

        TotSumCalcu();
    }

   


    /*** 체크박스 체크선택 (수정모드시) ***/
    function setChk(szname, szvalue) {
        /*
        var objrdo = eval(szname);
        if (objrdo.value == szvalue) objrdo.checked = true;
        */
        var objrdo = $("input:checkbox[name=" + szname + "]");
        if (objrdo[0].value == szvalue)
            objrdo[0].checked = true;
    }


    //편집모드시 날짜필드 셋팅 (HIW)
    function SetDateField() {

        for (var i = 1; i < 6; i++) {
            $("#dpApprFormDTStart1").val($("input[name=hdn_dpApprFormDTStart1]").val());
            $("#dpApprFormDTEnd1").val($("input[name=hdn_dpApprFormDTEnd1]").val());
        }
    }

    //편집모드시 데이터반복부 셋팅 (HIW)
    function SetRepeatData() {

        var vRowCnt = parseInt($("input[name=hdnDataRowCnt]").val());

        for (var i = 1; i < vRowCnt + 1; i++) {
            AddRowDataPerson();
        }

        //데이터 바인딩
        setBodyContext(getInfo("BODY_CONTEXT"));
    }

    //편집모드시 콤보박스 셋팅 (HIW)
    function SetComboBox() {
    
        var vRowCnt = parseInt($("input[name=hdnDataRowCnt]").val());
        
        for (var i = 1; i < vRowCnt + 1; i++) {
            $("select[name=cmbBudgetDept_" + i + "]").val($("input[name=hdnBudgetDeptVal_" + i + "]").val());
            $("select[name=cmbAccount_" + i + "]").val($("input[name=hdnAccountVal_" + i + "]").val());
            
        }
    }

    //날짜 초기화 (2013-01-02 HIW)
    function ResetDateField(pNo) {

        $("#dpApprFormDTStart" + pNo).val("");
        $("#dpApprFormDTEnd" + pNo).val("");
        $("input[name=hdn_dpApprFormDTStart" + pNo + "]").val("");
        $("input[name=hdn_dpApprFormDTEnd" + pNo + "]").val("");
        $("input[name=txtNights]").val("");
        $("input[name=txtDays]").val("");
    }

    //몇박몇일 구하기
    function GetNightsNDays() {

        var vArrSDate = $("#dpApprFormDTStart1").val().split("-");
        var vArrEDate = $("#dpApprFormDTEnd1").val().split("-");
        var vSDate = new Date(vArrSDate[0], vArrSDate[1] - 1, vArrSDate[2]).getTime();
        var vEDate = new Date(vArrEDate[0], vArrEDate[1] - 1, vArrEDate[2]).getTime();

        var vNights = (vEDate - vSDate) / (1000 * 60 * 60 * 24);
        var vDays = vNights + 1;

        $("input[name=txtNights]").val(vNights);
        $("input[name=txtDays]").val(vDays);
    }

    //사용자검색 팝업창 띄우기
    function SearchUserFromHR(pNo) {

        fn_OpenDialog2("/CoviWeb/Approval/Forms/Popup/UserSearchFromHR.aspx?kind=FromTrip&DataRowNo=" + pNo, "", 500, 390, "scroll");   //fix/scroll
    }


    //신청부서 출장자 행추가 (HIW)
    function AddRowDataPerson() {
        //debugger;
        if (gRowCnt > 3) {
            alert("4명까지만 추가할 수 있습니다");
            return;
        }
        //2017-09-05 PSW 수정 
        //gRowCnt++;
        
        if (gRowCnt == 0) {
            gRowCnt++;
        } else {
            gRowCnt = parseInt($("input[name=hdnDataRowCnt]").val())+1;
        }
        
        //cnt++;
        /*
        var vRowStr = "";
        vRowStr += "<tr>";
        vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + gRowCnt + "</td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtSabun_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtUserName_" + gRowCnt + "' readonly='readonly' style='height:20px;width:60%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' />&nbsp;<img src='/GwImages/BLUE/common/devs/btn_search.gif' onclick='SearchUserFromHR(" + gRowCnt + ");' style='cursor:hand;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtJobPosition_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtUnitName_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /><input type='hidden' id='mField' name='hdnUnitCd_" + gRowCnt + "' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + BindCmbBudgetDept() + "<input type='hidden' id='mField' name='hdnBudgetDeptVal_" + gRowCnt + "' /><input type='hidden' id='mField' name='hdnBudgetDeptText_" + gRowCnt + "' /></td>";
        vRowStr += "</tr>";

        $("#tblDataRowPerson").append(vRowStr);
        */

        //2017-09-04 PSW 수정
        var vRowStr = "";
        vRowStr += "<table class='table_html' id='mgmtDepart_main_" + gRowCnt + "'>";
            vRowStr += "<tr>";
            if (gRowCnt == 1) {
                vRowStr += "<td valign='middle' rowspan='5' align='center' style='width:40px; font-weight:bold; background-color:#F6F6F6'>출<br/>장<br/>부<br/>서<br/>작<br/>성<br/>란<br/><a class='a2' href='javascript:AddRowDataPerson();'><b>[+]</b></a><br /><a class='a2' href='javascript:DelRowDataPerson();'><b>[-]</b></a></td></td>";
            } else {
                vRowStr += "<td valign='middle' rowspan='5' align='center' style='width:40px; font-weight:bold; background-color:#F6F6F6'>출<br/>장<br/>부<br/>서<br/>작<br/>성<br/>란</td>";
            }
            vRowStr += "<td colspan='4' valign='top'>";
            vRowStr += "<table id='tblDataRowPerson' cellpadding='0' cellspacing='0' border='0' width='100%'>";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:30px;width:60px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>구분</td>";
            vRowStr += "<td align='center' style='height:30px;width:90px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>사번</td>";
            vRowStr += "<td align='center' style='height:30px;width:120px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>성명</td>";
            vRowStr += "<td align='center' style='height:30px;width:80px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>직위</td>";
            vRowStr += "<td align='center' style='height:30px;width:120px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>소속</td>";
            vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>예산사용부서</td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + gRowCnt + "</td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtSabun_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtUserName_" + gRowCnt + "' readonly='readonly' style='height:20px;width:60%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' />&nbsp;<img src='/GwImages/BLUE/common/devs/btn_search.gif' onclick='SearchUserFromHR(" + gRowCnt + ");' style='cursor:hand;' /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtJobPosition_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtUnitName_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /><input type='hidden' id='mField' name='hdnUnitCd_" + gRowCnt + "' /></td>";
            vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + BindCmbBudgetDept() + "<input type='hidden' id='mField' name='hdnBudgetDeptVal_" + gRowCnt + "' /><input type='hidden' id='mField' name='hdnBudgetDeptText_" + gRowCnt + "' /></td>";
            vRowStr += "</tr>";
            vRowStr += "</table>";
            vRowStr += "</td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:30px;width:100px;  font-weight:bold; background-color:#F6F6F6'>출장지</td>";
            vRowStr += "<td align='center' width='250px;'><input type='text' id='mField' name='txtPlace' style='height:20px;width:93%' /></td>";
            vRowStr += "<td align='center' style='height:30px; width:100px; font-weight:bold; background-color:#F6F6F6'>교통수단</td>";
            vRowStr += "<td align='center'><input type='text' id='mField' name='txtWay' style='height:20px;width:90%;' /></td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6'>출장(예정)기간</td>";
            vRowStr += "<td colspan='3' align='left' style='padding-left:5px;'>";
            vRowStr += "&nbsp;<input type='text' id='dpApprFormDTStart1' name='dpApprFormDTStart' readonly='readonly' style='font-size: 9pt; padding-left: 3px; width: 70px;'/>";
            vRowStr += "<b>~</b>";
            vRowStr += "<input type='text' id='dpApprFormDTEnd1' name='dpApprFormDTEnd' readonly='readonly' style='font-size: 9pt; padding-left: 3px; width: 70px;'/>&nbsp;<a class='a1' href='javascript:ResetDateField(1);'>초기화</a>";
            vRowStr += "<input type='hidden' id='mField' name='hdn_dpApprFormDTStart1' /><input type='hidden' id='mField' name='hdn_dpApprFormDTEnd1' />&nbsp;&nbsp;&nbsp;&nbsp;";
            vRowStr += "<b>(<input type='text' id='mField' name='txtNights' style='height:25px;width:15px; font-weight:bold; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;' />박 <input type='text' id='mField' name='txtDays' style='height:25px;width:15px; font-weight:bold; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;' />일)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input type='radio' id='mField' name='OPT_Guboon_" + gRowCnt + "' value='시내' onclick='ChangeGuboonRdo(1," + gRowCnt + ");' style='border:0px;'/>시내 &nbsp;&nbsp;<input type='radio' id='mField' name='OPT_Guboon_" + gRowCnt + "' value='시외' onclick='ChangeGuboonRdo(2, " + gRowCnt + ");' style='border:0px;' checked />시외<input type='hidden' id='mField' name='hdnInOutVal_" + gRowCnt + "' /></b>";
            vRowStr += "</td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6'>출장목적</td>";
            vRowStr += "<td colspan='3' align='center'><input type='text' id='mField' name='txtPurpose' style='height:20px;width:96%' /></td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6'>비 고</td>";
            vRowStr += "<td colspan='3' align='center'><input type='text' id='mField' name='txtBigo1' style='height:20px;width:96%' /></td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td colspan='5' style='height:10px; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'></td>";
            vRowStr += "</tr>";
            vRowStr += "<tr>";
            vRowStr += "<td colspan='5' style='height:10px; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'></td>";
            vRowStr += "</tr>";
            vRowStr += "</table>";

            $("#mgmtDepart_main2").append(vRowStr);
            
        
        $("input[name=hdnDataRowCnt]").val(gRowCnt);
        //alert("추가후 RowCnt : " + $("input[name=hdnDataRowCnt]").val());


        var gbnText = $("input:radio[name='OPT_Guboon_" + gRowCnt + "']:checked").val();
        
        //비용 행 추가
        AddRowDataCost();
        ChangeGuboonRdo(2, gRowCnt);
    }

   

    //2017-09-05 PSW 수정 - 출장부서작성란 테이블 삭제
    function DelRowDataPerson() {

        var vRowCnt = $("#mgmtDepart_main tr").length;
        var vRowCnt2 = $("#mgmtDepart_main").length+1;
        //alert("vRowCnt2"+vRowCnt2);
        if (gRowCnt > 1) {
            $("#mgmtDepart_main_" +gRowCnt).last().remove();
        } else {
            alert("최소 1명 이상은 입력하셔야 합니다.");
        }
        gRowCnt--;
        $("input[name=hdnDataRowCnt]").val(gRowCnt);
        DelRowDataCost();
        
        //전체합 구하기
        //TotSumCalcu();
    }

    //주관부서 비용 행추가 (HIW)
    function AddRowDataCost() {
        //debugger;

        var vRowCnt = $("#tblDataRowCost tr").length;

        //합계행 삭제
        if (gRowCnt > 1) {
            $("#tblDataRowCost tr").each(function (i) {

                if (i == vRowCnt - 1) {
                    $(this).remove();
                }
            });
        }
            
        var vRowStr = "";
        vRowStr += "<tr>";
        vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + gRowCnt + "</td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtDayAmt_" + gRowCnt + "' onkeyup='SumRowCalcu(" + gRowCnt + ");' onkeypress='CheckInteger();' onblur='this.value=CommaSplit(this.value);' style='height:20px;width:90%; text-align:right; ime-mode:disabled;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtStayAmt_" + gRowCnt + "' onkeyup='SumRowCalcu(" + gRowCnt + ");' onkeypress='CheckInteger();' onblur='this.value=CommaSplit(this.value);' style='height:20px;width:90%; text-align:right; ime-mode:disabled;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtTransAmt_" + gRowCnt + "' onkeyup='SumRowCalcu(" + gRowCnt + ");' onkeypress='CheckInteger();' onblur='this.value=CommaSplit(this.value);' style='height:20px;width:90%; text-align:right; ime-mode:disabled;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtSubTot_" + gRowCnt + "' readonly='readonly' style='height:20px;width:90%; text-align:right; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>" + BindCmbAccount() + "<input type='hidden' id='mField' name='hdnAccountVal_" + gRowCnt + "' /><input type='hidden' id='mField' name='hdnAccountText_" + gRowCnt + "' /></td>";
        vRowStr += "</tr>";

        //합계 
        vRowStr += "<tr>";                
        vRowStr += "<td align='center' style='height:30px; font-weight:bold; background-color:#F6F6F6; BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'>합계</td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtDayTot' readonly='readonly' style='height:20px;width:90%; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px; text-align:right;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtStayTot' readonly='readonly' style='height:20px;width:90%; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px; text-align:right;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtTransTot' readonly='readonly' style='height:20px;width:90%; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px; text-align:right;' /></td>";
        vRowStr += "<td align='center' style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'><input type='text' id='mField' name='txtTotal' readonly='readonly' style='height:20px;width:90%; text-align:center; BORDER-RIGHT: 0px; BORDER-TOP: 0px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px; text-align:right;' /></td>";
        vRowStr += "<td style='BORDER-RIGHT: #D5D5D5 1px solid; BORDER-TOP: #D5D5D5 1px solid; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px;'></td>";     
        vRowStr += "</tr>";


        $("#tblDataRowCost").append(vRowStr);

        //전체합 구하기
        TotSumCalcu();
    }

    //주관부서 비용 행삭제
    function DelRowDataCost() {

        var vRowCnt = $("#tblDataRowCost tr").length;

        if (vRowCnt > 3) {
            $("#tblDataRowCost tr").each(function (i) {

                if (i == vRowCnt - 2) {
                    $(this).remove();
                }

            });

            //전체합 구하기
            TotSumCalcu();
        }
    }

    //행합 구하기
    function SumRowCalcu(pNo) {

        var vDayAmt = ($("input[name=txtDayAmt_"+pNo+"]").val() == "")?0:parseInt(ReplaceChars($("input[name=txtDayAmt_"+pNo+"]").val(), ",", ""));
        var vStayAmt = ($("input[name=txtStayAmt_"+pNo+"]").val() == "")?0:parseInt(ReplaceChars($("input[name=txtStayAmt_"+pNo+"]").val(), ",", ""));
        var vTransAmt = ($("input[name=txtTransAmt_" + pNo + "]").val() == "") ? 0 : parseInt(ReplaceChars($("input[name=txtTransAmt_" + pNo + "]").val(), ",", ""));

        var vSum = vDayAmt + vStayAmt + vTransAmt;
        var sSum = CommaSplitByString(vSum);

        $("input[name=txtSubTot_" + pNo + "]").val(sSum);   

        //전체합 구하기
        TotSumCalcu();
    }

    //전체합 구하기
    function TotSumCalcu() {

        var vSumDayAmt = 0;
        var vSumStayAmt = 0;
        var vSumTransAmt = 0;
        var vTotSum = 0;

        var vRowCnt = $("#tblDataRowCost tr").length;

        $("#tblDataRowCost tr").each(function (i) {

            if ((i < vRowCnt-1) && i > 0) {
                vSumDayAmt += ($("input[name=txtDayAmt_" + i + "]").val() == "") ? 0 : parseInt(ReplaceChars($("input[name=txtDayAmt_" + i + "]").val(), ",", ""));
                vSumStayAmt += ($("input[name=txtStayAmt_" + i + "]").val() == "") ? 0 : parseInt(ReplaceChars($("input[name=txtStayAmt_" + i + "]").val(), ",", ""));
                vSumTransAmt += ($("input[name=txtTransAmt_" + i + "]").val() == "") ? 0 : parseInt(ReplaceChars($("input[name=txtTransAmt_" + i + "]").val(), ",", ""));
                vTotSum += ($("input[name=txtSubTot_" + i + "]").val() == "") ? 0 : parseInt(ReplaceChars($("input[name=txtSubTot_" + i + "]").val(), ",", ""));
            }
        });

        $("input[name=txtDayTot]").val(CommaSplitByString(vSumDayAmt));
        $("input[name=txtStayTot]").val(CommaSplitByString(vSumStayAmt));
        $("input[name=txtTransTot]").val(CommaSplitByString(vSumTransAmt));
        $("input[name=txtTotal]").val(CommaSplitByString(vTotSum));   
    }


    //예산사용부서 콤보박스항목 가져오기
    function GetBudgetDeptComboStr() {

        var url = "/CoviWeb/Approval/CallBack.aspx";
        var param = "CODE=40&ENT_CODE=" + getInfo("etid");

        var xml = DoCallback(url, param);
        var result = xml.responseXML;

        var elmRoot = result.documentElement;
        //debugger;
        if (SelectSingleNode(elmRoot, "result") != "SUCEESS") {
            alert("[Error]\n\r\n\r" + SelectSingleNode(elmRoot, "result"));
            return;
        }
        else {//debugger;
            var vCode = "";
            var vName = "";
            var vOptionStr = "";
            vOptionStr += "<option value='선택하세요' selected>선택하세요</option>";

            try {
                $(elmRoot).find("Table").each(function (i) {

                    vCode = $(this).find("BUDGET_DEPT_CODE").text();
                    vName = $(this).find("BUDGET_DEPT_NAME").text();

                    vOptionStr += "<option value='" + vCode + "'>" + vName + "</option>";
                });

                $("input[name=hdnBudgetDeptOptioin]").val(vOptionStr);  
               
            } catch (e) {
                alert(e.message);
            }
        }
    }

    //예산사용부서 콤보박스 바인딩
    function BindCmbBudgetDept() {

        var vCmbStr = "";
        var vOptionStr = $("input[name=hdnBudgetDeptOptioin]").val();  

        vCmbStr += "<select id='mField' name='cmbBudgetDept_" + gRowCnt + "' onchange='ChangeCmbBudgetDept(" + gRowCnt + ");' style='width:90%'>" + vOptionStr + "</select>";

        return vCmbStr;
    }

    //예산사용부서 콤보박스 변경시
    function ChangeCmbBudgetDept(pRowCnt) {//debugger;
        var vSelVal = $("select[name=cmbBudgetDept_" + pRowCnt + "]").val();
        var vSelText = $("select[name=cmbBudgetDept_" + pRowCnt + "] option:selected").text();

        $("input[name=hdnBudgetDeptVal_" + pRowCnt + "]").val(vSelVal);
        $("input[name=hdnBudgetDeptText_" + pRowCnt + "]").val(vSelText);
      
    }

    //계정코드 콤보박스항목 가져오기
    function GetAccountComboStr() {

        var url = "/CoviWeb/Approval/CallBack.aspx";
        var param = "CODE=42&ENT_CODE=" + getInfo("etid");

        var xml = DoCallback(url, param);
        var result = xml.responseXML;

        var elmRoot = result.documentElement;
        //debugger;
        if (SelectSingleNode(elmRoot, "result") != "SUCEESS") {
            alert("[Error]\n\r\n\r" + SelectSingleNode(elmRoot, "result"));
            return;
        }
        else {//debugger;
            var vCode = "";
            var vName = "";
            var vOptionStr = "";
            vOptionStr += "<option value='선택하세요' selected>선택하세요</option>";

            try {
                $(elmRoot).find("Table").each(function (i) {

                    vCode = $(this).find("ACCOUNT_CODE").text();
                    vName = $(this).find("ACCOUNT_NAME").text();

                    vOptionStr += "<option value='" + vCode + "'>" + vName + "</option>";
                });

                $("input[name=hdnAccountOptioin]").val(vOptionStr);  

            } catch (e) {
                alert(e.message);
            }
        }
    }

    //계정코드 콤보박스 바인딩
    function BindCmbAccount() {

        var vCmbStr = "";
        var vOptionStr = $("input[name=hdnAccountOptioin]").val();

        vCmbStr += "<select id='mField' name='cmbAccount_" + gRowCnt + "' onchange='ChangeCmbAccount(" + gRowCnt + ");' style='width:90%'>" + vOptionStr + "</select>";

        return vCmbStr;
    }

    //계정코드 콤보박스 변경시
    function ChangeCmbAccount(pRowCnt) {//debugger;
        var vSelVal = $("select[name=cmbAccount_" + pRowCnt + "]").val();
        var vSelText = $("select[name=cmbAccount_" + pRowCnt + "] option:selected").text();

        $("input[name=hdnAccountVal_" + pRowCnt + "]").val(vSelVal);
        $("input[name=hdnAccountText_" + pRowCnt + "]").val(vSelText);
        //alert($("select[name=cmbAccount_" + pRowCnt + "]").attr("name"));
    }

    //사용자검색 팝업창 띄우기 (입금대상자)
    function SearchReceipter() {

        fn_OpenDialog2("/CoviWeb/Approval/Forms/Popup/UserSearchFromHR.aspx?kind=ReceipterFromTrip", "", 500, 390, "scroll");   //fix/scroll
    }


</script>
</body>
</html>
